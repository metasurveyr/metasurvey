[{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"what-is-metasurvey","dir":"","previous_headings":"","what":"What is metasurvey?","title":"CLAUDE.md","text":"R package processing survey data using metaprogramming. wraps survey package R6 classes, reproducible pipelines (steps/recipes/workflows), support complex designs like rotating panels bootstrap replicate weights.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"build--test-commands","dir":"","previous_headings":"","what":"Build & Test Commands","title":"CLAUDE.md","text":"","code":"# Run full test suite Rscript -e 'devtools::test()'  # Run a single test file Rscript -e 'devtools::test(filter = \"steps-basic\")'  # R CMD check (full package validation: 0 errors/0 warnings expected) Rscript -e 'devtools::check()'  # Regenerate docs (roxygen2 → NAMESPACE + man/) Rscript -e 'devtools::document()'  # Build package R CMD build .  # Install locally Rscript -e 'devtools::install()'  # Test coverage Rscript -e 'covr::package_coverage()'"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"core-r6-class-hierarchy","dir":"","previous_headings":"Architecture","what":"Core R6 Class Hierarchy","title":"CLAUDE.md","text":"Survey (R/survey.R) — Base class. Holds data (data.table), metadata (type, edition, periodicity), weight spec, sampling design (survey::svydesign/svrepdesign), attached steps/recipes/workflows. RotativePanelSurvey (R/PanelSurvey.R) — Extends concept rotating panels: implantation Survey + list follow_up Surveys. Steps can target .level = \"follow_up\" \"implantation\". PoolSurvey (R/survey.R) — Groups multiple surveys time hierarchy (e.g., list(annual = list(group1 = list(s1, s2)))).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"step-pipeline-lazy-evaluation","dir":"","previous_headings":"Architecture","what":"Step Pipeline (lazy evaluation)","title":"CLAUDE.md","text":"Step (R/Step.R) — R6 class storing transformation: type (compute/recode/rename/remove/join), expressions, dependencies, bake status. Step functions (R/steps.R, largest file) — step_compute(), step_recode(), step_rename(), step_remove(), step_join(). default (lazy_processing=TRUE), steps recorded executed bake_steps() called. bake_steps() (R/steps.R) — Materializes pending lazy steps survey data. Internal compute() recode() functions top R/steps.R handle actual data.table mutations.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"recipe-system","dir":"","previous_headings":"Architecture","what":"Recipe System","title":"CLAUDE.md","text":"Recipe (R/Recipes.R) — R6 class bundling metadata + list step calls reproducible survey processing. doc() auto-documentation validate(svy) check dependencies. RecipeRegistry/RecipeBackend (R/RecipeRegistry.R, R/RecipeAPI.R) — Registry pattern pluggable backends (JSON file, MongoDB) publishing/discovering recipes. RecipeCategory, RecipeCertification, RecipeUser — Supporting R6 classes recipe ecosystem. Tidy API wrappers R/recipe_tidy_api.R: list_recipes(), search_recipes(), filter_recipes(), rank_recipes(), etc.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"workflow-system","dir":"","previous_headings":"Architecture","what":"Workflow System","title":"CLAUDE.md","text":"workflow() (R/workflow.R) — Executes survey::svymean/svytotal/svyratio/svyby calls Survey objects, returns data.table results metadata. RecipeWorkflow (R/RecipeWorkflow.R) — R6 class publishable workflow objects (captures estimation calls, references recipe IDs). WorkflowRegistry/WorkflowBackend (R/WorkflowRegistry.R, R/WorkflowBackend.R) — registry pattern recipes. Tidy API R/workflow_tidy_api.R: list_workflows(), search_workflows(), etc.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"global-options","dir":"","previous_headings":"Architecture","what":"Global Options","title":"CLAUDE.md","text":"Controlled via options(), set package load R/meta.R: - metasurvey.engine — default data engine (\"data.table\") - use_copy — whether step operations clone data (use_copy_default()) - metasurvey.lazy_processing — lazy step execution (lazy_default(), TRUE default)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"testing-conventions","dir":"","previous_headings":"","what":"Testing Conventions","title":"CLAUDE.md","text":"testthat edition 3 (Config/testthat/edition: 3) Test helpers tests/testthat/helper-survey.R: make_test_survey(n), make_test_data(n), make_test_panel() Integration tests using example-data/ directory use skip_on_cran() + skip_if_not(file.exists(...)) Test file naming: test-{topic}.R (e.g., test-steps-basic.R, test-recipe.R, test-workflow.R)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"known-gotchas","dir":"","previous_headings":"","what":"Known Gotchas","title":"CLAUDE.md","text":"recode + bake_steps: bake_step() passes record=FALSE internal recode() doesn’t accept . Avoid calling bake_steps() step_recode() new tests — test column creation directly use_copy=TRUE. lazy_processing=FALSE interaction: Steps apply immediately Step objects created bake=FALSE, leading double-execution bake_steps(). Prefer lazy_processing=TRUE (default). PoolSurvey construction: Use nested list structure: PoolSurvey$new(list(annual = list(\"group1\" = list(s1, s2)))).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CLAUDE.html","id":"git-workflow","dir":"","previous_headings":"","what":"Git Workflow","title":"CLAUDE.md","text":"main branch releases/PRs develop branch active development roxygen2 generates NAMESPACE man/ pages — run devtools::document() changing roxygen comments","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CODE_OF_CONDUCT.html","id":null,"dir":"","previous_headings":"","what":"Contributor Code of Conduct","title":"Contributor Code of Conduct","text":"contributors maintainers project, pledge respect people contribute reporting issues, posting feature requests, updating documentation, submitting pull requests patches, activities. committed making participation project harassment-free experience everyone, regardless level experience, gender, gender identity expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion. Examples unacceptable behavior participants include use sexual language imagery, derogatory comments personal attacks, trolling, public private harassment, insults, unprofessional conduct. Project maintainers right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct. Project maintainers follow Code Conduct may removed project team. Instances abusive, harassing, otherwise unacceptable behavior may reported opening issue contacting one project maintainers. Code Conduct adapted Contributor Covenant, version 1.0.0, available https://www.contributor-covenant.org/version/1/0/0/code--conduct.html. project released Contributor Code Conduct. participating project agree abide terms.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to metasurvey","title":"Contributing to metasurvey","text":"Thank interest contributing metasurvey. document outlines propose changes, report bugs, contribute code.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CONTRIBUTING.html","id":"bug-reports","dir":"","previous_headings":"","what":"Bug reports","title":"Contributing to metasurvey","text":"find bug, please file issue GitHub minimal reproducible example using reprex package. Include: - description expected behavior vs. actual behavior. - output sessionInfo(). - minimal dataset use make_test_survey() test helpers.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CONTRIBUTING.html","id":"feature-requests-and-improvements","dir":"","previous_headings":"","what":"Feature requests and improvements","title":"Contributing to metasurvey","text":"Use GitHub Discussions propose new features, improvements, ideas. Post “Ideas” category clear description problem proposed solution. feature relates specific survey (ECH, EPH, EAII), include relevant variable names edition. metasurvey team reviews discussions decides ideas get prioritized implementation. Issues reserved confirmed bugs — team manages prioritization.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CONTRIBUTING.html","id":"pull-requests","dir":"","previous_headings":"","what":"Pull requests","title":"Contributing to metasurvey","text":"Fork repo create branch develop. Run devtools::document() changed roxygen comments. Add update tests tests/testthat/. Run devtools::test() ensure tests pass. Run devtools::check() fix warnings notes. Submit PR develop branch.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Pull requests","what":"Code style","title":"Contributing to metasurvey","text":"Use data.table syntax internal data operations. Follow existing naming conventions: step_* step functions, R6 classes use PascalCase. Keep functions focused avoid -engineering.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CONTRIBUTING.html","id":"testing","dir":"","previous_headings":"Pull requests","what":"Testing","title":"Contributing to metasurvey","text":"Use testthat edition 3. Test helpers tests/testthat/helper-survey.R (make_test_survey(), make_test_panel()). Integration tests need external data use skip_on_cran().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to metasurvey","text":"Please note project released Contributor Code Conduct. participating project agree abide terms.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://metasurveyr.github.io/metasurvey/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) 2024 Mauro Loprete This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"descripcion-general","dir":"Articles","previous_headings":"","what":"Descripcion general","title":"Referencia de la API y Base de Datos (ES)","text":"metasurvey provee una API REST construida con plumber respaldada por MongoDB para compartir recetas, workflows y metadatos de variables con la comunidad. La API se despliega en Railway y es utilizada tanto por las funciones del cliente R (api_*) como por la aplicacion Shiny de exploracion. URL de produccion: https://metasurvey-api-production..railway.app Documentacion interactiva de la API (Swagger UI): https://metasurvey-api-production..railway.app/__docs__/ La interfaz Swagger UI proporciona un explorador interactivo de endpoints generado automaticamente por plumber. Para esquemas detallados de solicitudes/respuestas y documentacion de las colecciones de MongoDB, consulte las secciones continuacion.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"configuracion","dir":"Articles","previous_headings":"","what":"Configuracion","title":"Referencia de la API y Base de Datos (ES)","text":"El cliente R lee la URL primero desde configure_api(), luego recurre la variable de entorno METASURVEY_API_URL, y finalmente utiliza la URL de produccion.","code":"library(metasurvey)  # Point to the production API (default) configure_api(\"https://metasurvey-api-production.up.railway.app\")  # Or use an environment variable Sys.setenv(METASURVEY_API_URL = \"https://metasurvey-api-production.up.railway.app\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"autenticacion","dir":"Articles","previous_headings":"","what":"Autenticacion","title":"Referencia de la API y Base de Datos (ES)","text":"La API utiliza autenticacion JWT (JSON Web Token) con firma HMAC-SHA256. Los tokens expiran despues de 24 horas; se pueden generar tokens de larga duracion (90 dias) para scripts automatizados.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"registro","dir":"Articles","previous_headings":"Autenticacion","what":"Registro","title":"Referencia de la API y Base de Datos (ES)","text":"Tipos de cuenta:","code":"# Individual account (auto-approved) api_register(\"Ana Garcia\", \"ana@example.com\", \"password123\")  # Institutional member (requires admin review) api_register(   \"Carlos Rodriguez\",   \"carlos@ine.gub.uy\",   \"password123\",   user_type = \"institutional_member\",   institution = \"INE Uruguay\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"inicio-de-sesion","dir":"Articles","previous_headings":"Autenticacion","what":"Inicio de sesion","title":"Referencia de la API y Base de Datos (ES)","text":"El token se almacena en la sesion y se utiliza automaticamente en las llamadas posteriores la API. El cliente renueva los tokens automaticamente dentro de los 5 minutos previos su expiracion.","code":"api_login(\"ana@example.com\", \"password123\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"gestion-de-sesion","dir":"Articles","previous_headings":"Autenticacion","what":"Gestion de sesion","title":"Referencia de la API y Base de Datos (ES)","text":"","code":"# View current user profile api_me()  # Refresh token api_refresh_token()  # Logout api_logout()"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"tokens-de-larga-duracion","dir":"Articles","previous_headings":"Autenticacion","what":"Tokens de larga duracion","title":"Referencia de la API y Base de Datos (ES)","text":"Para scripts automatizados y CI/CD, genere un token de 90 dias desde la aplicacion Shiny (pestana Perfil) o utilicelo directamente:","code":"Sys.setenv(METASURVEY_TOKEN = \"your-long-lived-token\")  # API calls work without interactive login recipes <- api_list_recipes(survey_type = \"ech\")"},{"path":[]},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"listar-recetas","dir":"Articles","previous_headings":"Endpoints de la API > Recetas","what":"Listar recetas","title":"Referencia de la API y Base de Datos (ES)","text":"Parametros de consulta:","code":"# All recipes all <- api_list_recipes()  # Filter by survey type ech <- api_list_recipes(survey_type = \"ech\")  # Search by text labor <- api_list_recipes(search = \"empleo\")  # Filter by topic income <- api_list_recipes(topic = \"income\")  # Filter by certification level official <- api_list_recipes(certification = \"official\")  # Pagination page2 <- api_list_recipes(limit = 10, offset = 10)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"obtener-receta","dir":"Articles","previous_headings":"Endpoints de la API > Recetas","what":"Obtener receta","title":"Referencia de la API y Base de Datos (ES)","text":"","code":"recipe <- api_get_recipe(\"ech_employment_001\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"publicar-receta","dir":"Articles","previous_headings":"Endpoints de la API > Recetas","what":"Publicar receta","title":"Referencia de la API y Base de Datos (ES)","text":"El servidor establece automaticamente el campo user partir del JWT, inicializa downloads = 0, genera un id si se proporciona, y asigna la certificacion community por defecto.","code":"api_login(\"ana@example.com\", \"password123\") api_publish_recipe(my_recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"workflows","dir":"Articles","previous_headings":"Endpoints de la API","what":"Workflows","title":"Referencia de la API y Base de Datos (ES)","text":"","code":"# List workflows for ECH wf <- api_list_workflows(survey_type = \"ech\")  # Find workflows that use a specific recipe wf <- api_list_workflows(recipe_id = \"ech_employment_001\")  # Get specific workflow w <- api_get_workflow(\"wf_labor_market_001\")  # Publish api_publish_workflow(my_workflow)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"metadatos-de-variables-anda","dir":"Articles","previous_headings":"Endpoints de la API","what":"Metadatos de variables ANDA","title":"Referencia de la API y Base de Datos (ES)","text":"Nota: La integracion con ANDA es una implementacion oficial que analiza metadatos DDI XML del catalogo publico ANDA del INE Uruguay. esta avalada por el INE y puede contener errores o quedar desactualizada si el INE modifica la estructura del catalogo. Siempre verifique las definiciones criticas de variables contra el libro de codigos oficial. El endpoint /anda/variables proporciona metadatos de variables obtenidos del catalogo ANDA del INE Uruguay (formato DDI XML). Esto incluye etiquetas de variables, categorias de valores e informacion de tipo. Parametros de consulta: Cada documento de variable contiene:","code":"# Get all ECH variables vars <- api_get_anda_variables(survey_type = \"ech\")  # Get specific variables vars <- api_get_anda_variables(   survey_type = \"ech\",   var_names = c(\"pobpcoac\", \"e27\", \"ht11\") )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"administracion","dir":"Articles","previous_headings":"Endpoints de la API","what":"Administracion","title":"Referencia de la API y Base de Datos (ES)","text":"El acceso de administrador se controla mediante la variable de entorno METASURVEY_ADMIN_EMAIL en el servidor.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"verificacion-de-estado","dir":"Articles","previous_headings":"Endpoints de la API","what":"Verificacion de estado","title":"Referencia de la API y Base de Datos (ES)","text":"","code":"{   \"status\": \"ok\",   \"service\": \"metasurvey-api\",   \"version\": \"2.0.0\",   \"database\": \"metasurvey\",   \"mongodb\": \"connected\",   \"timestamp\": \"2026-02-15T12:00:00Z\" }"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"esquema-de-mongodb","dir":"Articles","previous_headings":"","what":"Esquema de MongoDB","title":"Referencia de la API y Base de Datos (ES)","text":"La base de datos tiene cuatro colecciones, cada una con validacion de esquema JSON e indices optimizados.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"diagrama-entidad-relacion","dir":"Articles","previous_headings":"Esquema de MongoDB","what":"Diagrama Entidad-Relacion","title":"Referencia de la API y Base de Datos (ES)","text":"El siguiente diagrama muestra las colecciones de MongoDB y sus relaciones:","code":"erDiagram     users {         string email PK         string name         string password_hash         string user_type         string institution     }     recipes {         string id PK         string name         string user FK         string survey_type         string edition         array steps         object certification         array categories     }     workflows {         string id PK         string name         string user FK         string survey_type         array recipe_ids FK         array calls     }     anda_variables {         string survey_type PK         string name PK         string label         string type         object value_labels     }      users ||--o{ recipes : publica     users ||--o{ workflows : publica     recipes ||--o{ workflows : referencia"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"users","dir":"Articles","previous_headings":"Esquema de MongoDB > Colecciones","what":"users","title":"Referencia de la API y Base de Datos (ES)","text":"Indices: unico en email.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"recipes","dir":"Articles","previous_headings":"Esquema de MongoDB > Colecciones","what":"recipes","title":"Referencia de la API y Base de Datos (ES)","text":"Indices: unico en id; en user, survey_type, topic, downloads (desc), certification.level; compuesto en (survey_type, edition); busqueda de texto en (name, description, topic).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"workflows-1","dir":"Articles","previous_headings":"Esquema de MongoDB > Colecciones","what":"workflows","title":"Referencia de la API y Base de Datos (ES)","text":"Indices: unico en id; en user, survey_type, recipe_ids, downloads (desc); compuesto en (survey_type, edition); busqueda de texto en (name, description).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"anda_variables","dir":"Articles","previous_headings":"Esquema de MongoDB > Colecciones","what":"anda_variables","title":"Referencia de la API y Base de Datos (ES)","text":"Indices: compuesto unico en (survey_type, name); en survey_type.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"configuracion-de-la-base-de-datos","dir":"Articles","previous_headings":"","what":"Configuracion de la base de datos","title":"Referencia de la API y Base de Datos (ES)","text":"Para configurar la base de datos en un nuevo despliegue: El script de configuracion crea las cuatro colecciones y construye los indices. Es idempotente: las colecciones existentes se omiten.","code":"# 1. Create collections with JSON Schema validation and indexes mongosh \"$METASURVEY_MONGO_URI\" inst/scripts/setup_mongodb.js  # 2. Seed recipes, workflows, and users METASURVEY_MONGO_URI=\"...\" Rscript inst/scripts/seed_ech_recipes.R  # 3. Seed ANDA variable metadata from INE catalog METASURVEY_MONGO_URI=\"...\" Rscript inst/scripts/seed_anda_metadata.R"},{"path":[]},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"ejecucion-local","dir":"Articles","previous_headings":"Despliegue del servidor","what":"Ejecucion local","title":"Referencia de la API y Base de Datos (ES)","text":"La interfaz Swagger UI estara disponible en http://localhost:8787/__docs__/.","code":"METASURVEY_MONGO_URI=\"mongodb+srv://user:pass@cluster.mongodb.net\" \\   Rscript -e 'plumber::plumb(\"inst/api/plumber.R\")$run(port = 8787)'"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"docker","dir":"Articles","previous_headings":"Despliegue del servidor","what":"Docker","title":"Referencia de la API y Base de Datos (ES)","text":"","code":"docker build -t metasurvey-api inst/api/ docker run -p 8787:8787 \\   -e METASURVEY_MONGO_URI=\"mongodb+srv://...\" \\   -e METASURVEY_JWT_SECRET=\"your-production-secret\" \\   -e METASURVEY_ADMIN_EMAIL=\"admin@example.com\" \\   metasurvey-api"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"railway","dir":"Articles","previous_headings":"Despliegue del servidor","what":"Railway","title":"Referencia de la API y Base de Datos (ES)","text":"La API esta configurada para despliegue en Railway mediante el archivo render.yaml en inst/api/. Suba el repositorio y configure las variables de entorno en el panel de Railway.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"cors","dir":"Articles","previous_headings":"","what":"CORS","title":"Referencia de la API y Base de Datos (ES)","text":"La API permite solicitudes de origen cruzado desde cualquier origen: Metodos permitidos: GET, POST, OPTIONS Encabezados permitidos: Content-Type, Authorization","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database-es.html","id":"proximos-pasos","dir":"Articles","previous_headings":"","what":"Proximos pasos","title":"Referencia de la API y Base de Datos (ES)","text":"Explorador interactivo de recetas – Navegue recetas y workflows traves de la aplicacion web Shiny Creacion y publicacion de recetas – Construya recetas de forma programatica y publiquelas en la API Workflows de estimacion – Calcule estimaciones ponderadas de encuestas con workflow()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"API and Database Reference","text":"metasurvey provides REST API built plumber backed MongoDB sharing recipes, workflows, variable metadata community. API can self-hosted (see vignette(\"self-hosting\")) used R client functions (api_*) Shiny exploration application. deploying, Swagger UI interface <-api-url>/__docs__/ provides interactive endpoint explorer automatically generated plumber. detailed request/response schemas MongoDB collection documentation, see sections .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"configuration","dir":"Articles","previous_headings":"","what":"Configuration","title":"API and Database Reference","text":"R client reads URL first configure_api(), falls back METASURVEY_API_URL environment variable.","code":"library(metasurvey)  # Point to your self-hosted API configure_api(\"https://your-api-host.example.com\")  # Or use an environment variable Sys.setenv(METASURVEY_API_URL = \"https://your-api-host.example.com\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"authentication","dir":"Articles","previous_headings":"","what":"Authentication","title":"API and Database Reference","text":"API uses JWT (JSON Web Token) authentication HMAC-SHA256 signing. Tokens expire 24 hours; long-lived tokens (90 days) can generated automated scripts.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"registration","dir":"Articles","previous_headings":"Authentication","what":"Registration","title":"API and Database Reference","text":"Account types:","code":"# Individual account (auto-approved) api_register(\"Ana Garcia\", \"ana@example.com\", \"password123\")  # Institutional member (requires admin review) api_register(   \"Carlos Rodriguez\",   \"carlos@ine.gub.uy\",   \"password123\",   user_type = \"institutional_member\",   institution = \"INE Uruguay\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"login","dir":"Articles","previous_headings":"Authentication","what":"Login","title":"API and Database Reference","text":"token stored session used automatically subsequent API calls. client automatically renews tokens within 5 minutes expiration.","code":"api_login(\"ana@example.com\", \"password123\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"session-management","dir":"Articles","previous_headings":"Authentication","what":"Session Management","title":"API and Database Reference","text":"","code":"# View current user profile api_me()  # Refresh token api_refresh_token()  # Logout api_logout()"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"long-lived-tokens","dir":"Articles","previous_headings":"Authentication","what":"Long-lived Tokens","title":"API and Database Reference","text":"automated scripts CI/CD, generate 90-day token Shiny application (Profile tab) use directly:","code":"Sys.setenv(METASURVEY_TOKEN = \"your-long-lived-token\")  # API calls work without interactive login recipes <- api_list_recipes(survey_type = \"ech\")"},{"path":[]},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"list-recipes","dir":"Articles","previous_headings":"API Endpoints > Recipes","what":"List Recipes","title":"API and Database Reference","text":"Query parameters:","code":"# All recipes all <- api_list_recipes()  # Filter by survey type ech <- api_list_recipes(survey_type = \"ech\")  # Search by text labor <- api_list_recipes(search = \"empleo\")  # Filter by topic income <- api_list_recipes(topic = \"income\")  # Filter by certification level official <- api_list_recipes(certification = \"official\")  # Pagination page2 <- api_list_recipes(limit = 10, offset = 10)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"get-recipe","dir":"Articles","previous_headings":"API Endpoints > Recipes","what":"Get Recipe","title":"API and Database Reference","text":"","code":"recipe <- api_get_recipe(\"ech_employment_001\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"publish-recipe","dir":"Articles","previous_headings":"API Endpoints > Recipes","what":"Publish Recipe","title":"API and Database Reference","text":"server automatically sets user field JWT, initializes downloads = 0, generates id provided, assigns community certification default.","code":"api_login(\"ana@example.com\", \"password123\") api_publish_recipe(my_recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"workflows","dir":"Articles","previous_headings":"API Endpoints","what":"Workflows","title":"API and Database Reference","text":"","code":"# List workflows for ECH wf <- api_list_workflows(survey_type = \"ech\")  # Find workflows that use a specific recipe wf <- api_list_workflows(recipe_id = \"ech_employment_001\")  # Get specific workflow w <- api_get_workflow(\"wf_labor_market_001\")  # Publish api_publish_workflow(my_workflow)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"anda-variable-metadata","dir":"Articles","previous_headings":"API Endpoints","what":"ANDA Variable Metadata","title":"API and Database Reference","text":"Note: ANDA integration unofficial implementation parses DDI XML metadata INE Uruguay’s public ANDA catalog. endorsed INE may contain errors become outdated INE changes catalog structure. Always verify critical variable definitions official codebook. /anda/variables endpoint provides variable metadata obtained INE Uruguay’s ANDA catalog (DDI XML format). includes variable labels, value categories, type information. Query parameters: variable document contains:","code":"# Get all ECH variables vars <- api_get_anda_variables(survey_type = \"ech\")  # Get specific variables vars <- api_get_anda_variables(   survey_type = \"ech\",   var_names = c(\"pobpcoac\", \"e27\", \"ht11\") )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"administration","dir":"Articles","previous_headings":"API Endpoints","what":"Administration","title":"API and Database Reference","text":"Admin access controlled via METASURVEY_ADMIN_EMAIL environment variable server.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"health-check","dir":"Articles","previous_headings":"API Endpoints","what":"Health Check","title":"API and Database Reference","text":"","code":"{   \"status\": \"ok\",   \"service\": \"metasurvey-api\",   \"version\": \"2.0.0\",   \"database\": \"metasurvey\",   \"mongodb\": \"connected\",   \"timestamp\": \"2026-02-15T12:00:00Z\" }"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"mongodb-schema","dir":"Articles","previous_headings":"","what":"MongoDB Schema","title":"API and Database Reference","text":"database four collections, JSON Schema validation optimized indexes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"entity-relationship-diagram","dir":"Articles","previous_headings":"MongoDB Schema","what":"Entity-Relationship Diagram","title":"API and Database Reference","text":"following diagram shows MongoDB collections relationships:","code":"┌──────────────────┐       ┌──────────────────────┐   │     users         │       │      recipes          │   ├──────────────────┤       ├──────────────────────┤   │ email (PK)       │──┐    │ id (PK)              │   │ name             │  │    │ name                 │   │ password_hash    │  ├───>│ user (FK)            │   │ user_type        │  │    │ survey_type          │   │ institution      │  │    │ edition              │   └──────────────────┘  │    │ steps[]              │                         │    │ certification{}      │                         │    │ categories[]         │                         │    └──────────┬───────────┘                         │               │                         │    ┌──────────┴───────────┐                         │    │     workflows         │                         │    ├──────────────────────┤                         │    │ id (PK)              │                         └───>│ user (FK)            │                              │ survey_type          │                              │ recipe_ids[] (FK)    │                              │ calls[]              │                              └──────────────────────┘    ┌──────────────────────┐   │   anda_variables      │   ├──────────────────────┤   │ survey_type (PK)     │   │ name (PK)            │   │ label                │   │ type                 │   │ value_labels{}       │   └──────────────────────┘    Relationships:     users    ──1:N──>  recipes     (publishes)     users    ──1:N──>  workflows   (publishes)     recipes  ──1:N──>  workflows   (referenced by)"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"users","dir":"Articles","previous_headings":"MongoDB Schema > Collections","what":"users","title":"API and Database Reference","text":"Indexes: unique email.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"recipes-1","dir":"Articles","previous_headings":"MongoDB Schema > Collections","what":"recipes","title":"API and Database Reference","text":"Indexes: unique id; user, survey_type, topic, downloads (desc), certification.level; compound (survey_type, edition); text search (name, description, topic).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"workflows-1","dir":"Articles","previous_headings":"MongoDB Schema > Collections","what":"workflows","title":"API and Database Reference","text":"Indexes: unique id; user, survey_type, recipe_ids, downloads (desc); compound (survey_type, edition); text search (name, description).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"anda_variables","dir":"Articles","previous_headings":"MongoDB Schema > Collections","what":"anda_variables","title":"API and Database Reference","text":"Indexes: compound unique (survey_type, name); survey_type.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"database-setup","dir":"Articles","previous_headings":"","what":"Database Setup","title":"API and Database Reference","text":"set database new deployment: setup script creates four collections builds indexes. idempotent: existing collections skipped.","code":"# 1. Create collections with JSON Schema validation and indexes mongosh \"$METASURVEY_MONGO_URI\" inst/scripts/setup_mongodb.js  # 2. Seed recipes, workflows, and users METASURVEY_MONGO_URI=\"...\" Rscript inst/scripts/seed_ech_recipes.R  # 3. Seed ANDA variable metadata from INE catalog METASURVEY_MONGO_URI=\"...\" Rscript inst/scripts/seed_anda_metadata.R"},{"path":[]},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"running-locally","dir":"Articles","previous_headings":"Server Deployment","what":"Running Locally","title":"API and Database Reference","text":"Swagger UI interface available http://localhost:8787/__docs__/.","code":"METASURVEY_MONGO_URI=\"mongodb+srv://user:pass@cluster.mongodb.net\" \\   Rscript -e 'plumber::plumb(\"inst/api/plumber.R\")$run(port = 8787)'"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"docker","dir":"Articles","previous_headings":"Server Deployment","what":"Docker","title":"API and Database Reference","text":"","code":"docker build -t metasurvey-api inst/api/ docker run -p 8787:8787 \\   -e METASURVEY_MONGO_URI=\"mongodb+srv://...\" \\   -e METASURVEY_JWT_SECRET=\"your-production-secret\" \\   -e METASURVEY_ADMIN_EMAIL=\"admin@example.com\" \\   metasurvey-api"},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"railway","dir":"Articles","previous_headings":"Server Deployment","what":"Railway","title":"API and Database Reference","text":"API configured Railway deployment via render.yaml file inst/api/. Push repository configure environment variables Railway dashboard.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"cors","dir":"Articles","previous_headings":"","what":"CORS","title":"API and Database Reference","text":"API allows cross-origin requests origin: Allowed methods: GET, POST, OPTIONS Allowed headers: Content-Type, Authorization","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/api-database.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"API and Database Reference","text":"Interactive recipe explorer – Browse recipes workflows Shiny web application Creating publishing recipes – Build recipes programmatically publish API Estimation workflows – Compute weighted survey estimates workflow()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"introducción","dir":"Articles","previous_headings":"","what":"Introducción","title":"Diseños de encuestas y validación (ES)","text":"Los diseños muestrales complejos requieren un tratamiento especial para la estimación correcta de la varianza. metasurvey gestiona el diseño muestral de forma automática través del objeto Survey, de modo que el usuario pueda concentrarse en el análisis y en los detalles técnicos. Esta viñeta cubre los siguientes temas: Creación de encuestas con distintos tipos de diseño Configuración de ponderadores y motores de datos Validación del pipeline de procesamiento Verificación cruzada de resultados con el paquete survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"configuración-inicial","dir":"Articles","previous_headings":"","what":"Configuración inicial","title":"Diseños de encuestas y validación (ES)","text":"Utilizamos el conjunto de datos Academic Performance Index (API) del paquete survey. Este incluye versiones estratificadas, por conglomerados y de muestreo aleatorio simple.","code":"library(metasurvey) library(survey) library(data.table)  data(api, package = \"survey\") dt_strat <- data.table(apistrat)"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"diseño-ponderado-simple","dir":"Articles","previous_headings":"Tipos de diseño muestral","what":"Diseño ponderado simple","title":"Diseños de encuestas y validación (ES)","text":"El diseño más sencillo utiliza ponderadores de probabilidad sin conglomerados ni estratificación:","code":"svy_simple <- Survey$new(   data = dt_strat,   edition = \"2000\",   type = \"api\",   psu = NULL,   engine = \"data.table\",   weight = add_weight(annual = \"pw\") )  cat_design(svy_simple) #> [1] \"\\n  Design: Not initialized (lazy initialization - will be created when needed)\\n\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"diseno-estratificado-por-conglomerados","dir":"Articles","previous_headings":"Tipos de diseño muestral","what":"Diseno estratificado por conglomerados","title":"Diseños de encuestas y validación (ES)","text":"Muchas encuestas nacionales utilizan muestreo estratificado multietapico. Se pasan strata y psu Survey$new(): Validacion cruzada con el paquete survey: Para ejemplos reales de disenos estratificados por conglomerados con datos de CASEN, PNADc, ENIGH y DHS, ver vignette(\"international-surveys\").","code":"dt_clus <- data.table(apiclus1)  svy_strat_clus <- Survey$new(   data    = dt_strat,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   strata  = \"stype\",   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\") )  cat_design(svy_strat_clus) #> [1] \"\\n  Design: Not initialized (lazy initialization - will be created when needed)\\n\" design_strat <- svydesign(   id = ~1, strata = ~stype, weights = ~pw,   data = dt_strat ) direct_strat <- svymean(~api00, design_strat)  wf_strat <- workflow(   list(svy_strat_clus),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"annual\" )  cat(\"Direct estimate:\", round(coef(direct_strat), 2), \"\\n\") #> Direct estimate: 662.29 cat(\"Workflow estimate:\", round(wf_strat$value, 2), \"\\n\") #> Workflow estimate: 662.29 cat(\"Match:\", all.equal(   as.numeric(coef(direct_strat)),   wf_strat$value,   tolerance = 1e-6 ), \"\\n\") #> Match: TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"inspeccion-del-diseno","dir":"Articles","previous_headings":"Tipos de diseño muestral","what":"Inspeccion del diseno","title":"Diseños de encuestas y validación (ES)","text":"","code":"# Check design type cat_design_type(svy_simple, \"annual\") #> [1] \"None\"  # View metadata get_metadata(svy_simple) #> Type: API #> Edition: 2000 #> Periodicity: Annual #> Engine: data.table #> Design:  #>   Design: Not initialized (lazy initialization - will be created when needed) #>  #> Steps: None #> Recipes: None"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"múltiples-tipos-de-ponderadores","dir":"Articles","previous_headings":"Tipos de diseño muestral","what":"Múltiples tipos de ponderadores","title":"Diseños de encuestas y validación (ES)","text":"Muchas encuestas proporcionan diferentes ponderadores según el período de análisis (por ejemplo, anual vs. mensual). metasurvey asocia etiquetas de periodicidad columnas de ponderadores:","code":"set.seed(42) dt_multi <- copy(dt_strat) dt_multi[, pw_monthly := pw * runif(.N, 0.9, 1.1)]  svy_multi <- Survey$new(   data    = dt_multi,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\", monthly = \"pw_monthly\") )  # Use different weight types in workflow() annual_est <- workflow(   list(svy_multi),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"annual\" )  monthly_est <- workflow(   list(svy_multi),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"monthly\" )  cat(\"Annual estimate:\", round(annual_est$value, 1), \"\\n\") #> Annual estimate: 662.3 cat(\"Monthly estimate:\", round(monthly_est$value, 1), \"\\n\") #> Monthly estimate: 662.5"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"ponderadores-de-réplicas-bootstrap","dir":"Articles","previous_headings":"Tipos de diseño muestral","what":"Ponderadores de réplicas bootstrap","title":"Diseños de encuestas y validación (ES)","text":"Para encuestas que proporcionan réplicas bootstrap (como la ECH de Uruguay), se utiliza add_replicate() dentro de add_weight(): Cuando se configuran ponderadores de réplicas, workflow() los utiliza automáticamente para la estimación de varianza mediante survey::svrepdesign().","code":"# This example requires external files svy_boot <- load_survey(   path = \"data/main_survey.csv\",   svy_type = \"ech\",   svy_edition = \"2023\",   svy_weight = add_weight(     annual = add_replicate(       weight_var = \"pesoano\",       replicate_path = \"data/bootstrap_replicates.csv\",       replicate_id = c(\"numero\" = \"id\"),       replicate_pattern = \"bsrep[0-9]+\",       replicate_type = \"bootstrap\"     )   ) )"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"motor-de-datos","dir":"Articles","previous_headings":"Configuración del motor y el procesamiento","what":"Motor de datos","title":"Diseños de encuestas y validación (ES)","text":"metasurvey utiliza data.table por defecto para una manipulación rápida de los datos:","code":"# Current engine get_engine() #> [1] \"data.table\"  # Available engines show_engines() #> [1] \"data.table\" \"tidyverse\"  \"dplyr\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"procesamiento-diferido-lazy","dir":"Articles","previous_headings":"Configuración del motor y el procesamiento","what":"Procesamiento diferido (lazy)","title":"Diseños de encuestas y validación (ES)","text":"Por defecto, los steps se registran pero se ejecutan hasta que se invoca bake_steps(). Esto permite realizar validaciones antes de la ejecución:","code":"# Check current setting lazy_default() #> [1] TRUE  # Change for the session (not recommended for most workflows) # set_lazy_processing(FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"comportamiento-de-copia","dir":"Articles","previous_headings":"Configuración del motor y el procesamiento","what":"Comportamiento de copia","title":"Diseños de encuestas y validación (ES)","text":"Se puede controlar si las operaciones de steps modifican los datos -place o trabajan sobre copias:","code":"# Current setting use_copy_default() #> [1] TRUE  # In-place is faster but modifies the original # set_use_copy(FALSE)"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"varianza-basada-en-el-diseño","dir":"Articles","previous_headings":"Estimación de varianza","what":"Varianza basada en el diseño","title":"Diseños de encuestas y validación (ES)","text":"Estimación estándar de varianza utilizando el diseño muestral:","code":"results <- workflow(   list(svy_simple),   survey::svymean(~api00, na.rm = TRUE),   survey::svytotal(~enroll, na.rm = TRUE),   estimation_type = \"annual\" )  results #>                        stat        value           se         cv confint_lower #>                      <char>        <num>        <num>      <num>         <num> #> 1:   survey::svymean: api00     662.2874 9.585429e+00 0.01447322      643.5003 #> 2: survey::svytotal: enroll 3687177.5324 1.645323e+05 0.04462283  3364700.1537 #>    confint_upper #>            <num> #> 1:      681.0745 #> 2:  4009654.9112"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"estimación-por-dominios","dir":"Articles","previous_headings":"Estimación de varianza","what":"Estimación por dominios","title":"Diseños de encuestas y validación (ES)","text":"Se pueden calcular estimaciones para subpoblaciones utilizando survey::svyby():","code":"domain_results <- workflow(   list(svy_simple),   survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  domain_results #>                              stat  value       se         cv confint_lower #>                            <char>  <num>    <num>      <num>         <num> #> 1: survey::svyby: api00 [stype=E] 674.43 12.49343 0.01852443      649.9433 #> 2: survey::svyby: api00 [stype=H] 625.82 15.34078 0.02451309      595.7526 #> 3: survey::svyby: api00 [stype=M] 636.60 16.50239 0.02592270      604.2559 #>    confint_upper  stype #>            <num> <fctr> #> 1:      698.9167      E #> 2:      655.8874      H #> 3:      668.9441      M"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"razones","dir":"Articles","previous_headings":"Estimación de varianza","what":"Razones","title":"Diseños de encuestas y validación (ES)","text":"","code":"ratio_result <- workflow(   list(svy_simple),   survey::svyratio(~api00, ~api99),   estimation_type = \"annual\" )  ratio_result #>                             stat    value         se          cv confint_lower #>                           <char>    <num>      <num>       <num>         <num> #> 1: survey::svyratio: api00/api99 1.052261 0.00379243 0.003604079      1.044828 #>    confint_upper #>            <num> #> 1:      1.059694"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"verificación-paso-a-paso","dir":"Articles","previous_headings":"Validación del pipeline","what":"Verificación paso a paso","title":"Diseños de encuestas y validación (ES)","text":"Al construir pipelines complejos, conviene verificar cada paso de forma independiente:","code":"# Step 1: Compute new variable svy_v <- step_compute(svy_simple,   api_diff = api00 - api99,   comment = \"API score difference\" )  # Check that the step was recorded steps <- get_steps(svy_v) cat(\"Pending steps:\", length(steps), \"\\n\") #> Pending steps: 1"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"validación-cruzada-con-el-paquete-survey","dir":"Articles","previous_headings":"Validación del pipeline","what":"Validación cruzada con el paquete survey","title":"Diseños de encuestas y validación (ES)","text":"Se pueden comparar los resultados de workflow() de metasurvey con llamadas directas al paquete survey:","code":"# Method 1: Direct survey package design <- svydesign(id = ~1, weights = ~pw, data = dt_strat) direct_mean <- svymean(~api00, design)  # Method 2: metasurvey workflow wf_result <- workflow(   list(svy_simple),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"annual\" )  cat(\"Direct estimate:\", round(coef(direct_mean), 2), \"\\n\") #> Direct estimate: 662.29 cat(\"Workflow estimate:\", round(wf_result$value, 2), \"\\n\") #> Workflow estimate: 662.29 cat(\"Match:\", all.equal(   as.numeric(coef(direct_mean)),   wf_result$value,   tolerance = 1e-6 ), \"\\n\") #> Match: TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"visualización-del-pipeline","dir":"Articles","previous_headings":"Validación del pipeline","what":"Visualización del pipeline","title":"Diseños de encuestas y validación (ES)","text":"Se puede utilizar view_graph() para visualizar el grafo de dependencias entre steps:","code":"# Requires the visNetwork package svy_viz <- step_compute(svy_simple,   api_diff = api00 - api99,   high_growth = ifelse(api00 - api99 > 50, 1L, 0L) ) view_graph(svy_viz, init_step = \"Load API data\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"evaluación-de-calidad","dir":"Articles","previous_headings":"Validación del pipeline","what":"Evaluación de calidad","title":"Diseños de encuestas y validación (ES)","text":"Se puede evaluar la calidad de las estimaciones utilizando el coeficiente de variación:","code":"results_quality <- workflow(   list(svy_simple),   survey::svymean(~api00, na.rm = TRUE),   survey::svymean(~enroll, na.rm = TRUE),   estimation_type = \"annual\" )  for (i in seq_len(nrow(results_quality))) {   cv_pct <- results_quality$cv[i] * 100   cat(     results_quality$stat[i], \":\",     round(cv_pct, 1), \"% CV -\",     evaluate_cv(cv_pct), \"\\n\"   ) } #> survey::svymean: api00 : 1.4 % CV - Excellent  #> survey::svymean: enroll : 4.5 % CV - Excellent"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"validación-de-recipes","dir":"Articles","previous_headings":"Validación del pipeline","what":"Validación de recipes","title":"Diseños de encuestas y validación (ES)","text":"Se puede verificar que los recipes y sus steps sean consistentes:","code":"# Create steps and recipe svy_rt <- step_compute(svy_simple, api_diff = api00 - api99)  my_recipe <- steps_to_recipe(   name        = \"API Test\",   user        = \"QA Team\",   svy         = svy_rt,   description = \"Recipe for validation\",   steps       = get_steps(svy_rt) )  # Check documentation is correct doc <- my_recipe$doc() cat(\"Input variables:\", paste(doc$input_variables, collapse = \", \"), \"\\n\") #> Input variables: api00, api99 cat(\"Output variables:\", paste(doc$output_variables, collapse = \", \"), \"\\n\") #> Output variables: api_diff  # Validate against the survey my_recipe$validate(svy_rt) #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"lista-de-verificación-para-validación","dir":"Articles","previous_headings":"","what":"Lista de verificación para validación","title":"Diseños de encuestas y validación (ES)","text":"Antes de poner en producción un pipeline de procesamiento de encuestas, se recomienda verificar lo siguiente: Integridad de los datos – cantidad de filas, nombres de columnas y tipos de datos después de cada step Validación de ponderadores – las columnas de ponderadores existen y son positivas Verificación del diseño – el diseño muestral coincide con la especificación esperada (PSU, estratos, ponderadores) Reproducibilidad del recipe – guardar y recargar recipes, verificar el round-trip en JSON Validación cruzada – comparar estimaciones clave con valores publicados o llamadas directas al paquete survey Umbrales de CV – señalar estimaciones con coeficientes de variación elevados","code":"validate_pipeline <- function(svy) {   data <- get_data(svy)   checks <- list(     has_data = !is.null(data),     has_rows = nrow(data) > 0,     has_weights = all(       unlist(svy$weight)[is.character(unlist(svy$weight))] %in% names(data)     )   )    passed <- all(unlist(checks))   if (passed) {     message(\"All validation checks passed\")   } else {     failed <- names(checks)[!unlist(checks)]     warning(\"Failed checks: \", paste(failed, collapse = \", \"))   }   invisible(checks) }  validate_pipeline(svy_simple)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"buenas-prácticas","dir":"Articles","previous_headings":"","what":"Buenas prácticas","title":"Diseños de encuestas y validación (ES)","text":"Utilizar siempre los ponderadores adecuados – nunca calcular estadísticos sin ponderar partir de datos de encuestas Usar ponderadores de réplicas cuando estén disponibles – proporcionan estimaciones de varianza más robustas Verificar los tamaños de muestra por dominio – combinar dominios pequeños cuando los CV sean demasiado altos Documentar el diseño – incluir la especificación del diseño, la construcción de los ponderadores y el método de varianza Validar cruzadamente las estimaciones clave – comparar con valores publicados o métodos alternativos","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs-es.html","id":"próximos-pasos","dir":"Articles","previous_headings":"","what":"Próximos pasos","title":"Diseños de encuestas y validación (ES)","text":"Flujos de estimación – workflow(), RecipeWorkflow y estimaciones publicables Paneles rotativos y PoolSurvey – Análisis longitudinal con RotativePanelSurvey y PoolSurvey Primeros pasos – Revisar los conceptos básicos de steps y objetos Survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Survey Designs and Validation","text":"Complex sampling designs require special treatment correct variance estimation. metasurvey manages sampling design automatically Survey object, users can focus analysis rather technical details. vignette covers following topics: Creating surveys different design types Configuring weights data engines Validating processing pipeline Cross-checking results survey package","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"initial-setup","dir":"Articles","previous_headings":"","what":"Initial Setup","title":"Survey Designs and Validation","text":"use Academic Performance Index (API) dataset survey package. includes stratified, cluster, simple random sampling versions.","code":"library(metasurvey) library(survey) library(data.table)  data(api, package = \"survey\") dt_strat <- data.table(apistrat)"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"simple-weighted-design","dir":"Articles","previous_headings":"Sampling Design Types","what":"Simple Weighted Design","title":"Survey Designs and Validation","text":"simplest design uses probability weights without clusters stratification:","code":"svy_simple <- Survey$new(   data = dt_strat,   edition = \"2000\",   type = \"api\",   psu = NULL,   engine = \"data.table\",   weight = add_weight(annual = \"pw\") )  cat_design(svy_simple) #> [1] \"\\n  Design: Not initialized (lazy initialization - will be created when needed)\\n\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"stratified-cluster-design","dir":"Articles","previous_headings":"Sampling Design Types","what":"Stratified Cluster Design","title":"Survey Designs and Validation","text":"Many national surveys use stratified multi-stage sampling. Pass strata psu Survey$new(): Cross-validate survey package: real-world examples stratified cluster designs CASEN, PNADc, ENIGH, DHS data, see vignette(\"international-surveys\").","code":"dt_clus <- data.table(apiclus1)  svy_strat_clus <- Survey$new(   data    = dt_strat,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   strata  = \"stype\",   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\") )  cat_design(svy_strat_clus) #> [1] \"\\n  Design: Not initialized (lazy initialization - will be created when needed)\\n\" design_strat <- svydesign(   id = ~1, strata = ~stype, weights = ~pw,   data = dt_strat ) direct_strat <- svymean(~api00, design_strat)  wf_strat <- workflow(   list(svy_strat_clus),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"annual\" )  cat(\"Direct estimate:\", round(coef(direct_strat), 2), \"\\n\") #> Direct estimate: 662.29 cat(\"Workflow estimate:\", round(wf_strat$value, 2), \"\\n\") #> Workflow estimate: 662.29 cat(\"Match:\", all.equal(   as.numeric(coef(direct_strat)),   wf_strat$value,   tolerance = 1e-6 ), \"\\n\") #> Match: TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"design-inspection","dir":"Articles","previous_headings":"Sampling Design Types","what":"Design Inspection","title":"Survey Designs and Validation","text":"","code":"# Check design type cat_design_type(svy_simple, \"annual\") #> [1] \"None\"  # View metadata get_metadata(svy_simple) #> Type: API #> Edition: 2000 #> Periodicity: Annual #> Engine: data.table #> Design:  #>   Design: Not initialized (lazy initialization - will be created when needed) #>  #> Steps: None #> Recipes: None"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"multiple-weight-types","dir":"Articles","previous_headings":"Sampling Design Types","what":"Multiple Weight Types","title":"Survey Designs and Validation","text":"Many surveys provide different weights depending analysis period (example, annual vs. monthly). metasurvey associates periodicity labels weight columns:","code":"set.seed(42) dt_multi <- copy(dt_strat) dt_multi[, pw_monthly := pw * runif(.N, 0.9, 1.1)]  svy_multi <- Survey$new(   data    = dt_multi,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\", monthly = \"pw_monthly\") )  # Use different weight types in workflow() annual_est <- workflow(   list(svy_multi),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"annual\" )  monthly_est <- workflow(   list(svy_multi),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"monthly\" )  cat(\"Annual estimate:\", round(annual_est$value, 1), \"\\n\") #> Annual estimate: 662.3 cat(\"Monthly estimate:\", round(monthly_est$value, 1), \"\\n\") #> Monthly estimate: 662.5"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"bootstrap-replicate-weights","dir":"Articles","previous_headings":"Sampling Design Types","what":"Bootstrap Replicate Weights","title":"Survey Designs and Validation","text":"surveys provide bootstrap replicates (Uruguay’s ECH), use add_replicate() inside add_weight(): replicate weights configured, workflow() automatically uses variance estimation via survey::svrepdesign().","code":"# Requires external bootstrap replicate CSV files svy_boot <- load_survey(   path = \"data/main_survey.csv\",   svy_type = \"ech\",   svy_edition = \"2023\",   svy_weight = add_weight(     annual = add_replicate(       weight_var = \"pesoano\",       replicate_path = \"data/bootstrap_replicates.csv\",       replicate_id = c(\"numero\" = \"id\"),       replicate_pattern = \"bsrep[0-9]+\",       replicate_type = \"bootstrap\"     )   ) )"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"data-engine","dir":"Articles","previous_headings":"Engine and Processing Configuration","what":"Data Engine","title":"Survey Designs and Validation","text":"metasurvey uses data.table default fast data manipulation:","code":"# Current engine get_engine() #> [1] \"data.table\"  # Available engines show_engines() #> [1] \"data.table\" \"tidyverse\"  \"dplyr\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"lazy-processing","dir":"Articles","previous_headings":"Engine and Processing Configuration","what":"Lazy Processing","title":"Survey Designs and Validation","text":"default, steps recorded executed bake_steps() called. allows validations performed execution:","code":"# Check current setting lazy_default() #> [1] TRUE  # Change for the session (not recommended for most workflows) # set_lazy_processing(FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"copy-behavior","dir":"Articles","previous_headings":"Engine and Processing Configuration","what":"Copy Behavior","title":"Survey Designs and Validation","text":"can control whether step operations modify data -place work copies:","code":"# Current setting use_copy_default() #> [1] TRUE  # In-place is faster but modifies the original # set_use_copy(FALSE)"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"design-based-variance","dir":"Articles","previous_headings":"Variance Estimation","what":"Design-Based Variance","title":"Survey Designs and Validation","text":"Standard variance estimation using sampling design:","code":"results <- workflow(   list(svy_simple),   survey::svymean(~api00, na.rm = TRUE),   survey::svytotal(~enroll, na.rm = TRUE),   estimation_type = \"annual\" )  results #>                        stat        value           se         cv confint_lower #>                      <char>        <num>        <num>      <num>         <num> #> 1:   survey::svymean: api00     662.2874 9.585429e+00 0.01447322      643.5003 #> 2: survey::svytotal: enroll 3687177.5324 1.645323e+05 0.04462283  3364700.1537 #>    confint_upper #>            <num> #> 1:      681.0745 #> 2:  4009654.9112"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"domain-estimation","dir":"Articles","previous_headings":"Variance Estimation","what":"Domain Estimation","title":"Survey Designs and Validation","text":"Estimates subpopulations can computed using survey::svyby():","code":"domain_results <- workflow(   list(svy_simple),   survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  domain_results #>                              stat  value       se         cv confint_lower #>                            <char>  <num>    <num>      <num>         <num> #> 1: survey::svyby: api00 [stype=E] 674.43 12.49343 0.01852443      649.9433 #> 2: survey::svyby: api00 [stype=H] 625.82 15.34078 0.02451309      595.7526 #> 3: survey::svyby: api00 [stype=M] 636.60 16.50239 0.02592270      604.2559 #>    confint_upper  stype #>            <num> <fctr> #> 1:      698.9167      E #> 2:      655.8874      H #> 3:      668.9441      M"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"ratios","dir":"Articles","previous_headings":"Variance Estimation","what":"Ratios","title":"Survey Designs and Validation","text":"","code":"ratio_result <- workflow(   list(svy_simple),   survey::svyratio(~api00, ~api99),   estimation_type = \"annual\" )  ratio_result #>                             stat    value         se          cv confint_lower #>                           <char>    <num>      <num>       <num>         <num> #> 1: survey::svyratio: api00/api99 1.052261 0.00379243 0.003604079      1.044828 #>    confint_upper #>            <num> #> 1:      1.059694"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"step-by-step-verification","dir":"Articles","previous_headings":"Pipeline Validation","what":"Step-by-Step Verification","title":"Survey Designs and Validation","text":"building complex pipelines, useful verify step independently:","code":"# Step 1: Compute new variable svy_v <- step_compute(svy_simple,   api_diff = api00 - api99,   comment = \"API score difference\" )  # Check that the step was recorded steps <- get_steps(svy_v) cat(\"Pending steps:\", length(steps), \"\\n\") #> Pending steps: 1"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"cross-validation-with-the-survey-package","dir":"Articles","previous_headings":"Pipeline Validation","what":"Cross-Validation with the survey Package","title":"Survey Designs and Validation","text":"can compare metasurvey workflow() results direct calls survey package:","code":"# Method 1: Direct survey package design <- svydesign(id = ~1, weights = ~pw, data = dt_strat) direct_mean <- svymean(~api00, design)  # Method 2: metasurvey workflow wf_result <- workflow(   list(svy_simple),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"annual\" )  cat(\"Direct estimate:\", round(coef(direct_mean), 2), \"\\n\") #> Direct estimate: 662.29 cat(\"Workflow estimate:\", round(wf_result$value, 2), \"\\n\") #> Workflow estimate: 662.29 cat(\"Match:\", all.equal(   as.numeric(coef(direct_mean)),   wf_result$value,   tolerance = 1e-6 ), \"\\n\") #> Match: TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"pipeline-visualization","dir":"Articles","previous_headings":"Pipeline Validation","what":"Pipeline Visualization","title":"Survey Designs and Validation","text":"can use view_graph() visualize dependency graph steps: interactive DAG rendered vignette keep package size small. Run code R session explore .","code":"svy_viz <- step_compute(svy_simple,   api_diff = api00 - api99,   high_growth = ifelse(api00 - api99 > 50, 1L, 0L) ) view_graph(svy_viz, init_step = \"Load API data\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"quality-assessment","dir":"Articles","previous_headings":"Pipeline Validation","what":"Quality Assessment","title":"Survey Designs and Validation","text":"can assess quality estimates using coefficient variation:","code":"results_quality <- workflow(   list(svy_simple),   survey::svymean(~api00, na.rm = TRUE),   survey::svymean(~enroll, na.rm = TRUE),   estimation_type = \"annual\" )  for (i in seq_len(nrow(results_quality))) {   cv_pct <- results_quality$cv[i] * 100   cat(     results_quality$stat[i], \":\",     round(cv_pct, 1), \"% CV -\",     evaluate_cv(cv_pct), \"\\n\"   ) } #> survey::svymean: api00 : 1.4 % CV - Excellent  #> survey::svymean: enroll : 4.5 % CV - Excellent"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"recipe-validation","dir":"Articles","previous_headings":"Pipeline Validation","what":"Recipe Validation","title":"Survey Designs and Validation","text":"can verify recipes steps consistent:","code":"# Create steps and recipe svy_rt <- step_compute(svy_simple, api_diff = api00 - api99)  my_recipe <- steps_to_recipe(   name        = \"API Test\",   user        = \"QA Team\",   svy         = svy_rt,   description = \"Recipe for validation\",   steps       = get_steps(svy_rt) )  # Check documentation is correct doc <- my_recipe$doc() cat(\"Input variables:\", paste(doc$input_variables, collapse = \", \"), \"\\n\") #> Input variables: api00, api99 cat(\"Output variables:\", paste(doc$output_variables, collapse = \", \"), \"\\n\") #> Output variables: api_diff  # Validate against the survey my_recipe$validate(svy_rt) #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"validation-checklist","dir":"Articles","previous_headings":"","what":"Validation Checklist","title":"Survey Designs and Validation","text":"putting survey processing pipeline production, following verified: Data integrity – row count, column names, data types step Weight validation – weight columns exist positive Design verification – sampling design matches expected specification (PSU, strata, weights) Recipe reproducibility – save reload recipes, verify JSON round-trip Cross-validation – compare key estimates published values direct calls survey package CV thresholds – flag estimates high coefficients variation","code":"validate_pipeline <- function(svy) {   data <- get_data(svy)   checks <- list(     has_data = !is.null(data),     has_rows = nrow(data) > 0,     has_weights = all(       unlist(svy$weight)[is.character(unlist(svy$weight))] %in% names(data)     )   )    passed <- all(unlist(checks))   if (passed) {     message(\"All validation checks passed\")   } else {     failed <- names(checks)[!unlist(checks)]     warning(\"Failed checks: \", paste(failed, collapse = \", \"))   }   invisible(checks) }  validate_pipeline(svy_simple)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"best-practices","dir":"Articles","previous_headings":"","what":"Best Practices","title":"Survey Designs and Validation","text":"Always use appropriate weights – never compute unweighted statistics survey data Use replicate weights available – provide robust variance estimates Check sample sizes domain – combine small domains CVs high Document design – include design specification, weight construction, variance method Cross-validate key estimates – compare published values alternative methods","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/complex-designs.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Survey Designs and Validation","text":"Estimation Workflows – workflow(), RecipeWorkflow, publishable estimates Rotating Panels PoolSurvey – Longitudinal analysis RotativePanelSurvey PoolSurvey Getting Started – Review basics steps Survey objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"el-problema-de-la-compatibilización-de-la-ech","dir":"Articles","previous_headings":"","what":"El problema de la compatibilización de la ECH","title":"Estudio de caso ECH: De STATA a R (ES)","text":"La Encuesta Continua de Hogares (ECH) de Uruguay es publicada anualmente por el Instituto Nacional de Estadística (INE). lo largo de los años, el INE ha modificado nombres de variables, definiciones del libro de códigos y la estructura de módulos entre ediciones. Quienes investigan con datos de la ECH deben compatibilizar variables —es decir, mapear las distintas convenciones de nombres un esquema común— antes de que cualquier análisis inter-anual sea posible. La compatibilización de la ECH ha sido un trabajo histórico del Instituto de Economía (IECON) de la Universidad de la República. El dataset resultante tiene DOI: http://doi.org/10.47426/ECH.INE (Instituto de Economía, 2020). metasurvey busca complementar y facilitar este tipo de trabajo ofreciendo herramientas reproducibles en R. En la academia uruguaya, este trabajo se ha realizado en STATA durante más de 30 años. Un pipeline de compatibilización típico consiste en aproximadamente 8 archivos .por año, cubriendo: 2_correc_datos.– Carga de datos crudos, unión de archivos de personas y hogares, corrección de nombres de variables 3_compatibilizacion_mod_1_4.– Armonización de módulos demográficos, de salud, educación y trabajo 4_ingreso_ht11.– Construcción del ingreso del hogar (ht11) 5_descomp_fuentes.– Descomposición del ingreso por fuente 6_ingreso_ht11_sss.– Ajustes de seguridad social 7_check_ingr.– Validación de variables de ingreso 8_arregla_base_comp.– Preparación final del dataset 9_labels.– Aplicación de etiquetas de valores Multiplicado por más de 30 años, eso significa más de 240 scripts de STATA haciendo esencialmente la misma tarea: mapear variables crudas de la ECH un esquema común. metasurvey resuelve esto con recipes. En lugar de mantener cientos de archivos ., se escribe un único recipe que codifica la lógica de transformación y puede aplicarse cualquier edición de la ECH.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"stata-vs-metasurvey-comparación-lado-a-lado","dir":"Articles","previous_headings":"","what":"STATA vs metasurvey: Comparación lado a lado","title":"Estudio de caso ECH: De STATA a R (ES)","text":"continuación se presenta un fragmento de un script de compatibilización típico en STATA para sexo, edad y parentesco: El equivalente en metasurvey: Las diferencias clave:","code":"* STATA: Typical ECH compatibility script  * sexo g bc_pe2 = e26  * edad g bc_pe3 = e27  * parentesco (e30 en ECH 2023, era e31 en ediciones anteriores) g bc_pe4 = -9   replace bc_pe4 = 1 if e30 == 1   replace bc_pe4 = 2 if e30 == 2   replace bc_pe4 = 3 if e30 == 3 | e30 == 4 | e30 == 5   replace bc_pe4 = 4 if e30 == 7 | e30 == 8   replace bc_pe4 = 5 if e30 == 6 | e30 == 9 | e30 == 10 | e30 == 11 | e30 == 12   replace bc_pe4 = 6 if e30 == 13   replace bc_pe4 = 7 if e30 == 14 svy <- step_rename(svy, sex = e26, age = e27)  svy <- step_recode(svy, relationship,   e30 == 1                ~ \"Head\",   e30 == 2                ~ \"Spouse\",   e30 %in% 3:5            ~ \"Child\",   e30 %in% c(7, 8)        ~ \"Parent\",   e30 %in% c(6, 9:12)     ~ \"Other relative\",   e30 == 13               ~ \"Domestic service\",   e30 == 14               ~ \"Non-relative\",   .default = NA_character_,   comment = \"Relationship to head of household\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"carga-de-microdatos-reales-de-la-ech","dir":"Articles","previous_headings":"","what":"Carga de microdatos reales de la ECH","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Utilizamos una muestra de microdatos reales de la ECH 2023, publicada por el INE. La muestra contiene 200 hogares (~500 personas) con las variables clave necesarias para el analisis del mercado laboral.","code":"library(metasurvey) library(data.table)  # Cargar muestra real de la ECH 2023 dt <- fread(system.file(\"extdata\", \"ech_2023_sample.csv\", package = \"metasurvey\"))  svy <- Survey$new(   data    = dt,   edition = \"2023\",   type    = \"ech\",   engine  = \"data.table\",   weight  = add_weight(annual = \"W_ANO\") )  head(get_data(svy), 3) #>       ID  nper  anio   mes region  dpto   nom_dpto   e26   e27   e30 e51_2 #>    <int> <int> <int> <int>  <int> <int>     <char> <int> <int> <int> <int> #> 1: 34561     1  2023     1      1     1 Montevideo     2    26     1     6 #> 2: 34561     2  2023     1      1     1 Montevideo     2    45     7     6 #> 3: 34561     3  2023     1      1     1 Montevideo     2     7     4     1 #>    POBPCOAC SUBEMPLEO    HT11 pobre06 W_ANO #>       <int>     <int>   <num>   <int> <int> #> 1:        2         0 55429.6       0    57 #> 2:        4         0 55429.6       0    57 #> 3:        1         0 55429.6       0    57"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"paso-1-variables-demográficas","dir":"Articles","previous_headings":"","what":"Paso 1: Variables demográficas","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Recodificar los códigos crudos del INE nombres legibles y recodificar variables categóricas:","code":"# Recode sex from INE codes (e26: 1=Male, 2=Female) svy <- step_recode(svy, sex,   e26 == 1 ~ \"Male\",   e26 == 2 ~ \"Female\",   .default = NA_character_,   comment = \"Sex: 1=Male, 2=Female (INE e26)\" )  # Recode age groups (standard ECH grouping, e27 = age) svy <- step_recode(svy, age_group,   e27 < 14 ~ \"Child (0-13)\",   e27 < 25 ~ \"Youth (14-24)\",   e27 < 45 ~ \"Adult (25-44)\",   e27 < 65 ~ \"Mature (45-64)\",   .default = \"Senior (65+)\",   .to_factor = TRUE,   ordered = TRUE,   comment = \"Standard age groups for labor statistics\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"paso-2-clasificación-de-la-fuerza-laboral","dir":"Articles","previous_headings":"","what":"Paso 2: Clasificación de la fuerza laboral","title":"Estudio de caso ECH: De STATA a R (ES)","text":"La variable POBPCOAC (Población por condición de actividad) es la clasificación central del estado laboral en la ECH. Códigos del INE: 1 = Menor de 14 2 = Ocupado 3-5 = Desocupado (diversas subcategorías) 6-10 = Inactivo 11 = aplica Esto replica el marco estándar de fuerza laboral de la OIT:","code":"svy <- step_recode(svy, labor_status,   POBPCOAC == 2 ~ \"Employed\",   POBPCOAC %in% 3:5 ~ \"Unemployed\",   POBPCOAC %in% 6:10 ~ \"Inactive\",   .default = NA_character_,   comment = \"ILO labor force status from POBPCOAC\" )  # Create binary indicators svy <- step_compute(svy,   employed = ifelse(POBPCOAC == 2, 1L, 0L),   unemployed = ifelse(POBPCOAC %in% 3:5, 1L, 0L),   active = ifelse(POBPCOAC %in% 2:5, 1L, 0L),   working_age = ifelse(e27 >= 14, 1L, 0L),   comment = \"Labor force binary indicators\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"paso-3-variables-de-ingreso","dir":"Articles","previous_headings":"","what":"Paso 3: Variables de ingreso","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Construir indicadores de ingreso siguiendo la metodología estándar utilizada con datos de la ECH:","code":"svy <- step_compute(svy,   income_pc = HT11 / nper,   income_thousands = HT11 / 1000,   log_income = log(HT11 + 1),   comment = \"Income transformations\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"paso-4-clasificación-geográfica","dir":"Articles","previous_headings":"","what":"Paso 4: Clasificación geográfica","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Los microdatos reales de la ECH ya incluyen nom_dpto (nombre del departamento) y region (1-3). Demostramos un join con lineas de pobreza por region:","code":"poverty_lines <- data.table(   region = 1:3,   poverty_line = c(19000, 12500, 11000),   region_name = c(\"Montevideo\", \"Interior loc. >= 5000\", \"Interior loc. < 5000\") )  svy <- step_join(svy,   poverty_lines,   by = \"region\",   type = \"left\",   comment = \"Add poverty lines by region\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"construcción-del-recipe","dir":"Articles","previous_headings":"","what":"Construcción del recipe","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Convertir todas las transformaciones en un recipe portable:","code":"ech_recipe <- steps_to_recipe(   name = \"ECH Labor Market Indicators\",   user = \"Research Team\",   svy = svy,   description = paste(     \"Standard labor market indicators for the ECH.\",     \"Includes demographic recoding, ILO labor classification,\",     \"income transformations, and geographic joins.\"   ),   steps = get_steps(svy),   topic = \"labor\" )  ech_recipe #>  #> ── Recipe: ECH Labor Market Indicators ── #> Author:  Research Team #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:   labor #> Description: Standard labor market indicators for the ECH. Includes demographic recoding, ILO labor classification, income transformations, and geographic joins. #> Certification: community #>  #> ── Requires (6 variables) ── #>   e26, e27, POBPCOAC, HT11, nper, region #>  #> ── Pipeline (6 steps) ── #>   1. [recode] -> sex  \"Sex: 1=Male, 2=Female (INE e26)\" #>   2. [recode] -> age_group  \"Standard age groups for labor statistics\" #>   3. [recode] -> labor_status  \"ILO labor force status from POBPCOAC\" #>   4. [compute] -> employed, unemployed, active, working_age  \"Labor force binary indicators\" #>   5. [compute] -> income_pc, income_thousands, log_income  \"Income transformations\" #>   6. [step_join] -> (no output)  \"Add poverty lines by region\" #>  #> ── Produces (10 variables) ── #>   sex [categorical], age_group [categorical], labor_status [categorical], employed [numeric], unemployed [numeric], active [numeric], working_age [numeric], income_pc [numeric], income_thousands [numeric], log_income [numeric]"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"documentación-automática","dir":"Articles","previous_headings":"Construcción del recipe","what":"Documentación automática","title":"Estudio de caso ECH: De STATA a R (ES)","text":"","code":"doc <- ech_recipe$doc()  # What variables does the recipe need? doc$input_variables #> [1] \"e26\"      \"e27\"      \"POBPCOAC\" \"HT11\"     \"nper\"     \"region\"  # What variables does it create? doc$output_variables #>  [1] \"sex\"              \"age_group\"        \"labor_status\"     \"employed\"         #>  [5] \"unemployed\"       \"active\"           \"working_age\"      \"income_pc\"        #>  [9] \"income_thousands\" \"log_income\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"publicación-en-el-registry","dir":"Articles","previous_headings":"Construcción del recipe","what":"Publicación en el registry","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Publicar el recipe para que otras personas puedan descubrirlo y reutilizarlo:","code":"# Set up a local registry set_backend(\"local\", path = tempfile(fileext = \".json\")) publish_recipe(ech_recipe)  # Ahora cualquiera puede recuperarla por ID r <- get_recipe(\"ech_labor\") print(r) #> NULL"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"estimación-con-workflow","dir":"Articles","previous_headings":"","what":"Estimación con workflow()","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Ahora calculamos indicadores estándar del mercado laboral:","code":"# Mean household income result_income <- workflow(   list(svy),   survey::svymean(~HT11, na.rm = TRUE),   estimation_type = \"annual\" )  result_income #>                     stat    value       se         cv confint_lower #>                   <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: HT11 107869.1 3473.836 0.03220417      101060.5 #>    confint_upper #>            <num> #> 1:      114677.7 # Employment rate (proportion employed among total population) result_employment <- workflow(   list(svy),   survey::svymean(~employed, na.rm = TRUE),   estimation_type = \"annual\" )  result_employment #>                         stat     value         se         cv confint_lower #>                       <char>     <num>      <num>      <num>         <num> #> 1: survey::svymean: employed 0.4422188 0.02343197 0.05298728      0.396293 #>    confint_upper #>            <num> #> 1:     0.4881447"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"estimación-por-dominio","dir":"Articles","previous_headings":"Estimación con workflow()","what":"Estimación por dominio","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Calcular estimaciones por subpoblación:","code":"# Mean income by region name income_region <- workflow(   list(svy),   survey::svyby(~HT11, ~region_name, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  income_region #>                                                       stat     value       se #>                                                     <char>     <num>    <num> #> 1:  survey::svyby: HT11 [region_name=Interior loc. < 5000]  90397.57 4632.957 #> 2: survey::svyby: HT11 [region_name=Interior loc. >= 5000] 103877.64 5949.558 #> 3:            survey::svyby: HT11 [region_name=Montevideo] 118302.36 5412.484 #>            cv confint_lower confint_upper           region_name #>         <num>         <num>         <num>                <char> #> 1: 0.05125091      81317.14       99478.0  Interior loc. < 5000 #> 2: 0.05727467      92216.72      115538.6 Interior loc. >= 5000 #> 3: 0.04575127     107694.09      128910.6            Montevideo # Employment by sex employment_sex <- workflow(   list(svy),   survey::svyby(~employed, ~sex, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  employment_sex #>                                    stat     value         se         cv #>                                  <char>     <num>      <num>      <num> #> 1: survey::svyby: employed [sex=Female] 0.3824018 0.03146234 0.08227562 #> 2:   survey::svyby: employed [sex=Male] 0.5076963 0.03449008 0.06793446 #>    confint_lower confint_upper    sex #>            <num>         <num> <char> #> 1:     0.3207367     0.4440669 Female #> 2:     0.4400970     0.5752956   Male"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"evaluación-de-calidad","dir":"Articles","previous_headings":"Estimación con workflow()","what":"Evaluación de calidad","title":"Estudio de caso ECH: De STATA a R (ES)","text":"","code":"results_all <- workflow(   list(svy),   survey::svymean(~HT11, na.rm = TRUE),   survey::svymean(~employed, na.rm = TRUE),   estimation_type = \"annual\" )  for (i in seq_len(nrow(results_all))) {   cv_pct <- results_all$cv[i] * 100   cat(     results_all$stat[i], \":\",     round(cv_pct, 1), \"% CV -\",     evaluate_cv(cv_pct), \"\\n\"   ) } #> survey::svymean: HT11 : 3.2 % CV - Excellent  #> survey::svymean: employed : 5.3 % CV - Very good"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"reproducibilidad-mismo-recipe-distinta-edición","dir":"Articles","previous_headings":"","what":"Reproducibilidad: mismo recipe, distinta edición","title":"Estudio de caso ECH: De STATA a R (ES)","text":"El poder de los recipes radica en aplicarlos sin modificaciones datos nuevos. En un flujo de trabajo real, se cargarían los datos de otra edicion y se aplicaría el mismo recipe: Mismo recipe, datos diferentes, metodología consistente.","code":"# Cargar microdatos de la ECH 2024 (cuando esten disponibles) svy_2024 <- load_survey(   path = \"ECH_2024.csv\",   type = \"ech\", edition = \"2024\",   weight = add_weight(annual = \"W_ANO\") )  # Aplicar el mismo recipe svy_2024 <- add_recipe(svy_2024, ech_recipe) svy_2024 <- bake_recipes(svy_2024)  # Estimar con metodología consistente result_2024 <- workflow(   list(svy_2024),   survey::svymean(~HT11, na.rm = TRUE),   survey::svymean(~employed, na.rm = TRUE),   estimation_type = \"annual\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"para-usuarios-de-stata-referencia-rápida","dir":"Articles","previous_headings":"","what":"Para usuarios de STATA: referencia rápida","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Si estás haciendo la transición de STATA R para análisis de encuestas, aquí hay un mapeo de operaciones comunes:","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"diferencias-clave","dir":"Articles","previous_headings":"Para usuarios de STATA: referencia rápida","what":"Diferencias clave","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Evaluación lazy: En STATA, los comandos se ejecutan inmediatamente. En metasurvey, los steps se registran y se ejecutan juntos con bake_steps(). Esto permite validación y optimización antes de la ejecución. Inmutabilidad: metasurvey crea nuevas variables en lugar de modificar las existentes. step_recode() crea una nueva columna; sobreescribe la variable fuente. Conciencia del diseño: Los pesos muestrales y el diseño están asociados al objeto Survey. es necesario prefijar comandos con svy: ni recordar configurar el diseño —workflow() lo maneja automáticamente. Recipes vs archivos .: Los recipes son auto-documentados (vía doc()), auto-validados (vía validate()), y descubribles (vía el registry). Un archivo .es simplemente un script; un recipe es un objeto estructurado y portable.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"datos-y-agradecimientos","dir":"Articles","previous_headings":"","what":"Datos y agradecimientos","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Los datos de ejemplo utilizados en esta vinieta provienen de la Encuesta Continua de Hogares (ECH) 2023, publicada por el Instituto Nacional de Estadistica (INE) de Uruguay. Los microdatos completos estan disponibles en INE. El paquete ech de Gabriela Mathieu y Richard Detomasi fue una inspiracion importante para metasurvey. Mientras que ech provee funciones listas para usar para calcular indicadores de la ECH, metasurvey toma un enfoque diferente: permite los usuarios definir, compartir y reproducir sus propios pipelines de procesamiento como recipes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study-es.html","id":"próximos-pasos","dir":"Articles","previous_headings":"","what":"Próximos pasos","title":"Estudio de caso ECH: De STATA a R (ES)","text":"Creación y publicación de recipes – Aprende sobre registries de recipes, certificación y descubrimiento Flujos de estimación – Profundización en workflow() y RecipeWorkflow Paneles rotativos y PoolSurvey – Trabajar con la estructura de panel rotativo de la ECH Primeros pasos – Revisar los conceptos básicos","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"the-ech-harmonization-problem","dir":"Articles","previous_headings":"","what":"The ECH harmonization problem","title":"ECH Case Study: From STATA to R","text":"Uruguay’s Encuesta Continua de Hogares (ECH) published annually Instituto Nacional de Estadistica (INE). years, INE changed variable names, codebook definitions, module structure across editions. Researchers working ECH data must harmonize variables —, map different naming conventions common schema— cross-year analysis possible. ECH harmonization historically carried Instituto de Economia (IECON) Universidad de la Republica. resulting dataset DOI: http://doi.org/10.47426/ECH.INE (Instituto de Economia, 2020). metasurvey aims complement facilitate kind work providing reproducible tools R. Uruguayan academia, work done STATA 30 years. typical harmonization pipeline consists approximately 8 .files per year, covering: 2_correc_datos.– Raw data loading, merging person household files, variable name corrections 3_compatibilizacion_mod_1_4.– Harmonization demographic, health, education, labor modules 4_ingreso_ht11.– Household income construction (ht11) 5_descomp_fuentes.– Income decomposition source 6_ingreso_ht11_sss.– Social security adjustments 7_check_ingr.– Income variable validation 8_arregla_base_comp.– Final dataset preparation 9_labels.– Value label application Multiplied 30+ years, means 240 STATA scripts essentially task: mapping raw ECH variables common schema. metasurvey solves recipes. Instead maintaining hundreds .files, write single recipe encodes transformation logic can applied ECH edition.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"stata-vs-metasurvey-side-by-side-comparison","dir":"Articles","previous_headings":"","what":"STATA vs metasurvey: Side-by-side comparison","title":"ECH Case Study: From STATA to R","text":"snippet typical STATA harmonization script sex, age, relationship head household: metasurvey equivalent: Key differences:","code":"* STATA: Typical ECH compatibility script  * sexo g bc_pe2 = e26  * edad g bc_pe3 = e27  * parentesco (e30 in ECH 2023, was e31 in earlier editions) g bc_pe4 = -9   replace bc_pe4 = 1 if e30 == 1   replace bc_pe4 = 2 if e30 == 2   replace bc_pe4 = 3 if e30 == 3 | e30 == 4 | e30 == 5   replace bc_pe4 = 4 if e30 == 7 | e30 == 8   replace bc_pe4 = 5 if e30 == 6 | e30 == 9 | e30 == 10 | e30 == 11 | e30 == 12   replace bc_pe4 = 6 if e30 == 13   replace bc_pe4 = 7 if e30 == 14 svy <- step_rename(svy, sex = e26, age = e27)  svy <- step_recode(svy, relationship,   e30 == 1                ~ \"Head\",   e30 == 2                ~ \"Spouse\",   e30 %in% 3:5            ~ \"Child\",   e30 %in% c(7, 8)        ~ \"Parent\",   e30 %in% c(6, 9:12)     ~ \"Other relative\",   e30 == 13               ~ \"Domestic service\",   e30 == 14               ~ \"Non-relative\",   .default = NA_character_,   comment = \"Relationship to head of household\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"loading-real-ech-microdata","dir":"Articles","previous_headings":"","what":"Loading real ECH microdata","title":"ECH Case Study: From STATA to R","text":"use sample real microdata ECH 2023, published INE. sample contains 200 households (~500 persons) key variables needed labor market analysis.","code":"library(metasurvey) library(data.table)  # Load real ECH 2023 sample dt <- fread(system.file(\"extdata\", \"ech_2023_sample.csv\", package = \"metasurvey\"))  svy <- Survey$new(   data    = dt,   edition = \"2023\",   type    = \"ech\",   engine  = \"data.table\",   weight  = add_weight(annual = \"W_ANO\") )  head(get_data(svy), 3) #>       ID  nper  anio   mes region  dpto   nom_dpto   e26   e27   e30 e51_2 #>    <int> <int> <int> <int>  <int> <int>     <char> <int> <int> <int> <int> #> 1: 34561     1  2023     1      1     1 Montevideo     2    26     1     6 #> 2: 34561     2  2023     1      1     1 Montevideo     2    45     7     6 #> 3: 34561     3  2023     1      1     1 Montevideo     2     7     4     1 #>    POBPCOAC SUBEMPLEO    HT11 pobre06 W_ANO #>       <int>     <int>   <num>   <int> <int> #> 1:        2         0 55429.6       0    57 #> 2:        4         0 55429.6       0    57 #> 3:        1         0 55429.6       0    57"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"step-1-demographic-variables","dir":"Articles","previous_headings":"","what":"Step 1: Demographic variables","title":"ECH Case Study: From STATA to R","text":"Recode raw INE codes readable names recode categorical variables:","code":"# Recode sex from INE codes (e26: 1=Male, 2=Female) svy <- step_recode(svy, sex,   e26 == 1 ~ \"Male\",   e26 == 2 ~ \"Female\",   .default = NA_character_,   comment = \"Sex: 1=Male, 2=Female (INE e26)\" )  # Recode age groups (standard ECH grouping, e27 = age) svy <- step_recode(svy, age_group,   e27 < 14 ~ \"Child (0-13)\",   e27 < 25 ~ \"Youth (14-24)\",   e27 < 45 ~ \"Adult (25-44)\",   e27 < 65 ~ \"Mature (45-64)\",   .default = \"Senior (65+)\",   .to_factor = TRUE,   ordered = TRUE,   comment = \"Standard age groups for labor statistics\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"step-2-labor-force-classification","dir":"Articles","previous_headings":"","what":"Step 2: Labor force classification","title":"ECH Case Study: From STATA to R","text":"POBPCOAC variable (Population activity status) central labor status classification ECH. INE codes: 1 = 14 2 = Employed 3-5 = Unemployed (various subcategories) 6-10 = Inactive 11 = applicable replicates standard ILO labor force framework:","code":"svy <- step_recode(svy, labor_status,   POBPCOAC == 2 ~ \"Employed\",   POBPCOAC %in% 3:5 ~ \"Unemployed\",   POBPCOAC %in% 6:10 ~ \"Inactive\",   .default = NA_character_,   comment = \"ILO labor force status from POBPCOAC\" )  # Create binary indicators svy <- step_compute(svy,   employed = ifelse(POBPCOAC == 2, 1L, 0L),   unemployed = ifelse(POBPCOAC %in% 3:5, 1L, 0L),   active = ifelse(POBPCOAC %in% 2:5, 1L, 0L),   working_age = ifelse(e27 >= 14, 1L, 0L),   comment = \"Labor force binary indicators\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"step-3-income-variables","dir":"Articles","previous_headings":"","what":"Step 3: Income variables","title":"ECH Case Study: From STATA to R","text":"Build income indicators following standard methodology used ECH data:","code":"svy <- step_compute(svy,   income_pc = HT11 / nper,   income_thousands = HT11 / 1000,   log_income = log(HT11 + 1),   comment = \"Income transformations\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"step-4-geographic-classification","dir":"Articles","previous_headings":"","what":"Step 4: Geographic classification","title":"ECH Case Study: From STATA to R","text":"real ECH microdata already includes nom_dpto (department name) region (1-3). demonstrate join poverty lines region:","code":"poverty_lines <- data.table(   region = 1:3,   poverty_line = c(19000, 12500, 11000),   region_name = c(\"Montevideo\", \"Interior loc. >= 5000\", \"Interior loc. < 5000\") )  svy <- step_join(svy,   poverty_lines,   by = \"region\",   type = \"left\",   comment = \"Add poverty lines by region\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"building-the-recipe","dir":"Articles","previous_headings":"","what":"Building the recipe","title":"ECH Case Study: From STATA to R","text":"Convert transformations portable recipe:","code":"ech_recipe <- steps_to_recipe(   name = \"ECH Labor Market Indicators\",   user = \"Research Team\",   svy = svy,   description = paste(     \"Standard labor market indicators for the ECH.\",     \"Includes demographic recoding, ILO labor classification,\",     \"income transformations, and geographic joins.\"   ),   steps = get_steps(svy),   topic = \"labor\" )  ech_recipe #>  #> ── Recipe: ECH Labor Market Indicators ── #> Author:  Research Team #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:   labor #> Description: Standard labor market indicators for the ECH. Includes demographic recoding, ILO labor classification, income transformations, and geographic joins. #> Certification: community #>  #> ── Requires (6 variables) ── #>   e26, e27, POBPCOAC, HT11, nper, region #>  #> ── Pipeline (6 steps) ── #>   1. [recode] -> sex  \"Sex: 1=Male, 2=Female (INE e26)\" #>   2. [recode] -> age_group  \"Standard age groups for labor statistics\" #>   3. [recode] -> labor_status  \"ILO labor force status from POBPCOAC\" #>   4. [compute] -> employed, unemployed, active, working_age  \"Labor force binary indicators\" #>   5. [compute] -> income_pc, income_thousands, log_income  \"Income transformations\" #>   6. [step_join] -> (no output)  \"Add poverty lines by region\" #>  #> ── Produces (10 variables) ── #>   sex [categorical], age_group [categorical], labor_status [categorical], employed [numeric], unemployed [numeric], active [numeric], working_age [numeric], income_pc [numeric], income_thousands [numeric], log_income [numeric]"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"automatic-documentation","dir":"Articles","previous_headings":"Building the recipe","what":"Automatic documentation","title":"ECH Case Study: From STATA to R","text":"","code":"doc <- ech_recipe$doc()  # What variables does the recipe need? doc$input_variables #> [1] \"e26\"      \"e27\"      \"POBPCOAC\" \"HT11\"     \"nper\"     \"region\"  # What variables does it create? doc$output_variables #>  [1] \"sex\"              \"age_group\"        \"labor_status\"     \"employed\"         #>  [5] \"unemployed\"       \"active\"           \"working_age\"      \"income_pc\"        #>  [9] \"income_thousands\" \"log_income\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"publishing-to-the-registry","dir":"Articles","previous_headings":"Building the recipe","what":"Publishing to the registry","title":"ECH Case Study: From STATA to R","text":"Publish recipe others can discover reuse :","code":"# Set up a local registry set_backend(\"local\", path = tempfile(fileext = \".json\")) publish_recipe(ech_recipe)  # Now anyone can retrieve it by ID r <- get_recipe(\"ech_labor\") print(r) #> NULL"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"estimation-with-workflow","dir":"Articles","previous_headings":"","what":"Estimation with workflow()","title":"ECH Case Study: From STATA to R","text":"Now compute standard labor market indicators:","code":"# Mean household income result_income <- workflow(   list(svy),   survey::svymean(~HT11, na.rm = TRUE),   estimation_type = \"annual\" )  result_income #>                     stat    value       se         cv confint_lower #>                   <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: HT11 107869.1 3473.836 0.03220417      101060.5 #>    confint_upper #>            <num> #> 1:      114677.7 # Employment rate (proportion employed among total population) result_employment <- workflow(   list(svy),   survey::svymean(~employed, na.rm = TRUE),   estimation_type = \"annual\" )  result_employment #>                         stat     value         se         cv confint_lower #>                       <char>     <num>      <num>      <num>         <num> #> 1: survey::svymean: employed 0.4422188 0.02343197 0.05298728      0.396293 #>    confint_upper #>            <num> #> 1:     0.4881447"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"domain-estimation","dir":"Articles","previous_headings":"Estimation with workflow()","what":"Domain estimation","title":"ECH Case Study: From STATA to R","text":"Compute estimates subpopulation:","code":"# Mean income by region name income_region <- workflow(   list(svy),   survey::svyby(~HT11, ~region_name, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  income_region #>                                                       stat     value       se #>                                                     <char>     <num>    <num> #> 1:  survey::svyby: HT11 [region_name=Interior loc. < 5000]  90397.57 4632.957 #> 2: survey::svyby: HT11 [region_name=Interior loc. >= 5000] 103877.64 5949.558 #> 3:            survey::svyby: HT11 [region_name=Montevideo] 118302.36 5412.484 #>            cv confint_lower confint_upper           region_name #>         <num>         <num>         <num>                <char> #> 1: 0.05125091      81317.14       99478.0  Interior loc. < 5000 #> 2: 0.05727467      92216.72      115538.6 Interior loc. >= 5000 #> 3: 0.04575127     107694.09      128910.6            Montevideo # Employment by sex employment_sex <- workflow(   list(svy),   survey::svyby(~employed, ~sex, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  employment_sex #>                                    stat     value         se         cv #>                                  <char>     <num>      <num>      <num> #> 1: survey::svyby: employed [sex=Female] 0.3824018 0.03146234 0.08227562 #> 2:   survey::svyby: employed [sex=Male] 0.5076963 0.03449008 0.06793446 #>    confint_lower confint_upper    sex #>            <num>         <num> <char> #> 1:     0.3207367     0.4440669 Female #> 2:     0.4400970     0.5752956   Male"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"quality-assessment","dir":"Articles","previous_headings":"Estimation with workflow()","what":"Quality assessment","title":"ECH Case Study: From STATA to R","text":"","code":"results_all <- workflow(   list(svy),   survey::svymean(~HT11, na.rm = TRUE),   survey::svymean(~employed, na.rm = TRUE),   estimation_type = \"annual\" )  for (i in seq_len(nrow(results_all))) {   cv_pct <- results_all$cv[i] * 100   cat(     results_all$stat[i], \":\",     round(cv_pct, 1), \"% CV -\",     evaluate_cv(cv_pct), \"\\n\"   ) } #> survey::svymean: HT11 : 3.2 % CV - Excellent  #> survey::svymean: employed : 5.3 % CV - Very good"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"reproducibility-same-recipe-different-edition","dir":"Articles","previous_headings":"","what":"Reproducibility: same recipe, different edition","title":"ECH Case Study: From STATA to R","text":"power recipes lies applying unchanged new data. real workflow, load different edition ECH apply recipe: recipe, different data, consistent methodology.","code":"# Load ECH 2024 microdata (requires external data file) svy_2024 <- load_survey(   path = \"ECH_2024.csv\",   type = \"ech\", edition = \"2024\",   weight = add_weight(annual = \"W_ANO\") )  # Apply the exact same recipe svy_2024 <- add_recipe(svy_2024, ech_recipe) svy_2024 <- bake_recipes(svy_2024)  # Estimate with consistent methodology result_2024 <- workflow(   list(svy_2024),   survey::svymean(~HT11, na.rm = TRUE),   survey::svymean(~employed, na.rm = TRUE),   estimation_type = \"annual\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"for-stata-users-quick-reference","dir":"Articles","previous_headings":"","what":"For STATA users: quick reference","title":"ECH Case Study: From STATA to R","text":"transitioning STATA R survey analysis, mapping common operations:","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"key-differences","dir":"Articles","previous_headings":"For STATA users: quick reference","what":"Key differences","title":"ECH Case Study: From STATA to R","text":"Lazy evaluation: STATA, commands execute immediately. metasurvey, steps recorded executed together bake_steps(). enables validation optimization execution. Immutability: metasurvey creates new variables instead modifying existing ones. step_recode() creates new column; overwrite source variable. Design awareness: Survey weights design attached Survey object. need prefix commands svy: remember set design —workflow() handles automatically. Recipes vs .files: Recipes self-documenting (via doc()), self-validating (via validate()), discoverable (via registry). .file just script; recipe structured, portable object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"data-and-acknowledgments","dir":"Articles","previous_headings":"","what":"Data and acknowledgments","title":"ECH Case Study: From STATA to R","text":"sample data used vignette comes Encuesta Continua de Hogares (ECH) 2023, published Uruguay’s Instituto Nacional de Estadistica (INE). full microdata available INE. ech package Gabriela Mathieu Richard Detomasi important inspiration metasurvey. ech provides ready--use functions computing ECH indicators, metasurvey takes different approach: lets users define, share, reproduce processing pipelines recipes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-case-study.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"ECH Case Study: From STATA to R","text":"Creating publishing recipes – Learn recipe registries, certification, discovery Estimation workflows – Deep dive workflow() RecipeWorkflow Rotating panels PoolSurvey – Working ECH’s rotating panel structure Getting started – Review basics","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"dos-caminos-transpilar-rapido-o-construir-bien","dir":"Articles","previous_headings":"","what":"Dos caminos: transpilar rapido o construir bien","title":"Construyendo una Receta de Demografia ECH (ES)","text":"metasurvey ofrece dos formas de crear recetas partir de codigo STATA existente: Transpilar automaticamente con transpile_stata() – convierte archivos .recetas en segundos. Ideal para migrar codigo legacy rapidamente (ver vignette(\"stata-transpiler-es\")). Construir desde cero en R – mas trabajo inicial, pero el resultado es mas limpio, usa modismos propios de R y se controla cada detalle. El transpilador es un atajo pragmatico: lee cientos de lineas de STATA y produce una receta funcional, pero la salida hereda la estructura del codigo original – largas cadenas gen/replace se convierten en largas llamadas step_recode, las variables temporales sobreviven, y patrones especificos de STATA (como mvencode) se traducen literalmente en lugar de repensarse. Una receta artesanal, en cambio, permite redisenar la logica en R desde cero. Se eligen nombres de variables significativos, se combinan transformaciones relacionadas en un solo step, y se omiten variables intermedias que solo existian porque STATA las necesitaba. El resultado es mas corto, mas legible y mas facil de mantener. Esta vignette construye una receta de demografia desde cero en unas 20 lineas de R. Una version transpilada del mismo pipeline tomaria 80+ steps y arrastraria nombres de variables como bc_pe2 y bc_pe3 que significan nada fuera del archivo .original.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"configurando-la-encuesta","dir":"Articles","previous_headings":"","what":"Configurando la encuesta","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Comenzamos con un objeto Survey vacio. Esto declara el tipo de encuesta y la edicion sin cargar datos todavia – la receta funcionara con cualquier dato que le proporcionemos despues. Ahora adjuntamos algunos datos de ejemplo. En produccion estos vendrian de anda_download_microdata(\"2023\") o un archivo local; aqui los simulamos.","code":"library(metasurvey)  svy <- survey_empty(type = \"ech\", edition = \"2023\") svy set.seed(42) n <- 200 dt <- data.table::data.table(   id       = rep(1:50, each = 4),   nper     = rep(1:4, 50),   pesoano  = runif(n, 50, 300),   e26      = sample(1:2, n, replace = TRUE),   e27      = sample(0:90, n, replace = TRUE),   e30      = sample(1:7, n, replace = TRUE),   e51_2    = sample(c(0:6, -9), n, replace = TRUE),   region_4 = sample(1:4, n, replace = TRUE) )  svy <- svy |> set_data(dt)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"construyendo-el-pipeline","dir":"Articles","previous_headings":"","what":"Construyendo el pipeline","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Cada transformacion es un step. Por defecto, los steps son lazy: registran que hacer sin ejecutarlo. Esto permite inspeccionar y modificar el pipeline antes de materializar los resultados. Comparar con el enfoque del transpilador: transpile_stata() produciria un step por cada comando STATA, preservando fielmente cada gen y replace. Aqui pensamos en terminos de las variables de salida que queremos, de los comandos que necesitamos escribir.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"renombrar-identificadores","dir":"Articles","previous_headings":"Construyendo el pipeline","what":"Renombrar identificadores","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Nada le paso los datos todavia: Los nombres de columna originales siguen ahi porque el step esta pendiente. Sigamos agregando steps.","code":"svy <- svy |>   step_rename(     hh_id = \"id\", person_id = \"nper\",     comment = \"Estandarizar identificadores\"   ) names(get_data(svy))[1:4] #> [1] \"id\"      \"nper\"    \"pesoano\" \"e26\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"recodificar-sexo","dir":"Articles","previous_headings":"Construyendo el pipeline","what":"Recodificar sexo","title":"Construyendo una Receta de Demografia ECH (ES)","text":"En STATA esto seria una secuencia gen + replace + replace (3 comandos). Con step_recode es un unico mapeo declarativo que produce etiquetas legibles:","code":"svy <- svy |>   step_recode(sex,     e26 == 1 ~ \"Hombre\",     e26 == 2 ~ \"Mujer\",     .default = NA_character_,     comment = \"Sexo desde e26\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"grupos-de-edad","dir":"Articles","previous_headings":"Construyendo el pipeline","what":"Grupos de edad","title":"Construyendo una Receta de Demografia ECH (ES)","text":"El equivalente en STATA usa cinco lineas replace con inrange(). Aqui escribimos la misma logica como un unico recode con condiciones legibles:","code":"svy <- svy |>   step_recode(age_group,     e27 >= 0 & e27 <= 13 ~ \"Ninio\",     e27 >= 14 & e27 <= 17 ~ \"Adolescente\",     e27 >= 18 & e27 <= 29 ~ \"Joven adulto\",     e27 >= 30 & e27 <= 64 ~ \"Adulto\",     e27 >= 65 ~ \"Adulto mayor\",     .default = NA_character_,     comment = \"Grupos de edad desde e27\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"relacion-con-el-jefe-de-hogar","dir":"Articles","previous_headings":"Construyendo el pipeline","what":"Relacion con el jefe de hogar","title":"Construyendo una Receta de Demografia ECH (ES)","text":"","code":"svy <- svy |>   step_recode(relationship,     e30 == 1 ~ \"Jefe\",     e30 == 2 ~ \"Conyuge\",     e30 >= 3 & e30 <= 5 ~ \"Hijo\",     e30 == 6 ~ \"Otro familiar\",     e30 == 7 ~ \"No familiar\",     .default = \"Desconocido\",     comment = \"Relacion desde e30\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"nivel-educativo","dir":"Articles","previous_headings":"Construyendo el pipeline","what":"Nivel educativo","title":"Construyendo una Receta de Demografia ECH (ES)","text":"","code":"svy <- svy |>   step_recode(edu_level,     e51_2 == 0 ~ \"Sin instruccion\",     e51_2 >= 1 & e51_2 <= 2 ~ \"Primaria\",     e51_2 >= 3 & e51_2 <= 4 ~ \"Secundaria\",     e51_2 >= 5 & e51_2 <= 6 ~ \"Terciaria\",     .default = NA_character_,     comment = \"Nivel educativo desde e51_2\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"area-geografica","dir":"Articles","previous_headings":"Construyendo el pipeline","what":"Area geografica","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Notar que todas nuestras variables de salida tienen etiquetas significativas en lugar de codigos numericos. Una receta transpilada mantendria los codigos enteros originales (1, 2, 3…) porque eso es lo que usaba el codigo STATA. Construir desde cero permite elegir la representacion que facilita el analisis.","code":"svy <- svy |>   step_recode(area,     region_4 == 1 ~ \"Montevideo\",     region_4 == 2 ~ \"Urbano >5k\",     region_4 == 3 ~ \"Urbano <5k\",     region_4 == 4 ~ \"Rural\",     .default = NA_character_,     comment = \"Area geografica desde region_4\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"remover-variables-crudas","dir":"Articles","previous_headings":"Construyendo el pipeline","what":"Remover variables crudas","title":"Construyendo una Receta de Demografia ECH (ES)","text":"","code":"svy <- svy |>   step_remove(e26, e27, e30, e51_2, region_4,     comment = \"Eliminar variables crudas de ECH\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"inspeccionando-el-pipeline-antes-de-ejecutar","dir":"Articles","previous_headings":"","what":"Inspeccionando el pipeline antes de ejecutar","title":"Construyendo una Receta de Demografia ECH (ES)","text":"En este punto tenemos siete steps pendientes. Veamos que se registro: Esta es una de las ventajas clave de construir desde cero: 7 steps que cada uno hace una cosa clara. Una version transpilada del modulo completo de demografia del IECON tiene 80+ steps porque preserva cada comando STATA intermedio. El pipeline es un DAG (grafo aciclico dirigido) de transformaciones. view_graph() lo renderiza como una red interactiva – cada nodo es un step, y las aristas muestran dependencias de variables: Con solo 7 nodos el grafo es limpio y navegable. Comparar con una receta transpilada donde el DAG puede tener 100+ nodos – aun util para auditoria, pero mucho mas dificil de leer de un vistazo. Para salida estatica podemos inspeccionar la lista de steps:","code":"length(get_steps(svy)) #> [1] 7 view_graph(svy) for (s in get_steps(svy)) {   cat(sprintf(\"[%s] %s\\n\", s$type, s$comment %||% \"\")) } #> [step_rename] Estandarizar identificadores #> [recode] Sexo desde e26 #> [recode] Grupos de edad desde e27 #> [recode] Relacion desde e30 #> [recode] Nivel educativo desde e51_2 #> [recode] Area geografica desde region_4 #> [step_remove] Eliminar variables crudas de ECH"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"empaquetando-como-receta-antes-de-bake","dir":"Articles","previous_headings":"","what":"Empaquetando como receta (antes de bake)","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Una receta empaqueta los steps con metadatos para que cualquiera pueda reproducir el mismo pipeline con datos diferentes. Creamos la receta antes de hacer bake – los steps lazy son el pipeline: La receta auto-genera documentacion partir de los steps:","code":"rec <- steps_to_recipe(   name = \"ECH Demografia (minima)\",   user = \"equipo_investigacion\",   svy = svy,   steps = get_steps(svy),   description = paste(     \"Demografia armonizada: sexo, grupo de edad, relacion,\",     \"nivel educativo y area geografica.\"   ),   topic = \"demographics\" )  rec #>  #> ── Recipe: ECH Demografia (minima) ── #> Author:  equipo_investigacion #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:   demographics #> Description: Demografia armonizada: sexo, grupo de edad, relacion, nivel educativo y area geografica. #> Certification: community #>  #> ── Requires (5 variables) ── #>   e26, e27, e30, e51_2, region_4 #>  #> ── Pipeline (7 steps) ── #>   1. [step_rename] -> mapping  \"Estandarizar identificadores\" #>   2. [recode] -> sex  \"Sexo desde e26\" #>   3. [recode] -> age_group  \"Grupos de edad desde e27\" #>   4. [recode] -> relationship  \"Relacion desde e30\" #>   5. [recode] -> edu_level  \"Nivel educativo desde e51_2\" #>   6. [recode] -> area  \"Area geografica desde region_4\" #>   7. [step_remove] -> (no output)  \"Eliminar variables crudas de ECH\" #>  #> ── Produces (6 variables) ── #>   sex [categorical], age_group [categorical], relationship [categorical], edu_level [categorical], area [categorical], mapping [inherited] doc <- rec$doc() cat(\"Variables de entrada: \", paste(doc$input_variables, collapse = \", \"), \"\\n\") #> Variables de entrada:  e26, e27, e30, e51_2, region_4 cat(\"Variables de salida:  \", paste(doc$output_variables, collapse = \", \"), \"\\n\") #> Variables de salida:   mapping, sex, age_group, relationship, edu_level, area cat(\"Steps del pipeline:   \", length(doc$pipeline), \"\\n\") #> Steps del pipeline:    7"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"bake-materializando-el-pipeline","dir":"Articles","previous_headings":"","what":"Bake: materializando el pipeline","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Ahora ejecutemos los steps. bake_steps() ejecuta todos los steps pendientes en orden y devuelve la encuesta transformada: Los datos tienen las nuevas columnas con etiquetas legibles: Las variables crudas ya estan:","code":"svy <- bake_steps(svy) head(get_data(svy)[, .(   hh_id, person_id, sex, age_group, relationship,   edu_level, area )]) #>    hh_id person_id    sex    age_group relationship       edu_level       area #>    <int>     <int> <char>       <char>       <char>          <char>     <char> #> 1:     1         1  Mujer Adulto mayor  No familiar Sin instruccion Urbano <5k #> 2:     1         2  Mujer       Adulto         Jefe        Primaria Montevideo #> 3:     1         3 Hombre Joven adulto      Conyuge       Terciaria Urbano <5k #> 4:     1         4  Mujer       Adulto         Hijo        Primaria      Rural #> 5:     2         1 Hombre Adulto mayor         Hijo Sin instruccion Urbano >5k #> 6:     2         2 Hombre Joven adulto      Conyuge       Terciaria      Rural \"e26\" %in% names(get_data(svy)) #> [1] FALSE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"guardar-y-cargar","dir":"Articles","previous_headings":"","what":"Guardar y cargar","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Las recetas se serializan JSON para control de versiones y compartir: El JSON es legible y diffeable en git:","code":"f <- tempfile(fileext = \".json\") save_recipe(rec, f) rec2 <- read_recipe(f) rec2$name #> [1] \"ECH Demografia (minima)\" length(rec2$steps) #> [1] 7 cat(readLines(f, n = 15), sep = \"\\n\") #> { #>   \"name\": \"ECH Demografia (minima)\", #>   \"user\": \"equipo_investigacion\", #>   \"survey_type\": \"ech\", #>   \"edition\": 2023, #>   \"description\": \"Demografia armonizada: sexo, grupo de edad, relacion, nivel educativo y area geografica.\", #>   \"topic\": \"demographics\", #>   \"doi\": {}, #>   \"id\": \"r_1771342367_663\", #>   \"version\": \"1.0.0\", #>   \"downloads\": 0, #>   \"categories\": [], #>   \"certification\": { #>     \"level\": \"community\", #>     \"certified_at\": \"2026-02-17 15:32:47.614267\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"aplicando-a-una-nueva-edicion","dir":"Articles","previous_headings":"","what":"Aplicando a una nueva edicion","title":"Construyendo una Receta de Demografia ECH (ES)","text":"La misma receta funciona con cualquier edicion. Cargar la receta desde JSON, adjuntarla nuevos datos y hacer bake: se necesitan cambios en el codigo. La receta codifica la logica, los datos.","code":"rec_loaded <- read_recipe(f)  svy_2024 <- survey_empty(type = \"ech\", edition = \"2024\") |>   set_data(data.table::data.table(     id       = rep(1:30, each = 3),     nper     = rep(1:3, 30),     pesoano  = runif(90, 50, 300),     e26      = sample(1:2, 90, replace = TRUE),     e27      = sample(0:90, 90, replace = TRUE),     e30      = sample(1:7, 90, replace = TRUE),     e51_2    = sample(c(0:6, -9), 90, replace = TRUE),     region_4 = sample(1:4, 90, replace = TRUE)   )) |>   add_recipe(rec_loaded) |>   bake_recipes()  head(get_data(svy_2024)[, .(hh_id, person_id, sex, age_group, area)]) #>    hh_id person_id    sex    age_group       area #>    <int>     <int> <char>       <char>     <char> #> 1:     1         1 Hombre Adulto mayor      Rural #> 2:     1         2 Hombre       Adulto Urbano <5k #> 3:     1         3  Mujer Joven adulto Urbano >5k #> 4:     2         1 Hombre       Adulto Montevideo #> 5:     2         2  Mujer Adulto mayor      Rural #> 6:     2         3 Hombre Adulto mayor Urbano <5k"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"transpilador-vs-artesanal-cuando-usar-cada-uno","dir":"Articles","previous_headings":"","what":"Transpilador vs artesanal: cuando usar cada uno","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Flujo de trabajo recomendado: usar transpile_stata() para migrar los archivos .existentes inmediatamente para tener un baseline funcional. Luego reemplazar gradualmente las recetas transpiladas con artesanales medida que se revisa cada modulo. La version transpilada mantiene todo funcionando; la version artesanal es donde se quiere llegar.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe-es.html","id":"proximos-pasos","dir":"Articles","previous_headings":"","what":"Proximos pasos","title":"Construyendo una Receta de Demografia ECH (ES)","text":"Agregar mas variables: ingresos, condicion de actividad, condiciones de vivienda – cada una puede ser una receta separada con depends_on_recipes Certificar la receta: usar certify_recipe() para marcarla como revisada u oficial Publicar: publish_recipe(rec) sube al registro compartido donde otros pueden encontrarla con search_recipes(topic = \"demographics\") Partir desde STATA: si ya se tienen archivos ., usar transpile_stata() para generar un baseline funcional inmediatamente – ver vignette(\"stata-transpiler-es\") – y luego refinar la salida en una receta artesanal como la de esta vignette","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"two-paths-transpile-fast-or-build-right","dir":"Articles","previous_headings":"","what":"Two paths: transpile fast or build right","title":"Building an ECH Demographics Recipe","text":"metasurvey offers two ways create recipes existing STATA code: Transpile automatically transpile_stata() – converts .files recipes seconds. Great migrating legacy code quickly (see vignette(\"stata-transpiler\")). Build scratch R – work upfront, result cleaner, uses proper R idioms, control every detail. transpiler pragmatic shortcut: reads hundreds lines STATA produces working recipe, output inherits original code’s structure – long gen/replace chains become long step_recode calls, temporary variables survive, STATA-specific patterns (like mvencode) get translated literally rather rethought. hand-crafted recipe, hand, lets redesign logic R ground . pick meaningful variable names, combine related transformations single step, skip intermediate variables existed STATA needed . result shorter, easier read, easier maintain. vignette builds demographics recipe scratch 20 lines R. transpiled version pipeline take 80+ steps carry variable names like bc_pe2 bc_pe3 mean nothing outside original .file.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"setting-up-the-survey","dir":"Articles","previous_headings":"","what":"Setting up the survey","title":"Building an ECH Demographics Recipe","text":"start empty Survey object. declares survey type edition without loading data yet – recipe work whatever data feed later. Now let’s attach sample data. production come anda_download_microdata(\"2023\") local file; simulate .","code":"library(metasurvey)  svy <- survey_empty(type = \"ech\", edition = \"2023\") svy set.seed(42) n <- 200 dt <- data.table::data.table(   id       = rep(1:50, each = 4),   nper     = rep(1:4, 50),   pesoano  = runif(n, 50, 300),   e26      = sample(1:2, n, replace = TRUE),   e27      = sample(0:90, n, replace = TRUE),   e30      = sample(1:7, n, replace = TRUE),   e51_2    = sample(c(0:6, -9), n, replace = TRUE),   region_4 = sample(1:4, n, replace = TRUE) )  svy <- svy |> set_data(dt)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"building-the-pipeline","dir":"Articles","previous_headings":"","what":"Building the pipeline","title":"Building an ECH Demographics Recipe","text":"Every transformation step. default, steps lazy: record without executing . lets inspect modify pipeline materializing results. Compare transpiler approach: transpile_stata() produce one step per STATA command, faithfully preserving every gen replace. think terms output variables want, commands need type.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"rename-identifiers","dir":"Articles","previous_headings":"Building the pipeline","what":"Rename identifiers","title":"Building an ECH Demographics Recipe","text":"Nothing happened data yet: original column names still step pending. Let’s keep adding steps.","code":"svy <- svy |>   step_rename(     hh_id = \"id\", person_id = \"nper\",     comment = \"Standardize identifiers\"   ) names(get_data(svy))[1:4] #> [1] \"id\"      \"nper\"    \"pesoano\" \"e26\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"recode-sex","dir":"Articles","previous_headings":"Building the pipeline","what":"Recode sex","title":"Building an ECH Demographics Recipe","text":"STATA gen + replace + replace sequence (3 commands). step_recode ’s single, declarative mapping produces human-readable labels:","code":"svy <- svy |>   step_recode(sex,     e26 == 1 ~ \"Male\",     e26 == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sex from e26\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"age-groups","dir":"Articles","previous_headings":"Building the pipeline","what":"Age groups","title":"Building an ECH Demographics Recipe","text":"STATA equivalent uses five replace lines inrange(). write logic single recode readable conditions:","code":"svy <- svy |>   step_recode(age_group,     e27 >= 0 & e27 <= 13 ~ \"Child\",     e27 >= 14 & e27 <= 17 ~ \"Adolescent\",     e27 >= 18 & e27 <= 29 ~ \"Young adult\",     e27 >= 30 & e27 <= 64 ~ \"Adult\",     e27 >= 65 ~ \"Elderly\",     .default = NA_character_,     comment = \"Age groups from e27\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"relationship-to-head-of-household","dir":"Articles","previous_headings":"Building the pipeline","what":"Relationship to head of household","title":"Building an ECH Demographics Recipe","text":"","code":"svy <- svy |>   step_recode(relationship,     e30 == 1 ~ \"Head\",     e30 == 2 ~ \"Spouse\",     e30 >= 3 & e30 <= 5 ~ \"Child\",     e30 == 6 ~ \"Other relative\",     e30 == 7 ~ \"Non-relative\",     .default = \"Unknown\",     comment = \"Relationship from e30\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"education-level","dir":"Articles","previous_headings":"Building the pipeline","what":"Education level","title":"Building an ECH Demographics Recipe","text":"","code":"svy <- svy |>   step_recode(edu_level,     e51_2 == 0 ~ \"None\",     e51_2 >= 1 & e51_2 <= 2 ~ \"Primary\",     e51_2 >= 3 & e51_2 <= 4 ~ \"Secondary\",     e51_2 >= 5 & e51_2 <= 6 ~ \"Tertiary\",     .default = NA_character_,     comment = \"Education level from e51_2\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"geographic-area","dir":"Articles","previous_headings":"Building the pipeline","what":"Geographic area","title":"Building an ECH Demographics Recipe","text":"Notice output variables meaningful labels instead numeric codes. transpiled recipe keep original integer codes (1, 2, 3…) ’s STATA code used. Building scratch lets choose representation makes analysis easier.","code":"svy <- svy |>   step_recode(area,     region_4 == 1 ~ \"Montevideo\",     region_4 == 2 ~ \"Urban >5k\",     region_4 == 3 ~ \"Urban <5k\",     region_4 == 4 ~ \"Rural\",     .default = NA_character_,     comment = \"Geographic area from region_4\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"remove-raw-variables","dir":"Articles","previous_headings":"Building the pipeline","what":"Remove raw variables","title":"Building an ECH Demographics Recipe","text":"","code":"svy <- svy |>   step_remove(e26, e27, e30, e51_2, region_4,     comment = \"Drop raw ECH variables\"   )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"inspecting-the-pipeline-before-execution","dir":"Articles","previous_headings":"","what":"Inspecting the pipeline before execution","title":"Building an ECH Demographics Recipe","text":"point seven pending steps. Let’s see recorded: one key advantages building scratch: 7 steps one clear thing. transpiled version full IECON demographics module 80+ steps preserves every intermediate STATA command. pipeline DAG (directed acyclic graph) transformations. view_graph() renders interactive network – node step, edges show variable dependencies: interactive DAG rendered vignette keep package size small. Run view_graph() R session explore . 7 nodes graph clean navigable. Compare transpiled recipe DAG can 100+ nodes – still useful auditing, much harder read glance. static output can inspect step list:","code":"length(get_steps(svy)) #> [1] 7 view_graph(svy) for (s in get_steps(svy)) {   cat(sprintf(\"[%s] %s\\n\", s$type, s$comment %||% \"\")) } #> [step_rename] Standardize identifiers #> [recode] Sex from e26 #> [recode] Age groups from e27 #> [recode] Relationship from e30 #> [recode] Education level from e51_2 #> [recode] Geographic area from region_4 #> [step_remove] Drop raw ECH variables"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"packaging-as-a-recipe-before-baking","dir":"Articles","previous_headings":"","what":"Packaging as a recipe (before baking)","title":"Building an ECH Demographics Recipe","text":"recipe bundles steps metadata anyone can reproduce pipeline different data. create recipe baking – lazy steps pipeline: recipe auto-generates documentation steps:","code":"rec <- steps_to_recipe(   name = \"ECH Demographics (minimal)\",   user = \"research_team\",   svy = svy,   steps = get_steps(svy),   description = paste(     \"Harmonized demographics: sex, age group, relationship,\",     \"education level, and geographic area.\"   ),   topic = \"demographics\" )  rec #>  #> ── Recipe: ECH Demographics (minimal) ── #> Author:  research_team #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:   demographics #> Description: Harmonized demographics: sex, age group, relationship, education level, and geographic area. #> Certification: community #>  #> ── Requires (5 variables) ── #>   e26, e27, e30, e51_2, region_4 #>  #> ── Pipeline (7 steps) ── #>   1. [step_rename] -> mapping  \"Standardize identifiers\" #>   2. [recode] -> sex  \"Sex from e26\" #>   3. [recode] -> age_group  \"Age groups from e27\" #>   4. [recode] -> relationship  \"Relationship from e30\" #>   5. [recode] -> edu_level  \"Education level from e51_2\" #>   6. [recode] -> area  \"Geographic area from region_4\" #>   7. [step_remove] -> (no output)  \"Drop raw ECH variables\" #>  #> ── Produces (6 variables) ── #>   sex [categorical], age_group [categorical], relationship [categorical], edu_level [categorical], area [categorical], mapping [inherited] doc <- rec$doc() cat(\"Input variables: \", paste(doc$input_variables, collapse = \", \"), \"\\n\") #> Input variables:  e26, e27, e30, e51_2, region_4 cat(\"Output variables:\", paste(doc$output_variables, collapse = \", \"), \"\\n\") #> Output variables: mapping, sex, age_group, relationship, edu_level, area cat(\"Pipeline steps:  \", length(doc$pipeline), \"\\n\") #> Pipeline steps:   7"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"baking-materializing-the-pipeline","dir":"Articles","previous_headings":"","what":"Baking: materializing the pipeline","title":"Building an ECH Demographics Recipe","text":"Now let’s execute steps. bake_steps() runs pending steps order returns transformed survey: data new columns readable labels: raw variables gone:","code":"svy <- bake_steps(svy) head(get_data(svy)[, .(   hh_id, person_id, sex, age_group, relationship,   edu_level, area )]) #>    hh_id person_id    sex   age_group relationship edu_level       area #>    <int>     <int> <char>      <char>       <char>    <char>     <char> #> 1:     1         1 Female     Elderly Non-relative      None  Urban <5k #> 2:     1         2 Female       Adult         Head   Primary Montevideo #> 3:     1         3   Male Young adult       Spouse  Tertiary  Urban <5k #> 4:     1         4 Female       Adult        Child   Primary      Rural #> 5:     2         1   Male     Elderly        Child      None  Urban >5k #> 6:     2         2   Male Young adult       Spouse  Tertiary      Rural \"e26\" %in% names(get_data(svy)) #> [1] FALSE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"saving-and-loading","dir":"Articles","previous_headings":"","what":"Saving and loading","title":"Building an ECH Demographics Recipe","text":"Recipes serialize JSON version control sharing: JSON human-readable diffable git:","code":"f <- tempfile(fileext = \".json\") save_recipe(rec, f) rec2 <- read_recipe(f) rec2$name #> [1] \"ECH Demographics (minimal)\" length(rec2$steps) #> [1] 7 cat(readLines(f, n = 15), sep = \"\\n\") #> { #>   \"name\": \"ECH Demographics (minimal)\", #>   \"user\": \"research_team\", #>   \"survey_type\": \"ech\", #>   \"edition\": 2023, #>   \"description\": \"Harmonized demographics: sex, age group, relationship, education level, and geographic area.\", #>   \"topic\": \"demographics\", #>   \"doi\": {}, #>   \"id\": \"r_1771342372_663\", #>   \"version\": \"1.0.0\", #>   \"downloads\": 0, #>   \"categories\": [], #>   \"certification\": { #>     \"level\": \"community\", #>     \"certified_at\": \"2026-02-17 15:32:52.08603\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"applying-to-a-new-edition","dir":"Articles","previous_headings":"","what":"Applying to a new edition","title":"Building an ECH Demographics Recipe","text":"recipe works edition. Load recipe JSON, attach new data, bake: code changes needed. recipe encodes logic, data.","code":"rec_loaded <- read_recipe(f)  svy_2024 <- survey_empty(type = \"ech\", edition = \"2024\") |>   set_data(data.table::data.table(     id       = rep(1:30, each = 3),     nper     = rep(1:3, 30),     pesoano  = runif(90, 50, 300),     e26      = sample(1:2, 90, replace = TRUE),     e27      = sample(0:90, 90, replace = TRUE),     e30      = sample(1:7, 90, replace = TRUE),     e51_2    = sample(c(0:6, -9), 90, replace = TRUE),     region_4 = sample(1:4, 90, replace = TRUE)   )) |>   add_recipe(rec_loaded) |>   bake_recipes()  head(get_data(svy_2024)[, .(hh_id, person_id, sex, age_group, area)]) #>    hh_id person_id    sex   age_group       area #>    <int>     <int> <char>      <char>     <char> #> 1:     1         1   Male     Elderly      Rural #> 2:     1         2   Male       Adult  Urban <5k #> 3:     1         3 Female Young adult  Urban >5k #> 4:     2         1   Male       Adult Montevideo #> 5:     2         2 Female     Elderly      Rural #> 6:     2         3   Male     Elderly  Urban <5k"},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"transpiler-vs-hand-crafted-when-to-use-each","dir":"Articles","previous_headings":"","what":"Transpiler vs hand-crafted: when to use each","title":"Building an ECH Demographics Recipe","text":"Recommended workflow: use transpile_stata() migrate existing .files immediately working baseline. gradually replace transpiled recipes hand-crafted ones review module. transpiled version keeps running; hand-crafted version want end .","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/ech-demographics-recipe.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Building an ECH Demographics Recipe","text":"Add variables: income, labor force status, housing conditions – can separate recipe depends_on_recipes Certify recipe: use certify_recipe() mark reviewed official Publish: publish_recipe(rec) uploads shared registry others can find search_recipes(topic = \"demographics\") Start STATA: already .files, use transpile_stata() generate working baseline immediately – see vignette(\"stata-transpiler\") – refine output hand-crafted recipe like one vignette","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"introduccion","dir":"Articles","previous_headings":"","what":"Introduccion","title":"Primeros pasos con metasurvey (ES)","text":"Trabajar con microdatos de encuestas de hogares implica una gran cantidad de procesamiento repetitivo: recodificar variables categoricas, construir indicadores, unir datos externos y calcular estimaciones ponderadas. Cada investigador escribe su propia version de estas transformaciones, y el codigo rara vez se comparte o documenta de forma que otros puedan reutilizarlo. metasurvey aborda este problema proporcionando una capa de metaprogramacion sobre el paquete survey (Lumley 2004). En lugar de escribir scripts ad hoc, se construye un pipeline de transformaciones que es: Documentado – cada paso lleva un comentario, sus variables de entrada/salida y sus dependencias Reproducible – el pipeline puede guardarse como una receta y aplicarse nuevos datos Compartible – las recetas pueden publicarse en una API publica donde otros investigadores pueden descubrirlas y reutilizarlas El pipeline tiene tres niveles: Steps – transformaciones individuales (compute, recode, filter, rename, remove, join, validate) Recipes – colecciones reutilizables de steps agrupados con metadatos Workflows – estimaciones estadisticas (svymean, svytotal, svyby) que producen las tablas finales El paquete maneja el survey design —estratificacion, conglomerados, pesos replicados— automaticamente traves del objeto Survey. El usuario se enfoca en el analisis sustantivo; metasurvey se encarga de la infraestructura.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"instalacion","dir":"Articles","previous_headings":"","what":"Instalacion","title":"Primeros pasos con metasurvey (ES)","text":"","code":"# Install from GitHub devtools::install_github(\"metaSurveyR/metasurvey\") library(metasurvey) library(data.table)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"creacion-de-un-objeto-survey","dir":"Articles","previous_headings":"","what":"Creacion de un objeto Survey","title":"Primeros pasos con metasurvey (ES)","text":"Un objeto Survey agrupa los microdatos con metadatos sobre pesos, edicion y tipo de encuesta. Utilizamos una muestra de microdatos reales de la Encuesta Continua de Hogares (ECH) 2023, publicada por el Instituto Nacional de Estadistica (INE) de Uruguay. La ECH es una encuesta de hogares de panel rotativo. Las variables clave incluyen: e27: Edad en anios e26: Sexo (1 = Hombre, 2 = Mujer) e30: Parentesco con el jefe de hogar (1-14) 1 = Menor de 14 2 = Ocupado 3-5 = Desocupado 6-10 = Inactivo 11 = aplica HT11: Ingreso del hogar (pesos uruguayos) W_ANO: Factor de expansion anual (peso) La funcion add_weight() mapea etiquetas de periodicidad (por ejemplo, “annual”, “monthly”) los nombres de las columnas de pesos en los datos. Esto permite que la misma receta funcione con distintas ediciones de la encuesta. Es posible inspeccionar los datos en cualquier momento:","code":"library(metasurvey) library(data.table)  # Cargar muestra de microdatos reales de la ECH 2023 (200 hogares, ~500 personas) dt <- fread(system.file(\"extdata\", \"ech_2023_sample.csv\", package = \"metasurvey\"))  # Crear objeto Survey svy <- Survey$new(   data    = dt,   edition = \"2023\",   type    = \"ech\",   engine  = \"data.table\",   weight  = add_weight(annual = \"W_ANO\") ) head(get_data(svy), 3) #>       ID  nper  anio   mes region  dpto   nom_dpto   e26   e27   e30 e51_2 #>    <int> <int> <int> <int>  <int> <int>     <char> <int> <int> <int> <int> #> 1: 34561     1  2023     1      1     1 Montevideo     2    26     1     6 #> 2: 34561     2  2023     1      1     1 Montevideo     2    45     7     6 #> 3: 34561     3  2023     1      1     1 Montevideo     2     7     4     1 #>    POBPCOAC SUBEMPLEO    HT11 pobre06 W_ANO #>       <int>     <int>   <num>   <int> <int> #> 1:        2         0 55429.6       0    57 #> 2:        4         0 55429.6       0    57 #> 3:        1         0 55429.6       0    57"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"trabajo-con-steps","dir":"Articles","previous_headings":"","what":"Trabajo con Steps","title":"Primeros pasos con metasurvey (ES)","text":"Los steps son lazy por defecto: se registran pero se ejecutan hasta que se llama bake_steps(). Esto permite: Construir un pipeline de transformacion completo Inspeccionar y validar los steps antes de la ejecucion Reutilizar secuencias de steps como recetas Asegurar que todas las dependencias existan antes del procesamiento","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"calculo-de-nuevas-variables","dir":"Articles","previous_headings":"Trabajo con Steps","what":"Calculo de nuevas variables","title":"Primeros pasos con metasurvey (ES)","text":"Se utiliza step_compute() para crear variables derivadas. El paquete automaticamente: Valida que las variables de entrada existan Detecta dependencias entre steps Optimiza las expresiones para mejorar el rendimiento Es posible agrupar calculos usando el parametro .(similar data.table):","code":"svy <- step_compute(svy,   # Convert income to thousands for readability   ht11_thousands = HT11 / 1000,    # Create employment indicator following ILO definitions   employed = ifelse(POBPCOAC == 2, 1, 0),    # Working age population (14+ years, ECH standard)   working_age = ifelse(e27 >= 14, 1, 0),   comment = \"Basic labor force indicators\" ) # Calculate mean household income per department svy <- step_compute(svy,   mean_income_dept = mean(HT11, na.rm = TRUE),   .by = \"dpto\",   comment = \"Department-level income averages\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"recodificacion-en-categorias","dir":"Articles","previous_headings":"Trabajo con Steps","what":"Recodificacion en categorias","title":"Primeros pasos con metasurvey (ES)","text":"Se utiliza step_recode() para crear variables categoricas partir de condiciones. Las condiciones se evaluan de arriba hacia abajo, y la primera coincidencia es la que se aplica.","code":"# Recode labor force status (POBPCOAC) into meaningful categories svy <- step_recode(svy, labor_status,   POBPCOAC == 2 ~ \"Employed\",   POBPCOAC %in% 3:5 ~ \"Unemployed\",   POBPCOAC %in% 6:10 ~ \"Inactive\",   .default = \"Not classified\",   comment = \"Labor force status - ILO standard\" )  # Create standard age groups for labor statistics svy <- step_recode(svy, age_group,   e27 < 25 ~ \"Youth (14-24)\",   e27 < 45 ~ \"Adult (25-44)\",   e27 < 65 ~ \"Mature (45-64)\",   .default = \"Elderly (65+)\",   .to_factor = TRUE, # Convert to factor   ordered = TRUE, # Ordered factor   comment = \"Age groups for labor analysis\" )  # Recode sex into descriptive labels svy <- step_recode(svy, gender,   e26 == 1 ~ \"Male\",   e26 == 2 ~ \"Female\",   .default = \"Other\",   comment = \"Gender classification\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"filtrado-de-filas","dir":"Articles","previous_headings":"Trabajo con Steps","what":"Filtrado de filas","title":"Primeros pasos con metasurvey (ES)","text":"Se utiliza step_filter() para seleccionar filas segun condiciones logicas. Multiples condiciones se combinan con . Al igual que los demas steps, los filtros son lazy por defecto.","code":"# Mantener solo individuos en edad de trabajar (14+) svy <- step_filter(svy,   e27 >= 14,   comment = \"Working-age population only\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"renombrar-y-eliminar-variables","dir":"Articles","previous_headings":"Trabajo con Steps","what":"Renombrar y eliminar variables","title":"Primeros pasos con metasurvey (ES)","text":"Se renombran variables para mayor claridad o consistencia: Se eliminan variables que ya son necesarias:","code":"svy <- step_rename(svy,   age = e27, # Rename e27 to age   sex_code = e26 # Keep original as sex_code ) # Remove intermediate calculations svy <- step_remove(svy, working_age, mean_income_dept)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"union-con-datos-externos","dir":"Articles","previous_headings":"Trabajo con Steps","what":"Union con datos externos","title":"Primeros pasos con metasurvey (ES)","text":"Se utiliza step_join() para unir datos de referencia externos. Esto es util para agregar: Nombres y clasificaciones geograficas Tipos de cambio o deflactores Benchmarks o metas externas Los microdatos reales de la ECH ya incluyen nom_dpto y region. Aqui demostramos un join con lineas de pobreza como ejemplo:","code":"# Lineas de pobreza por region (valores ilustrativos en UYU, 2023) poverty_lines <- data.table(   region = 1:3,   poverty_line = c(19000, 12500, 11000),   region_name = c(\"Montevideo\", \"Interior loc. >= 5000\", \"Interior loc. < 5000\") )  svy <- step_join(svy,   poverty_lines,   by = \"region\",   type = \"left\",   comment = \"Add poverty lines by region\" )"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"aplicacion-de-steps-bake","dir":"Articles","previous_headings":"Ejecucion de transformaciones","what":"Aplicacion de steps (bake)","title":"Primeros pasos con metasurvey (ES)","text":"Se llama bake_steps() para ejecutar todas las transformaciones pendientes: El historial de steps se preserva para documentacion y reproducibilidad:","code":"svy <- bake_steps(svy) head(get_data(svy), 3) #>    region  dpto    ID  nper  anio   mes   nom_dpto sex_code   age   e30 e51_2 #>     <int> <int> <int> <int> <int> <int>     <char>    <int> <int> <int> <int> #> 1:      1     1 34561     1  2023     1 Montevideo        2    26     1     6 #> 2:      1     1 34561     2  2023     1 Montevideo        2    45     7     6 #> 3:      1     1 34678     1  2023     1 Montevideo        1    48     1     6 #>    POBPCOAC SUBEMPLEO     HT11 pobre06 W_ANO ht11_thousands employed #>       <int>     <int>    <num>   <int> <int>          <num>    <num> #> 1:        2         0  55429.6       0    57        55.4296        1 #> 2:        4         0  55429.6       0    57        55.4296        0 #> 3:        2         0 152958.8       0    54       152.9588        1 #>    labor_status      age_group gender poverty_line region_name poverty_line.y #>          <char>         <fctr> <char>        <num>      <char>          <num> #> 1:     Employed Mature (45-64) Female        19000  Montevideo          19000 #> 2:   Unemployed Mature (45-64) Female        19000  Montevideo          19000 #> 3:     Employed Mature (45-64)   Male        19000  Montevideo          19000 #>    region_name.y #>           <char> #> 1:    Montevideo #> 2:    Montevideo #> 3:    Montevideo steps <- get_steps(svy) length(steps) # Number of transformation steps #> [1] 9  # View step details cat(\"Step 1:\", steps[[1]]$name, \"\\n\") #> Step 1: step_1 Compute: ht11_thousands, employed, working_age cat(\"Comment:\", steps[[1]]$comment, \"\\n\") #> Comment: Basic labor force indicators"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"visualizacion-del-pipeline","dir":"Articles","previous_headings":"Ejecucion de transformaciones","what":"Visualizacion del pipeline","title":"Primeros pasos con metasurvey (ES)","text":"Es posible visualizar el pipeline de transformacion como un grafo dirigido: Esto genera un grafo interactivo que muestra: Fuentes de datos y uniones Steps de transformacion Dependencias entre variables Comentarios y metadatos","code":"view_graph(svy, init_step = \"Load ECH 2023\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"estimaciones-estadisticas","dir":"Articles","previous_headings":"","what":"Estimaciones estadisticas","title":"Primeros pasos con metasurvey (ES)","text":"Una vez preparados los datos, se utiliza workflow() para calcular estimaciones de encuesta. La funcion envuelve los estimadores del paquete survey (Lumley 2004) y devuelve resultados ordenados con errores estandar y coeficientes de variacion. Importante: Se debe pasar el objeto survey dentro de un list().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"estimaciones-basicas","dir":"Articles","previous_headings":"Estimaciones estadisticas","what":"Estimaciones basicas","title":"Primeros pasos con metasurvey (ES)","text":"La salida incluye: estimate: Estimacion puntual se: Error estandar cv: Coeficiente de variacion var_name: Nombre de la variable level: Nivel del factor (para variables categoricas)","code":"# Estimate mean household income result <- workflow(   list(svy),   survey::svymean(~HT11, na.rm = TRUE),   estimation_type = \"annual\" )  result #>                     stat    value       se         cv confint_lower #>                   <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: HT11 110389.3 4076.154 0.03692528      102400.1 #>    confint_upper #>            <num> #> 1:      118378.4"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"estimaciones-multiples","dir":"Articles","previous_headings":"Estimaciones estadisticas","what":"Estimaciones multiples","title":"Primeros pasos con metasurvey (ES)","text":"Es posible calcular varias estadisticas en una sola llamada:","code":"results <- workflow(   list(svy),   survey::svymean(~HT11, na.rm = TRUE), # Mean income   survey::svytotal(~employed, na.rm = TRUE), # Total employed   survey::svymean(~labor_status, na.rm = TRUE), # Employment distribution   estimation_type = \"annual\" )  results #>                                       stat        value           se         cv #>                                     <char>        <num>        <num>      <num> #> 1:                   survey::svymean: HT11 1.103893e+05 4.076154e+03 0.03692528 #> 2:              survey::svytotal: employed 1.426200e+04 6.756206e+02 0.04737208 #> 3:   survey::svymean: labor_statusEmployed 5.551576e-01 2.610113e-02 0.04701571 #> 4:   survey::svymean: labor_statusInactive 3.860646e-01 2.551750e-02 0.06609646 #> 5: survey::svymean: labor_statusUnemployed 5.877773e-02 1.309115e-02 0.22272291 #>    confint_lower confint_upper #>            <num>         <num> #> 1:  1.024001e+05  1.183784e+05 #> 2:  1.293781e+04  1.558619e+04 #> 3:  5.040004e-01  6.063149e-01 #> 4:  3.360512e-01  4.360780e-01 #> 5:  3.311956e-02  8.443591e-02"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"estimacion-por-dominios","dir":"Articles","previous_headings":"Estimaciones estadisticas","what":"Estimacion por dominios","title":"Primeros pasos con metasurvey (ES)","text":"Se calculan estimaciones para subpoblaciones usando survey::svyby():","code":"# Mean income by gender income_by_gender <- workflow(   list(svy),   survey::svyby(~HT11, ~gender, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  income_by_gender #>                                   stat    value       se         cv #>                                 <char>    <num>    <num>      <num> #> 1: survey::svyby: HT11 [gender=Female] 111107.9 5955.676 0.05360263 #> 2:   survey::svyby: HT11 [gender=Male] 109608.9 5519.291 0.05035439 #>    confint_lower confint_upper gender #>            <num>         <num> <char> #> 1:      99434.99      122780.8 Female #> 2:      98791.31      120426.5   Male"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"evaluacion-de-calidad","dir":"Articles","previous_headings":"","what":"Evaluacion de calidad","title":"Primeros pasos con metasurvey (ES)","text":"El coeficiente de variacion (CV) mide la confiabilidad de las estimaciones. Un CV mas bajo indica estimaciones mas precisas. Siguiendo las pautas del INE Uruguay (Instituto Nacional de Estadística (INE) 2023): Se utiliza evaluate_cv() para clasificar la calidad de las estimaciones: Para estadisticas oficiales, siempre se debe reportar: Estimacion puntual Error estandar o intervalo de confianza Coeficiente de variacion Clasificacion de calidad Tamanio de la muestra","code":"# Check quality of mean income estimate cv_percentage <- results$cv[1] * 100 quality <- evaluate_cv(cv_percentage)  cat(\"CV:\", round(cv_percentage, 2), \"%\\n\") #> CV: 3.69 % cat(\"Quality:\", quality, \"\\n\") #> Quality: Excellent"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"trabajo-con-recipes","dir":"Articles","previous_headings":"","what":"Trabajo con Recipes","title":"Primeros pasos con metasurvey (ES)","text":"Las recipes agrupan steps de transformacion para reproducibilidad y comparticion. Una vez desarrollado un pipeline funcional, se puede convertir en una receta que puede ser: Aplicada diferentes ediciones de la encuesta Compartida con colaboradores Publicada para garantizar transparencia Versionada y documentada","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"creacion-de-una-recipe","dir":"Articles","previous_headings":"Trabajo con Recipes","what":"Creacion de una Recipe","title":"Primeros pasos con metasurvey (ES)","text":"Se crea una receta partir de los steps desarrollados: O se puede definir una receta desde cero:","code":"# Convert current steps to a recipe labor_recipe <- steps_to_recipe(   name = \"ECH Labor Force Indicators\",   user = \"National Statistics Office\",   svy = svy,   description = paste(     \"Standard labor force indicators following ILO definitions.\",     \"Creates employment status, age groups, and gender classifications.\"   ),   steps = get_steps(svy),   topic = \"labor_statistics\" )  class(labor_recipe) #> [1] \"Recipe\" \"R6\" labor_recipe$name #> [1] \"ECH Labor Force Indicators\" minimal_recipe <- recipe(   name = \"Basic Demographics - ECH\",   user = \"analyst\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Basic demographic recoding for ECH microdata\",   topic = \"demographics\",    # Define steps inline   step_recode(     gender,     e26 == 1 ~ \"Male\",     e26 == 2 ~ \"Female\",     .default = \"Other\"   ),   step_recode(     age_group,     e27 < 14 ~ \"Child\",     e27 < 65 ~ \"Adult\",     .default = \"Senior\"   ) )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"aplicacion-de-recipes-a-nuevos-datos","dir":"Articles","previous_headings":"Trabajo con Recipes","what":"Aplicacion de Recipes a nuevos datos","title":"Primeros pasos con metasurvey (ES)","text":"Una vez publicada, cualquier persona puede recuperar una receta por ID y aplicarla sus datos:","code":"# Obtener una receta por ID desde la API (requiere servidor) r <- api_get_recipe(\"ech_labor_001\")  # Aplicar a una nueva encuesta new_svy <- add_recipe(new_svy, r) processed <- bake_recipes(new_svy)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"documentacion-de-recipes","dir":"Articles","previous_headings":"Trabajo con Recipes","what":"Documentacion de Recipes","title":"Primeros pasos con metasurvey (ES)","text":"Las recetas documentan automaticamente sus transformaciones:","code":"doc <- labor_recipe$doc() names(doc) #> [1] \"meta\"             \"input_variables\"  \"output_variables\" \"pipeline\"  # Input variables required doc$input_variables #> [1] \"HT11\"     \"POBPCOAC\" \"e27\"      \"e26\"      \"region\"  # Output variables created doc$output_variables #> [1] \"ht11_thousands\"   \"employed\"         \"working_age\"      \"mean_income_dept\" #> [5] \"labor_status\"     \"age_group\"        \"gender\"           \"mapping\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"configuracion-del-paquete","dir":"Articles","previous_headings":"","what":"Configuracion del paquete","title":"Primeros pasos con metasurvey (ES)","text":"metasurvey ofrece configuraciones globales que se pueden ajustar segun el flujo de trabajo: Se pueden modificar las configuraciones para la sesion actual:","code":"# Check current lazy-processing setting lazy_default() # TRUE = steps recorded but not executed immediately #> [1] TRUE  # Check data-copy behavior use_copy_default() # TRUE = operate on copies (safer but slower) #> [1] TRUE  # View available computation engines show_engines() # \"data.table\", \"dplyr\", etc. #> [1] \"data.table\" \"tidyverse\"  \"dplyr\" # Disable lazy evaluation (execute steps immediately) set_lazy_processing(FALSE)  # Modify inplace (faster, but modifies original data) set_use_copy(FALSE)  # Reset to defaults set_lazy_processing(TRUE) set_use_copy(TRUE)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"compartir-el-trabajo-el-ecosistema-de-recipes","dir":"Articles","previous_headings":"","what":"Compartir el trabajo: el ecosistema de recipes","title":"Primeros pasos con metasurvey (ES)","text":"Uno de los objetivos de metasurvey es reducir el esfuerzo duplicado en la comunidad de investigadores que trabajan con encuestas. Si se ha construido un pipeline de procesamiento util, es posible publicarlo para que otros lo encuentren y reutilicen. El paquete se conecta una API publica donde se almacenan recipes y workflows: El ecosistema soporta tres niveles de certificacion (comunitaria, revisada, oficial) y tres tipos de cuenta (individual, miembro institucional, institucion). Las cuentas institucionales requieren aprobacion de un administrador, lo que asegura que las certificaciones tengan respaldo real. Para mas detalles, consultar Creacion y comparticion de Recipes.","code":"# Buscar recipes existentes (requiere servidor API) ech_recipes <- api_list_recipes(survey_type = \"ech\") length(ech_recipes)  # Buscar algo especifico labor <- api_list_recipes(search = \"labor\")  # Para publicar, crear una cuenta primero api_register(\"Your Name\", \"you@example.com\", \"password\")  # Luego publicar api_publish_recipe(labor_recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"datos-y-agradecimientos","dir":"Articles","previous_headings":"","what":"Datos y agradecimientos","title":"Primeros pasos con metasurvey (ES)","text":"Los datos de ejemplo utilizados en esta vinieta provienen de la Encuesta Continua de Hogares (ECH) 2023, publicada por el Instituto Nacional de Estadistica (INE) de Uruguay. Los microdatos completos estan disponibles en INE. El paquete ech de Gabriela Mathieu y Richard Detomasi fue una inspiracion importante para metasurvey. Mientras que ech provee funciones listas para usar para calcular indicadores socioeconomicos, metasurvey toma un enfoque diferente: proporciona una capa de metaprogramacion que permite los usuarios definir, compartir y reproducir sus propios pipelines de procesamiento.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"paquetes-relacionados","dir":"Articles","previous_headings":"","what":"Paquetes relacionados","title":"Primeros pasos con metasurvey (ES)","text":"metasurvey es parte de un ecosistema creciente de paquetes de R para el analisis de encuestas de hogares en America Latina: ech – Funciones para el calculo de indicadores socioeconomicos con la ECH de Uruguay (Mathieu & Detomasi). Provee funciones listas para usar sobre pobreza, ingresos, educacion e indicadores de empleo. eph – Herramientas para trabajar con la Encuesta Permanente de Hogares de Argentina. Publicado en rOpenSci. Cubre descarga de datos, construccion de paneles y calculo de pobreza. survey – El paquete fundamental para inferencia basada en disenio con encuestas complejas (Lumley 2004). metasurvey se construye sobre el.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started-es.html","id":"proximos-pasos","dir":"Articles","previous_headings":"","what":"Proximos pasos","title":"Primeros pasos con metasurvey (ES)","text":"Ahora que se comprenden los conceptos basicos, se pueden explorar estas guias: Creacion y comparticion de Recipes – Registro de recipes, certificacion y descubrimiento Workflows de estimacion – workflow(), RecipeWorkflow y estimaciones publicables Survey designs y validacion – Estratificacion, conglomerados, pesos replicados, validacion del pipeline Paneles rotativos y PoolSurvey – Analisis longitudinal con RotativePanelSurvey y PoolSurvey Caso de estudio ECH – Analisis completo del mercado laboral con comparacion con STATA","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with metasurvey","text":"Working household survey microdata involves great deal repetitive processing: recoding categorical variables, building indicators, joining external data, computing weighted estimates. researcher writes version transformations, code rarely shared documented way others can reuse. metasurvey addresses problem providing metaprogramming layer top survey package (Lumley 2004). Instead writing ad hoc scripts, build pipeline transformations : Documented – every step carries comment, input/output variables, dependencies Reproducible – pipeline can saved recipe applied new data Shareable – recipes can published public API researchers can discover reuse pipeline three levels: Steps – individual transformations (compute, recode, filter, rename, remove, join, validate) Recipes – reusable collections steps bundled metadata Workflows – statistical estimates (svymean, svytotal, svyby) produce final tables package handles survey design —stratification, clusters, replicate weights— automatically Survey object. user focuses substantive analysis; metasurvey takes care infrastructure.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting Started with metasurvey","text":"","code":"# Install from GitHub devtools::install_github(\"metaSurveyR/metasurvey\") library(metasurvey) library(data.table)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"creating-a-survey-object","dir":"Articles","previous_headings":"","what":"Creating a Survey object","title":"Getting Started with metasurvey","text":"Survey object groups microdata together metadata weights, edition, survey type. use sample real microdata Uruguay’s Encuesta Continua de Hogares (ECH, Continuous Household Survey) 2023, published Instituto Nacional de Estadistica (INE). ECH rotating-panel household survey. Key variables include: e27: Age years e26: Sex (1 = Male, 2 = Female) e30: Relationship head household (1-14) 1 = 14 2 = Employed 3-5 = Unemployed 6-10 = Inactive 11 = applicable HT11: Household income (Uruguayan pesos) W_ANO: Annual expansion factor (weight) add_weight() function maps periodicity labels (e.g., “annual”, “monthly”) weight column names data. lets recipe work across different survey editions. can inspect data time:","code":"library(metasurvey) library(data.table)  # Load a sample of real ECH 2023 microdata (200 households, ~500 persons) dt <- fread(system.file(\"extdata\", \"ech_2023_sample.csv\", package = \"metasurvey\"))  # Create Survey object svy <- Survey$new(   data    = dt,   edition = \"2023\",   type    = \"ech\",   engine  = \"data.table\",   weight  = add_weight(annual = \"W_ANO\") ) head(get_data(svy), 3) #>       ID  nper  anio   mes region  dpto   nom_dpto   e26   e27   e30 e51_2 #>    <int> <int> <int> <int>  <int> <int>     <char> <int> <int> <int> <int> #> 1: 34561     1  2023     1      1     1 Montevideo     2    26     1     6 #> 2: 34561     2  2023     1      1     1 Montevideo     2    45     7     6 #> 3: 34561     3  2023     1      1     1 Montevideo     2     7     4     1 #>    POBPCOAC SUBEMPLEO    HT11 pobre06 W_ANO #>       <int>     <int>   <num>   <int> <int> #> 1:        2         0 55429.6       0    57 #> 2:        4         0 55429.6       0    57 #> 3:        1         0 55429.6       0    57"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"working-with-steps","dir":"Articles","previous_headings":"","what":"Working with Steps","title":"Getting Started with metasurvey","text":"Steps lazy default: recorded executed bake_steps() called. allows : Build complete transformation pipeline Inspect validate steps execution Reuse step sequences recipes Ensure dependencies exist processing","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"computing-new-variables","dir":"Articles","previous_headings":"Working with Steps","what":"Computing new variables","title":"Getting Started with metasurvey","text":"Use step_compute() create derived variables. package automatically: Validates input variables exist Detects dependencies steps Optimizes expressions performance can group computations using .parameter (similar data.table):","code":"svy <- step_compute(svy,   # Convert income to thousands for readability   ht11_thousands = HT11 / 1000,    # Create employment indicator following ILO definitions   employed = ifelse(POBPCOAC == 2, 1, 0),    # Working age population (14+ years, ECH standard)   working_age = ifelse(e27 >= 14, 1, 0),   comment = \"Basic labor force indicators\" ) # Calculate mean household income per department svy <- step_compute(svy,   mean_income_dept = mean(HT11, na.rm = TRUE),   .by = \"dpto\",   comment = \"Department-level income averages\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"recoding-into-categories","dir":"Articles","previous_headings":"Working with Steps","what":"Recoding into categories","title":"Getting Started with metasurvey","text":"Use step_recode() create categorical variables conditions. Conditions evaluated top bottom, first match applies.","code":"# Recode labor force status (POBPCOAC) into meaningful categories svy <- step_recode(svy, labor_status,   POBPCOAC == 2 ~ \"Employed\",   POBPCOAC %in% 3:5 ~ \"Unemployed\",   POBPCOAC %in% 6:10 ~ \"Inactive\",   .default = \"Not classified\",   comment = \"Labor force status - ILO standard\" )  # Create standard age groups for labor statistics svy <- step_recode(svy, age_group,   e27 < 25 ~ \"Youth (14-24)\",   e27 < 45 ~ \"Adult (25-44)\",   e27 < 65 ~ \"Mature (45-64)\",   .default = \"Elderly (65+)\",   .to_factor = TRUE, # Convert to factor   ordered = TRUE, # Ordered factor   comment = \"Age groups for labor analysis\" )  # Recode sex into descriptive labels svy <- step_recode(svy, gender,   e26 == 1 ~ \"Male\",   e26 == 2 ~ \"Female\",   .default = \"Other\",   comment = \"Gender classification\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"filtering-rows","dir":"Articles","previous_headings":"Working with Steps","what":"Filtering rows","title":"Getting Started with metasurvey","text":"Use step_filter() subset rows based logical conditions. Multiple conditions combined . Like steps, filters lazy default.","code":"# Keep only working-age individuals (14+) svy <- step_filter(svy,   e27 >= 14,   comment = \"Working-age population only\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"renaming-and-removing-variables","dir":"Articles","previous_headings":"Working with Steps","what":"Renaming and removing variables","title":"Getting Started with metasurvey","text":"Rename variables clarity consistency: Remove variables longer needed:","code":"svy <- step_rename(svy,   age = e27, # Rename e27 to age   sex_code = e26 # Keep original as sex_code ) # Remove intermediate calculations svy <- step_remove(svy, working_age, mean_income_dept)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"joining-external-data","dir":"Articles","previous_headings":"Working with Steps","what":"Joining external data","title":"Getting Started with metasurvey","text":"Use step_join() merge external reference data. useful adding: Geographic names classifications Exchange rates deflators External benchmarks targets Note real ECH microdata already includes nom_dpto region. demonstrate join poverty-line lookup example:","code":"# Poverty lines by region (illustrative values in UYU, 2023) poverty_lines <- data.table(   region = 1:3,   poverty_line = c(19000, 12500, 11000),   region_name = c(\"Montevideo\", \"Interior loc. >= 5000\", \"Interior loc. < 5000\") )  svy <- step_join(svy,   poverty_lines,   by = \"region\",   type = \"left\",   comment = \"Add poverty lines by region\" )"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"applying-steps-bake","dir":"Articles","previous_headings":"Executing transformations","what":"Applying steps (bake)","title":"Getting Started with metasurvey","text":"Call bake_steps() execute pending transformations: step history preserved documentation reproducibility:","code":"svy <- bake_steps(svy) head(get_data(svy), 3) #>    region  dpto    ID  nper  anio   mes   nom_dpto sex_code   age   e30 e51_2 #>     <int> <int> <int> <int> <int> <int>     <char>    <int> <int> <int> <int> #> 1:      1     1 34561     1  2023     1 Montevideo        2    26     1     6 #> 2:      1     1 34561     2  2023     1 Montevideo        2    45     7     6 #> 3:      1     1 34678     1  2023     1 Montevideo        1    48     1     6 #>    POBPCOAC SUBEMPLEO     HT11 pobre06 W_ANO ht11_thousands employed #>       <int>     <int>    <num>   <int> <int>          <num>    <num> #> 1:        2         0  55429.6       0    57        55.4296        1 #> 2:        4         0  55429.6       0    57        55.4296        0 #> 3:        2         0 152958.8       0    54       152.9588        1 #>    labor_status      age_group gender poverty_line region_name poverty_line.y #>          <char>         <fctr> <char>        <num>      <char>          <num> #> 1:     Employed Mature (45-64) Female        19000  Montevideo          19000 #> 2:   Unemployed Mature (45-64) Female        19000  Montevideo          19000 #> 3:     Employed Mature (45-64)   Male        19000  Montevideo          19000 #>    region_name.y #>           <char> #> 1:    Montevideo #> 2:    Montevideo #> 3:    Montevideo steps <- get_steps(svy) length(steps) # Number of transformation steps #> [1] 9  # View step details cat(\"Step 1:\", steps[[1]]$name, \"\\n\") #> Step 1: step_1 Compute: ht11_thousands, employed, working_age cat(\"Comment:\", steps[[1]]$comment, \"\\n\") #> Comment: Basic labor force indicators"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"visualizing-the-pipeline","dir":"Articles","previous_headings":"Executing transformations","what":"Visualizing the pipeline","title":"Getting Started with metasurvey","text":"can visualize transformation pipeline directed graph: interactive DAG rendered vignette keep package size small. Run view_graph() R session get interactive graph showing: Data sources joins Transformation steps Variable dependencies Comments metadata","code":"view_graph(svy, init_step = \"Load ECH 2023\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"statistical-estimates","dir":"Articles","previous_headings":"","what":"Statistical estimates","title":"Getting Started with metasurvey","text":"data prepared, use workflow() compute survey estimates. function wraps estimators survey package (Lumley 2004) returns tidy results standard errors coefficients variation. Important: survey object must passed inside list().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"basic-estimates","dir":"Articles","previous_headings":"Statistical estimates","what":"Basic estimates","title":"Getting Started with metasurvey","text":"output includes: estimate: Point estimate se: Standard error cv: Coefficient variation var_name: Variable name level: Factor level (categorical variables)","code":"# Estimate mean household income result <- workflow(   list(svy),   survey::svymean(~HT11, na.rm = TRUE),   estimation_type = \"annual\" )  result #>                     stat    value       se         cv confint_lower #>                   <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: HT11 110389.3 4076.154 0.03692528      102400.1 #>    confint_upper #>            <num> #> 1:      118378.4"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"multiple-estimates","dir":"Articles","previous_headings":"Statistical estimates","what":"Multiple estimates","title":"Getting Started with metasurvey","text":"can compute several statistics single call:","code":"results <- workflow(   list(svy),   survey::svymean(~HT11, na.rm = TRUE),   survey::svytotal(~employed, na.rm = TRUE),   survey::svymean(~labor_status, na.rm = TRUE),   estimation_type = \"annual\" )  results #>                                       stat        value           se         cv #>                                     <char>        <num>        <num>      <num> #> 1:                   survey::svymean: HT11 1.103893e+05 4.076154e+03 0.03692528 #> 2:              survey::svytotal: employed 1.426200e+04 6.756206e+02 0.04737208 #> 3:   survey::svymean: labor_statusEmployed 5.551576e-01 2.610113e-02 0.04701571 #> 4:   survey::svymean: labor_statusInactive 3.860646e-01 2.551750e-02 0.06609646 #> 5: survey::svymean: labor_statusUnemployed 5.877773e-02 1.309115e-02 0.22272291 #>    confint_lower confint_upper #>            <num>         <num> #> 1:  1.024001e+05  1.183784e+05 #> 2:  1.293781e+04  1.558619e+04 #> 3:  5.040004e-01  6.063149e-01 #> 4:  3.360512e-01  4.360780e-01 #> 5:  3.311956e-02  8.443591e-02"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"domain-estimation","dir":"Articles","previous_headings":"Statistical estimates","what":"Domain estimation","title":"Getting Started with metasurvey","text":"Compute estimates subpopulations using survey::svyby():","code":"# Mean income by gender income_by_gender <- workflow(   list(svy),   survey::svyby(~HT11, ~gender, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  income_by_gender #>                                   stat    value       se         cv #>                                 <char>    <num>    <num>      <num> #> 1: survey::svyby: HT11 [gender=Female] 111107.9 5955.676 0.05360263 #> 2:   survey::svyby: HT11 [gender=Male] 109608.9 5519.291 0.05035439 #>    confint_lower confint_upper gender #>            <num>         <num> <char> #> 1:      99434.99      122780.8 Female #> 2:      98791.31      120426.5   Male"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"quality-assessment","dir":"Articles","previous_headings":"","what":"Quality assessment","title":"Getting Started with metasurvey","text":"coefficient variation (CV) measures reliability estimates. lower CV indicates precise estimates. Following INE Uruguay guidelines (Instituto Nacional de Estadística (INE) 2023): Use evaluate_cv() classify estimate quality: official statistics, always report: Point estimate Standard error confidence interval Coefficient variation Quality classification Sample size","code":"# Check quality of mean income estimate cv_percentage <- results$cv[1] * 100 quality <- evaluate_cv(cv_percentage)  cat(\"CV:\", round(cv_percentage, 2), \"%\\n\") #> CV: 3.69 % cat(\"Quality:\", quality, \"\\n\") #> Quality: Excellent"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"working-with-recipes","dir":"Articles","previous_headings":"","what":"Working with Recipes","title":"Getting Started with metasurvey","text":"Recipes bundle transformation steps reproducibility sharing. developed working pipeline, can convert recipe can : Applied different survey editions Shared collaborators Published transparency Versioned documented","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"creating-a-recipe","dir":"Articles","previous_headings":"Working with Recipes","what":"Creating a Recipe","title":"Getting Started with metasurvey","text":"Create recipe steps developed: can define recipe scratch:","code":"# Convert current steps to a recipe labor_recipe <- steps_to_recipe(   name = \"ECH Labor Force Indicators\",   user = \"National Statistics Office\",   svy = svy,   description = paste(     \"Standard labor force indicators following ILO definitions.\",     \"Creates employment status, age groups, and gender classifications.\"   ),   steps = get_steps(svy),   topic = \"labor_statistics\" )  class(labor_recipe) #> [1] \"Recipe\" \"R6\" labor_recipe$name #> [1] \"ECH Labor Force Indicators\" minimal_recipe <- recipe(   name = \"Basic Demographics - ECH\",   user = \"analyst\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Basic demographic recoding for ECH microdata\",   topic = \"demographics\",    # Define steps inline   step_recode(     gender,     e26 == 1 ~ \"Male\",     e26 == 2 ~ \"Female\",     .default = \"Other\"   ),   step_recode(     age_group,     e27 < 14 ~ \"Child\",     e27 < 65 ~ \"Adult\",     .default = \"Senior\"   ) )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"applying-recipes-to-new-data","dir":"Articles","previous_headings":"Working with Recipes","what":"Applying Recipes to new data","title":"Getting Started with metasurvey","text":"published, anyone can retrieve recipe ID apply data:","code":"# Get a recipe by ID from the API (requires server) r <- api_get_recipe(\"ech_labor_001\")  # Apply to a new survey new_svy <- add_recipe(new_svy, r) processed <- bake_recipes(new_svy)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"recipe-documentation","dir":"Articles","previous_headings":"Working with Recipes","what":"Recipe documentation","title":"Getting Started with metasurvey","text":"Recipes automatically document transformations:","code":"doc <- labor_recipe$doc() names(doc) #> [1] \"meta\"             \"input_variables\"  \"output_variables\" \"pipeline\"  # Input variables required doc$input_variables #> [1] \"HT11\"     \"POBPCOAC\" \"e27\"      \"e26\"      \"region\"  # Output variables created doc$output_variables #> [1] \"ht11_thousands\"   \"employed\"         \"working_age\"      \"mean_income_dept\" #> [5] \"labor_status\"     \"age_group\"        \"gender\"           \"mapping\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"package-configuration","dir":"Articles","previous_headings":"","what":"Package configuration","title":"Getting Started with metasurvey","text":"metasurvey provides global settings can adjusted suit workflow: can modify settings current session:","code":"# Check current lazy-processing setting lazy_default() # TRUE = steps recorded but not executed immediately #> [1] TRUE  # Check data-copy behavior use_copy_default() # TRUE = operate on copies (safer but slower) #> [1] TRUE  # View available computation engines show_engines() # \"data.table\", \"dplyr\", etc. #> [1] \"data.table\" \"tidyverse\"  \"dplyr\" # Disable lazy evaluation (execute steps immediately) set_lazy_processing(FALSE)  # Modify inplace (faster, but modifies original data) set_use_copy(FALSE)  # Reset to defaults set_lazy_processing(TRUE) set_use_copy(TRUE)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"sharing-your-work-the-recipe-ecosystem","dir":"Articles","previous_headings":"","what":"Sharing your work: the recipe ecosystem","title":"Getting Started with metasurvey","text":"One goals metasurvey reduce duplicated effort among community researchers working surveys. built useful processing pipeline, can publish others can find reuse . package connects public API recipes workflows stored: ecosystem supports three certification levels (community, reviewed, official) three account types (individual, institutional member, institution). Institutional accounts require administrator approval, ensuring certifications carry real backing. details, see Creating Sharing Recipes.","code":"# Browse existing recipes (requires API server) ech_recipes <- api_list_recipes(survey_type = \"ech\") length(ech_recipes)  # Search for something specific labor <- api_list_recipes(search = \"labor\")  # To publish your own, create an account first api_register(\"Your Name\", \"you@example.com\", \"password\")  # Then publish api_publish_recipe(labor_recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"data-and-acknowledgments","dir":"Articles","previous_headings":"","what":"Data and acknowledgments","title":"Getting Started with metasurvey","text":"sample data used vignette comes Encuesta Continua de Hogares (ECH) 2023, published Uruguay’s Instituto Nacional de Estadistica (INE). full microdata available INE. ech package Gabriela Mathieu Richard Detomasi important inspiration metasurvey. ech provides ready--use functions computing socioeconomic indicators, metasurvey takes different approach: provides metaprogramming layer lets users define, share, reproduce processing pipelines.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"related-packages","dir":"Articles","previous_headings":"","what":"Related packages","title":"Getting Started with metasurvey","text":"metasurvey part growing ecosystem R packages household survey analysis Latin America: ech – Functions computing socioeconomic indicators Uruguay’s ECH (Mathieu & Detomasi). Provides ready--use functions poverty, income, education, employment indicators. eph – Tools working Argentina’s Encuesta Permanente de Hogares. Published rOpenSci. Covers data download, panel construction, poverty calculation. survey – foundational package design-based inference complex surveys (Lumley 2004). metasurvey builds top .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/getting-started.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Getting Started with metasurvey","text":"Now understand basics, can explore guides: Creating Sharing Recipes – Recipe registry, certification, discovery Estimation Workflows – workflow(), RecipeWorkflow, publishable estimates Survey Designs Validation – Stratification, clusters, replicate weights, pipeline validation Rotating Panels PoolSurvey – Longitudinal analysis RotativePanelSurvey PoolSurvey ECH Case Study – Full labor market analysis STATA comparison","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"introduccion","dir":"Articles","previous_headings":"","what":"Introduccion","title":"Compatibilidad con encuestas internacionales (ES)","text":"La clase Survey y el pipeline de steps (step_compute, step_recode, step_rename, step_remove, step_join) de metasurvey son agnosticos respecto la encuesta: funcionan con cualquier dato tabular. Esta vigneta demuestra la compatibilidad con 7 encuestas de hogares de 6 paises, utilizando datos reales incluidos en los paquetes cuando es posible. Para cada encuesta mostramos el flujo completo: cargar datos, crear un Survey, aplicar steps, estimar con workflow() y empaquetar el pipeline como Recipe.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"instalacion-de-paquetes-complementarios","dir":"Articles","previous_headings":"Introduccion","what":"Instalacion de paquetes complementarios","title":"Compatibilidad con encuestas internacionales (ES)","text":"La mayoria de los paquetes estan en CRAN. El paquete casen solo esta disponible desde GitHub. Los paquetes faltantes se instalan automaticamente al construir esta vigneta, pero tambien se pueden instalar manualmente:","code":"# Paquetes de CRAN install.packages(c(\"eph\", \"PNADcIBGE\", \"ipumsr\", \"rdhs\"))  # Paquetes solo en GitHub # install.packages(\"remotes\") remotes::install_github(\"pachadotdev/casen\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"ech-uruguay","dir":"Articles","previous_headings":"","what":"ECH – Uruguay","title":"Compatibilidad con encuestas internacionales (ES)","text":"La ECH (Encuesta Continua de Hogares) es la encuesta principal para la que se construyo metasurvey. Una muestra viene incluida en el paquete. Para el pipeline completo de la ECH, ver vignette(\"ech-case-study\").","code":"library(metasurvey) library(data.table)  dt_ech <- fread(   system.file(\"extdata\", \"ech_2023_sample.csv\", package = \"metasurvey\") )  svy_ech <- Survey$new(   data    = dt_ech,   edition = \"2023\",   type    = \"ech\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"W_ANO\") )  svy_ech <- svy_ech |>   step_recode(labor_status,     POBPCOAC == 2 ~ \"Employed\",     POBPCOAC %in% 3:5 ~ \"Unemployed\",     POBPCOAC %in% c(6:10, 1) ~ \"Inactive or under 14\",     comment = \"Estado de actividad segun OIT\"   ) |>   step_compute(     income_pc = HT11 / nper,     comment = \"Ingreso per capita del hogar\"   ) |>   bake_steps()  workflow(   list(svy_ech),   survey::svymean(~HT11, na.rm = TRUE),   estimation_type = \"annual\" ) #>                     stat    value       se         cv confint_lower #>                   <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: HT11 107869.1 3473.836 0.03220417      101060.5 #>    confint_upper #>            <num> #> 1:      114677.7"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"eph-argentina","dir":"Articles","previous_headings":"","what":"EPH – Argentina","title":"Compatibilidad con encuestas internacionales (ES)","text":"La EPH (Encuesta Permanente de Hogares) es la encuesta trimestral de fuerza laboral de Argentina. El paquete eph (CRAN, GitHub) incluye una base de juguete. Para descargar microdatos reales de la EPH: eph::get_microdata(year = 2023, period = 3, type = \"individual\").","code":"library(eph)  data(\"toybase_individual_2016_04\", package = \"eph\") dt_eph <- data.table(toybase_individual_2016_04)  svy_eph <- Survey$new(   data    = dt_eph,   edition = \"201604\",   type    = \"eph\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(quarterly = \"PONDERA\") )  svy_eph <- svy_eph |>   step_recode(labor_status,     ESTADO == 1 ~ \"Employed\",     ESTADO == 2 ~ \"Unemployed\",     ESTADO == 3 ~ \"Inactive\",     .default = NA_character_,     comment = \"Estado de actividad (INDEC)\"   ) |>   step_recode(sex,     CH04 == 1 ~ \"Male\",     CH04 == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sexo (CH04)\"   ) |>   step_compute(     employed = ifelse(ESTADO == 1, 1L, 0L),     comment = \"Indicador de empleo\"   ) |>   bake_steps()  # Tasa de empleo workflow(   list(svy_eph),   survey::svymean(~employed, na.rm = TRUE),   estimation_type = \"quarterly\" ) #>                         stat     value         se         cv confint_lower #>                       <char>     <num>      <num>      <num>         <num> #> 1: survey::svymean: employed 0.4378169 0.01668347 0.03810603     0.4051179 #>    confint_upper #>            <num> #> 1:     0.4705159"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"casen-chile","dir":"Articles","previous_headings":"","what":"CASEN – Chile","title":"Compatibilidad con encuestas internacionales (ES)","text":"La CASEN (Encuesta de Caracterizacion Socioeconomica Nacional) es la principal encuesta socioeconomica de Chile. Utiliza muestreo estratificado por conglomerados. El paquete casen (GitHub) incluye una muestra de la region de Los Rios. Instalar con remotes::install_github(\"pachadotdev/casen\"). Para los microdatos completos de la CASEN: descargar_casen_github(2017, tempdir()) del paquete casen.","code":"# Requiere: remotes::install_github(\"pachadotdev/casen\") data(\"casen_2017_los_rios\") dt_casen <- data.table(casen_2017_los_rios)  svy_casen <- Survey$new(   data    = dt_casen,   edition = \"2017\",   type    = \"casen\",   psu     = \"varunit\",   strata  = \"varstrat\",   engine  = \"data.table\",   weight  = add_weight(annual = \"expc\") )  svy_casen <- svy_casen |>   step_recode(sex,     sexo == 1 ~ \"Male\",     sexo == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sexo (codebook MDS)\"   ) |>   step_recode(poverty_status,     pobreza == 1 ~ \"Extreme poverty\",     pobreza == 2 ~ \"Non-extreme poverty\",     pobreza == 3 ~ \"Not poor\",     .default = NA_character_,     comment = \"Situacion de pobreza\"   ) |>   step_compute(     log_income = log(ytotcorh + 1),     comment = \"Log del ingreso del hogar\"   ) |>   bake_steps()  # Ingreso medio del hogar workflow(   list(svy_casen),   survey::svymean(~ytotcorh, na.rm = TRUE),   estimation_type = \"annual\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"pnadc-brasil","dir":"Articles","previous_headings":"","what":"PNADc – Brasil","title":"Compatibilidad con encuestas internacionales (ES)","text":"La PNADc (Pesquisa Nacional por Amostra de Domicilios Continua) es la encuesta trimestral de fuerza laboral de Brasil, con muestreo estratificado por conglomerados. El paquete PNADcIBGE (CRAN) incluye microdatos de ejemplo. Para microdatos reales de la PNADc: PNADcIBGE::get_pnadc(year = 2023, quarter = 1). La descarga es de aproximadamente 200 MB.","code":"library(PNADcIBGE)  dt_pnadc <- data.table(read_pnadc(   microdata = system.file(\"extdata\", \"exampledata.txt\", package = \"PNADcIBGE\"),   input_txt = system.file(\"extdata\", \"input_example.txt\", package = \"PNADcIBGE\") ))  svy_pnadc <- Survey$new(   data    = dt_pnadc,   edition = \"202301\",   type    = \"pnadc\",   psu     = \"UPA\",   strata  = \"Estrato\",   engine  = \"data.table\",   weight  = add_weight(quarterly = \"V1028\") )  svy_pnadc <- svy_pnadc |>   step_recode(sex,     V2007 == 1 ~ \"Male\",     V2007 == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sexo (V2007)\"   ) |>   step_compute(     age = as.integer(V2009),     comment = \"Edad en anios\"   ) |>   bake_steps()  workflow(   list(svy_pnadc),   survey::svymean(~age, na.rm = TRUE),   estimation_type = \"quarterly\" ) #>                    stat    value       se         cv confint_lower #>                  <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: age 35.55343 0.856023 0.02407708      33.87566 #>    confint_upper #>            <num> #> 1:      37.23121"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"cps-estados-unidos","dir":"Articles","previous_headings":"","what":"CPS – Estados Unidos","title":"Compatibilidad con encuestas internacionales (ES)","text":"La CPS (Current Population Survey) es la encuesta mensual de fuerza laboral de Estados Unidos. El paquete ipumsr (CRAN, GitHub) incluye un extracto de CPS. Los datos de IPUMS requieren una cuenta gratuita en https://cps.ipums.org. El archivo DDI XML proporciona metadatos de variables para el etiquetado.","code":"library(ipumsr)  ddi <- read_ipums_ddi(   system.file(\"extdata\", \"cps_00160.xml\", package = \"ipumsr\") ) dt_cps <- data.table(read_ipums_micro(ddi, verbose = FALSE))  svy_cps <- Survey$new(   data    = dt_cps,   edition = \"2011\",   type    = \"cps\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"ASECWT\") )  svy_cps <- svy_cps |>   step_recode(health_status,     HEALTH == 1 ~ \"Excellent\",     HEALTH == 2 ~ \"Very good\",     HEALTH == 3 ~ \"Good\",     HEALTH == 4 ~ \"Fair\",     HEALTH == 5 ~ \"Poor\",     .default = NA_character_,     comment = \"Estado de salud autopercibido\"   ) |>   step_compute(     log_income = log(INCTOT + 1),     comment = \"Log del ingreso total\"   ) |>   bake_steps()  workflow(   list(svy_cps),   survey::svymean(~INCTOT, na.rm = TRUE),   estimation_type = \"annual\" ) #>                       stat     value      se         cv confint_lower #>                     <char>     <num>   <num>      <num>         <num> #> 1: survey::svymean: INCTOT 191645236 4277528 0.02232004     183261435 #>    confint_upper #>            <num> #> 1:     200029038"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"enigh-mexico","dir":"Articles","previous_headings":"","what":"ENIGH – Mexico","title":"Compatibilidad con encuestas internacionales (ES)","text":"La ENIGH (Encuesta Nacional de Ingresos y Gastos de los Hogares) es la encuesta de ingresos y gastos de Mexico. existe un paquete de R dedicado; los datos estan disponibles en INEGI. continuacion se presenta un ejemplo sintetico que replica la estructura real.","code":"set.seed(42) dt_enigh <- data.table(   id = 1:200,   upm = rep(1:40, each = 5),   est_dis = rep(1:10, each = 20),   factor = runif(200, 100, 500),   sexo_jefe = sample(1:2, 200, replace = TRUE),   edad_jefe = sample(18:80, 200, replace = TRUE),   ing_cor = rlnorm(200, 10, 1),   tam_hog = sample(1:8, 200, replace = TRUE) )  svy_enigh <- Survey$new(   data    = dt_enigh,   edition = \"2022\",   type    = \"enigh\",   psu     = \"upm\",   strata  = \"est_dis\",   engine  = \"data.table\",   weight  = add_weight(annual = \"factor\") )  svy_enigh <- svy_enigh |>   step_recode(sex_head,     sexo_jefe == 1 ~ \"Male\",     sexo_jefe == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sexo del jefe de hogar\"   ) |>   step_compute(     income_pc = ing_cor / tam_hog,     comment = \"Ingreso per capita del hogar\"   ) |>   bake_steps()  workflow(   list(svy_enigh),   survey::svymean(~income_pc, na.rm = TRUE),   estimation_type = \"annual\" ) #>                          stat    value       se        cv confint_lower #>                        <char>    <num>    <num>     <num>         <num> #> 1: survey::svymean: income_pc 11928.34 1473.022 0.1234893      9041.267 #>    confint_upper #>            <num> #> 1:      14815.41"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"dhs-internacional","dir":"Articles","previous_headings":"","what":"DHS – Internacional","title":"Compatibilidad con encuestas internacionales (ES)","text":"El programa DHS (Demographic Health Surveys) cubre mas de 90 paises. El paquete rdhs (CRAN, GitHub) proporciona acceso la API. Los datasets modelo (sin necesidad de autenticacion) estan disponibles en https://dhsprogram.com/data/model-datasets.cfm. Los datos de DHS requieren registro en https://dhsprogram.com. El paquete rdhs gestiona la autenticacion con la API. Los ponderadores (v005) deben dividirse por 1.000.000 antes de usarlos.","code":"library(haven)  # Descargar el modelo Individual Recode (sin credenciales) tf <- tempfile(fileext = \".zip\") download.file(   \"https://dhsprogram.com/data/model_data/dhs/zzir62dt.zip\",   tf,   mode = \"wb\", quiet = TRUE ) td <- tempdir() unzip(tf, exdir = td) dta_file <- list.files(td,   pattern = \"\\\\.DTA$\", full.names = TRUE,   ignore.case = TRUE ) dt_dhs <- data.table(read_dta(dta_file[1]))  # Los ponderadores DHS deben dividirse por 1.000.000 dt_dhs[, wt := as.numeric(v005) / 1e6]  svy_dhs <- Survey$new(   data    = dt_dhs,   edition = \"2020\",   type    = \"dhs\",   psu     = \"v001\",   strata  = \"v023\",   engine  = \"data.table\",   weight  = add_weight(annual = \"wt\") )  svy_dhs <- svy_dhs |>   step_recode(education,     v106 == 0 ~ \"No education\",     v106 == 1 ~ \"Primary\",     v106 == 2 ~ \"Secondary\",     v106 == 3 ~ \"Higher\",     .default = NA_character_,     comment = \"Nivel educativo (v106)\"   ) |>   step_compute(     children = as.numeric(v201),     comment = \"Hijos nacidos vivos\"   ) |>   bake_steps()  workflow(   list(svy_dhs),   survey::svymean(~children, na.rm = TRUE),   estimation_type = \"annual\" ) #>                         stat    value        se         cv confint_lower #>                       <char>    <num>     <num>      <num>         <num> #> 1: survey::svymean: children 2.769343 0.0758253 0.02738025      2.620729 #>    confint_upper #>            <num> #> 1:      2.917958"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"portabilidad-de-recipes","dir":"Articles","previous_headings":"","what":"Portabilidad de recipes","title":"Compatibilidad con encuestas internacionales (ES)","text":"La misma estructura Recipe funciona independientemente de la encuesta de origen: Los recipes capturan que transformaciones aplicar, de que encuesta provienen. Un recipe construido para la EPH puede adaptarse para la PNADc simplemente renombrando variables.","code":"set.seed(42) dt_demo <- data.table(   id     = 1:100,   age    = sample(18:65, 100, replace = TRUE),   income = round(runif(100, 1000, 5000), 2),   w      = round(runif(100, 0.5, 2), 4) )  svy_demo <- Survey$new(   data    = dt_demo,   edition = \"2023\",   type    = \"demo\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"w\") )  svy_demo <- svy_demo |>   step_compute(indicator = ifelse(age > 30, 1L, 0L)) |>   step_recode(age_group,     age < 30 ~ \"Young\",     age >= 30 ~ \"Adult\",     .default = NA_character_   )  my_recipe <- steps_to_recipe(   name        = \"Demo Indicators\",   user        = \"Research Team\",   svy         = svy_demo,   description = \"Indicadores demograficos reutilizables\",   steps       = get_steps(svy_demo),   topic       = \"demographics\" )  doc <- my_recipe$doc() cat(\"Entradas:\", paste(doc$input_variables, collapse = \", \"), \"\\n\") #> Entradas: age cat(\"Salidas:\", paste(doc$output_variables, collapse = \", \"), \"\\n\") #> Salidas: indicator, age_group"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys-es.html","id":"proximos-pasos","dir":"Articles","previous_headings":"","what":"Proximos pasos","title":"Compatibilidad con encuestas internacionales (ES)","text":"Primeros pasos – Objetos Survey y steps Disenos de encuestas y validacion – Disenos estratificados y por conglomerados, ponderadores de replicas Paneles rotativos – RotativePanelSurvey y PoolSurvey Recipes – Crear, guardar y compartir recipes Caso de estudio ECH – Pipeline completo de la ECH de Uruguay","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"International Survey Compatibility","text":"metasurvey’s Survey class step pipeline (step_compute, step_recode, step_rename, step_remove, step_join) survey-agnostic: work tabular data. vignette demonstrates compatibility 7 household surveys 6 countries, using real bundled data possible. survey show full flow: load data, create Survey, apply steps, estimate workflow(), package pipeline Recipe.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"installing-companion-packages","dir":"Articles","previous_headings":"Introduction","what":"Installing companion packages","title":"International Survey Compatibility","text":"packages CRAN. casen package available GitHub. Sections unavailable packages skipped automatically. Install manually see examples:","code":"# CRAN packages install.packages(c(\"eph\", \"PNADcIBGE\", \"ipumsr\", \"rdhs\"))  # GitHub-only packages # install.packages(\"remotes\") remotes::install_github(\"pachadotdev/casen\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"ech-uruguay","dir":"Articles","previous_headings":"","what":"ECH – Uruguay","title":"International Survey Compatibility","text":"ECH (Encuesta Continua de Hogares) primary survey metasurvey built . bundled sample included package. complete ECH pipeline, see vignette(\"ech-case-study\").","code":"library(metasurvey) library(data.table)  dt_ech <- fread(   system.file(\"extdata\", \"ech_2023_sample.csv\", package = \"metasurvey\") )  svy_ech <- Survey$new(   data    = dt_ech,   edition = \"2023\",   type    = \"ech\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"W_ANO\") )  svy_ech <- svy_ech |>   step_recode(labor_status,     POBPCOAC == 2 ~ \"Employed\",     POBPCOAC %in% 3:5 ~ \"Unemployed\",     POBPCOAC %in% c(6:10, 1) ~ \"Inactive or under 14\",     comment = \"ILO labor force status\"   ) |>   step_compute(     income_pc = HT11 / nper,     comment = \"Per capita household income\"   ) |>   bake_steps()  workflow(   list(svy_ech),   survey::svymean(~HT11, na.rm = TRUE),   estimation_type = \"annual\" ) #>                     stat    value       se         cv confint_lower #>                   <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: HT11 107869.1 3473.836 0.03220417      101060.5 #>    confint_upper #>            <num> #> 1:      114677.7"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"eph-argentina","dir":"Articles","previous_headings":"","what":"EPH – Argentina","title":"International Survey Compatibility","text":"EPH (Encuesta Permanente de Hogares) Argentina’s quarterly labor force survey. eph package (CRAN, GitHub) includes bundled toybase. download actual EPH microdata use eph::get_microdata(year = 2023, period = 3, type = \"individual\").","code":"library(eph)  data(\"toybase_individual_2016_04\", package = \"eph\") dt_eph <- data.table(toybase_individual_2016_04)  svy_eph <- Survey$new(   data    = dt_eph,   edition = \"201604\",   type    = \"eph\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(quarterly = \"PONDERA\") )  svy_eph <- svy_eph |>   step_recode(labor_status,     ESTADO == 1 ~ \"Employed\",     ESTADO == 2 ~ \"Unemployed\",     ESTADO == 3 ~ \"Inactive\",     .default = NA_character_,     comment = \"Labor force status (INDEC)\"   ) |>   step_recode(sex,     CH04 == 1 ~ \"Male\",     CH04 == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sex from CH04\"   ) |>   step_compute(     employed = ifelse(ESTADO == 1, 1L, 0L),     comment = \"Employment indicator\"   ) |>   bake_steps()  # Employment rate workflow(   list(svy_eph),   survey::svymean(~employed, na.rm = TRUE),   estimation_type = \"quarterly\" ) #>                         stat     value         se         cv confint_lower #>                       <char>     <num>      <num>      <num>         <num> #> 1: survey::svymean: employed 0.4378169 0.01668347 0.03810603     0.4051179 #>    confint_upper #>            <num> #> 1:     0.4705159"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"casen-chile","dir":"Articles","previous_headings":"","what":"CASEN – Chile","title":"International Survey Compatibility","text":"CASEN (Encuesta de Caracterizacion Socioeconomica Nacional) Chile’s main socioeconomic survey. uses stratified cluster sampling. casen package (GitHub) includes bundled sample Los Rios region. Install remotes::install_github(\"pachadotdev/casen\"). full CASEN microdata, use descargar_casen_github(2017, tempdir()) casen package.","code":"# Requires: remotes::install_github(\"pachadotdev/casen\") data(\"casen_2017_los_rios\") dt_casen <- data.table(casen_2017_los_rios)  svy_casen <- Survey$new(   data    = dt_casen,   edition = \"2017\",   type    = \"casen\",   psu     = \"varunit\",   strata  = \"varstrat\",   engine  = \"data.table\",   weight  = add_weight(annual = \"expc\") )  svy_casen <- svy_casen |>   step_recode(sex,     sexo == 1 ~ \"Male\",     sexo == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sex (MDS codebook)\"   ) |>   step_recode(poverty_status,     pobreza == 1 ~ \"Extreme poverty\",     pobreza == 2 ~ \"Non-extreme poverty\",     pobreza == 3 ~ \"Not poor\",     .default = NA_character_,     comment = \"Poverty status\"   ) |>   step_compute(     log_income = log(ytotcorh + 1),     comment = \"Log household income\"   ) |>   bake_steps()  # Mean household income workflow(   list(svy_casen),   survey::svymean(~ytotcorh, na.rm = TRUE),   estimation_type = \"annual\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"pnadc-brazil","dir":"Articles","previous_headings":"","what":"PNADc – Brazil","title":"International Survey Compatibility","text":"PNADc (Pesquisa Nacional por Amostra de Domicilios Continua) Brazil’s quarterly labor force survey stratified cluster sampling. PNADcIBGE package (CRAN) includes bundled example microdata. real PNADc microdata: PNADcIBGE::get_pnadc(year = 2023, quarter = 1). download approximately 200 MB.","code":"library(PNADcIBGE)  dt_pnadc <- data.table(read_pnadc(   microdata = system.file(\"extdata\", \"exampledata.txt\", package = \"PNADcIBGE\"),   input_txt = system.file(\"extdata\", \"input_example.txt\", package = \"PNADcIBGE\") ))  svy_pnadc <- Survey$new(   data    = dt_pnadc,   edition = \"202301\",   type    = \"pnadc\",   psu     = \"UPA\",   strata  = \"Estrato\",   engine  = \"data.table\",   weight  = add_weight(quarterly = \"V1028\") )  svy_pnadc <- svy_pnadc |>   step_recode(sex,     V2007 == 1 ~ \"Male\",     V2007 == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sex (V2007)\"   ) |>   step_compute(     age = as.integer(V2009),     comment = \"Age in years\"   ) |>   bake_steps()  workflow(   list(svy_pnadc),   survey::svymean(~age, na.rm = TRUE),   estimation_type = \"quarterly\" ) #>                    stat    value       se         cv confint_lower #>                  <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: age 35.55343 0.856023 0.02407708      33.87566 #>    confint_upper #>            <num> #> 1:      37.23121"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"cps-united-states","dir":"Articles","previous_headings":"","what":"CPS – United States","title":"International Survey Compatibility","text":"CPS (Current Population Survey) US monthly labor force survey. ipumsr package (CRAN, GitHub) includes bundled CPS extract. IPUMS data requires free account https://cps.ipums.org. DDI XML file provides variable metadata labeling.","code":"library(ipumsr)  ddi <- read_ipums_ddi(   system.file(\"extdata\", \"cps_00160.xml\", package = \"ipumsr\") ) dt_cps <- data.table(read_ipums_micro(ddi, verbose = FALSE))  svy_cps <- Survey$new(   data    = dt_cps,   edition = \"2011\",   type    = \"cps\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"ASECWT\") )  svy_cps <- svy_cps |>   step_recode(health_status,     HEALTH == 1 ~ \"Excellent\",     HEALTH == 2 ~ \"Very good\",     HEALTH == 3 ~ \"Good\",     HEALTH == 4 ~ \"Fair\",     HEALTH == 5 ~ \"Poor\",     .default = NA_character_,     comment = \"Self-reported health status\"   ) |>   step_compute(     log_income = log(INCTOT + 1),     comment = \"Log total income\"   ) |>   bake_steps()  workflow(   list(svy_cps),   survey::svymean(~INCTOT, na.rm = TRUE),   estimation_type = \"annual\" ) #>                       stat     value      se         cv confint_lower #>                     <char>     <num>   <num>      <num>         <num> #> 1: survey::svymean: INCTOT 191645236 4277528 0.02232004     183261435 #>    confint_upper #>            <num> #> 1:     200029038"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"enigh-mexico","dir":"Articles","previous_headings":"","what":"ENIGH – Mexico","title":"International Survey Compatibility","text":"ENIGH (Encuesta Nacional de Ingresos y Gastos de los Hogares) Mexico’s income expenditure survey. dedicated R package; data available INEGI. synthetic example mirrors real structure.","code":"set.seed(42) dt_enigh <- data.table(   id = 1:200,   upm = rep(1:40, each = 5),   est_dis = rep(1:10, each = 20),   factor = runif(200, 100, 500),   sexo_jefe = sample(1:2, 200, replace = TRUE),   edad_jefe = sample(18:80, 200, replace = TRUE),   ing_cor = rlnorm(200, 10, 1),   tam_hog = sample(1:8, 200, replace = TRUE) )  svy_enigh <- Survey$new(   data    = dt_enigh,   edition = \"2022\",   type    = \"enigh\",   psu     = \"upm\",   strata  = \"est_dis\",   engine  = \"data.table\",   weight  = add_weight(annual = \"factor\") )  svy_enigh <- svy_enigh |>   step_recode(sex_head,     sexo_jefe == 1 ~ \"Male\",     sexo_jefe == 2 ~ \"Female\",     .default = NA_character_,     comment = \"Sex of household head\"   ) |>   step_compute(     income_pc = ing_cor / tam_hog,     comment = \"Per capita household income\"   ) |>   bake_steps()  workflow(   list(svy_enigh),   survey::svymean(~income_pc, na.rm = TRUE),   estimation_type = \"annual\" ) #>                          stat    value       se        cv confint_lower #>                        <char>    <num>    <num>     <num>         <num> #> 1: survey::svymean: income_pc 11928.34 1473.022 0.1234893      9041.267 #>    confint_upper #>            <num> #> 1:      14815.41"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"dhs-international","dir":"Articles","previous_headings":"","what":"DHS – International","title":"International Survey Compatibility","text":"DHS (Demographic Health Surveys) program covers 90+ countries. rdhs package (CRAN, GitHub) provides API access. Model datasets (authentication needed) available https://dhsprogram.com/data/model-datasets.cfm. DHS data requires registration https://dhsprogram.com. rdhs package handles API authentication. Weights (v005) must divided 1,000,000 use.","code":"library(haven)  # Download the model Individual Recode (no credentials needed) tf <- tempfile(fileext = \".zip\") download.file(   \"https://dhsprogram.com/data/model_data/dhs/zzir62dt.zip\",   tf,   mode = \"wb\", quiet = TRUE ) td <- tempdir() unzip(tf, exdir = td) dta_file <- list.files(td,   pattern = \"\\\\.DTA$\", full.names = TRUE,   ignore.case = TRUE ) dt_dhs <- data.table(read_dta(dta_file[1]))  # DHS weights must be divided by 1,000,000 dt_dhs[, wt := as.numeric(v005) / 1e6]  svy_dhs <- Survey$new(   data    = dt_dhs,   edition = \"2020\",   type    = \"dhs\",   psu     = \"v001\",   strata  = \"v023\",   engine  = \"data.table\",   weight  = add_weight(annual = \"wt\") )  svy_dhs <- svy_dhs |>   step_recode(education,     v106 == 0 ~ \"No education\",     v106 == 1 ~ \"Primary\",     v106 == 2 ~ \"Secondary\",     v106 == 3 ~ \"Higher\",     .default = NA_character_,     comment = \"Education level (v106)\"   ) |>   step_compute(     children = as.numeric(v201),     comment = \"Children ever born\"   ) |>   bake_steps()  workflow(   list(svy_dhs),   survey::svymean(~children, na.rm = TRUE),   estimation_type = \"annual\" )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"recipe-portability","dir":"Articles","previous_headings":"","what":"Recipe portability","title":"International Survey Compatibility","text":"Recipe structure works regardless source survey: Recipes capture transformations apply, survey came . recipe built EPH can adapted PNADc simply renaming variables.","code":"set.seed(42) dt_demo <- data.table(   id     = 1:100,   age    = sample(18:65, 100, replace = TRUE),   income = round(runif(100, 1000, 5000), 2),   w      = round(runif(100, 0.5, 2), 4) )  svy_demo <- Survey$new(   data    = dt_demo,   edition = \"2023\",   type    = \"demo\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"w\") )  svy_demo <- svy_demo |>   step_compute(indicator = ifelse(age > 30, 1L, 0L)) |>   step_recode(age_group,     age < 30 ~ \"Young\",     age >= 30 ~ \"Adult\",     .default = NA_character_   )  my_recipe <- steps_to_recipe(   name        = \"Demo Indicators\",   user        = \"Research Team\",   svy         = svy_demo,   description = \"Reusable demographic indicators\",   steps       = get_steps(svy_demo),   topic       = \"demographics\" )  doc <- my_recipe$doc() cat(\"Inputs:\", paste(doc$input_variables, collapse = \", \"), \"\\n\") #> Inputs: age cat(\"Outputs:\", paste(doc$output_variables, collapse = \", \"), \"\\n\") #> Outputs: indicator, age_group"},{"path":"https://metasurveyr.github.io/metasurvey/articles/international-surveys.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"International Survey Compatibility","text":"Getting Started – Survey objects steps Survey Designs Validation – Stratified clustered designs, replicate weights Rotating Panels – RotativePanelSurvey PoolSurvey Recipes – Creating, saving, sharing recipes ECH Case Study – Full Uruguay ECH pipeline","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"introducción","dir":"Articles","previous_headings":"","what":"Introducción","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Muchas encuestas de hogares nacionales utilizan diseños de panel rotativo, donde una muestra de encuestados es entrevistada en una ola inicial (implantación) y luego se les da seguimiento durante períodos sucesivos. La ECH de Uruguay, por ejemplo, entrevista cada hogar una vez y luego realiza un seguimiento mensual durante el resto del año. metasurvey proporciona dos clases para este tipo de diseño: RotativePanelSurvey – un panel con una encuesta de implantación y una lista de encuestas de seguimiento PoolSurvey – una colección de encuestas agrupadas para realizar estimaciones combinadas entre períodos","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"creación-de-un-rotativepanelsurvey","dir":"Articles","previous_headings":"","what":"Creación de un RotativePanelSurvey","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Un RotativePanelSurvey requiere un Survey de implantación y uno o más objetos Survey de seguimiento.","code":"library(metasurvey) library(data.table) set_use_copy(TRUE)  set.seed(42) n <- 100  make_survey <- function(edition) {   dt <- data.table(     id       = 1:n,     age      = sample(18:80, n, replace = TRUE),     income   = round(runif(n, 5000, 80000)),     employed = sample(0:1, n, replace = TRUE),     w        = round(runif(n, 0.5, 3.0), 4)   )   Survey$new(     data = dt, edition = edition, type = \"ech\",     psu = NULL, engine = \"data.table\",     weight = add_weight(annual = \"w\")   ) }  # Implantation: 2023 wave 1 impl <- make_survey(\"2023\")  # Follow-ups: waves 2 through 4 fu_2 <- make_survey(\"2023\") fu_3 <- make_survey(\"2023\") fu_4 <- make_survey(\"2023\")  panel <- RotativePanelSurvey$new(   implantation   = impl,   follow_up      = list(fu_2, fu_3, fu_4),   type           = \"ech\",   default_engine = \"data.table\",   steps          = list(),   recipes        = list(),   workflows      = list(),   design         = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"acceso-a-los-componentes-del-panel","dir":"Articles","previous_headings":"","what":"Acceso a los componentes del panel","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Utilice get_implantation() y get_follow_up() para obtener las encuestas individuales:","code":"# Implantation survey imp <- get_implantation(panel) class(imp) #> [1] \"Survey\" \"R6\" head(get_data(imp), 3) #>       id   age income employed      w #>    <int> <int>  <num>    <int>  <num> #> 1:     1    66  21287        1 1.6114 #> 2:     2    54  21243        0 0.6510 #> 3:     3    18  34171        1 1.3188 # Follow-up surveys follow_ups <- get_follow_up(panel) cat(\"Number of follow-ups:\", length(follow_ups), \"\\n\") #> Number of follow-ups: 3"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"aplicación-de-pasos-a-los-componentes-del-panel","dir":"Articles","previous_headings":"","what":"Aplicación de pasos a los componentes del panel","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Aplique transformaciones componentes individuales del panel. Las mismas funciones de pasos funcionan tanto en la encuesta de implantación como en las de seguimiento:","code":"# Transform the implantation survey panel$implantation <- step_compute(panel$implantation,   income_k = income / 1000,   comment = \"Income in thousands\" )  # Apply the same step to each follow-up panel$follow_up <- lapply(panel$follow_up, function(svy) {   step_compute(svy, income_k = income / 1000, comment = \"Income in thousands\") })"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"estimación-sobre-componentes-del-panel","dir":"Articles","previous_headings":"","what":"Estimación sobre componentes del panel","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Utilice workflow() sobre los componentes individuales del panel para realizar análisis de corte transversal o de series de tiempo.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"análisis-de-corte-transversal-implantación","dir":"Articles","previous_headings":"Estimación sobre componentes del panel","what":"Análisis de corte transversal (Implantación)","title":"Paneles Rotativos y PoolSurvey (ES)","text":"","code":"result_impl <- workflow(   list(panel$implantation),   survey::svymean(~income, na.rm = TRUE),   estimation_type = \"annual\" )  result_impl #>                       stat    value       se         cv confint_lower #>                     <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: income 43742.45 2420.706 0.05533997      38997.96 #>    confint_upper #>            <num> #> 1:      48486.95"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"comparación-entre-seguimientos","dir":"Articles","previous_headings":"Estimación sobre componentes del panel","what":"Comparación entre seguimientos","title":"Paneles Rotativos y PoolSurvey (ES)","text":"","code":"results <- rbindlist(lapply(seq_along(panel$follow_up), function(i) {   r <- workflow(     list(panel$follow_up[[i]]),     survey::svymean(~income, na.rm = TRUE),     estimation_type = \"annual\"   )   r$period <- panel$follow_up[[i]]$edition   r }))  results[, .(period, stat, value, se, cv)] #>    period                    stat    value       se         cv #>     <num>                  <char>    <num>    <num>      <num> #> 1:   2023 survey::svymean: income 41537.99 2328.715 0.05606230 #> 2:   2023 survey::svymean: income 42809.39 2383.860 0.05568546 #> 3:   2023 survey::svymean: income 41314.46 2232.803 0.05404409"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"poolsurvey-estimación-combinada","dir":"Articles","previous_headings":"","what":"PoolSurvey: Estimación combinada","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Un PoolSurvey agrupa múltiples encuestas para realizar estimaciones combinadas. Esto resulta útil cuando se desea agregar datos mensuales en estimaciones trimestrales o anuales, o cuando combinar encuestas reduce la variabilidad muestral. El constructor recibe una lista anidada: list(estimation_type = list(group = list(surveys))).","code":"s1 <- make_survey(\"2023\") s2 <- make_survey(\"2023\") s3 <- make_survey(\"2023\")  pool <- PoolSurvey$new(   list(annual = list(\"q1\" = list(s1, s2, s3))) )  class(pool) #> [1] \"PoolSurvey\" \"R6\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"estimación-agrupada","dir":"Articles","previous_headings":"PoolSurvey: Estimación combinada","what":"Estimación agrupada","title":"Paneles Rotativos y PoolSurvey (ES)","text":"","code":"pool_result <- workflow(   pool,   survey::svymean(~income, na.rm = TRUE),   estimation_type = \"annual\" )  pool_result #>                       stat    value       se         cv confint_lower #>                     <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: income 44574.23 2226.844 0.04995811      40209.69 #> 2: survey::svymean: income 44341.53 2407.912 0.05430377      39622.10 #> 3: survey::svymean: income 41293.92 2239.968 0.05424451      36903.66 #>    confint_upper period   type variance #>            <num>  <num> <char>    <num> #> 1:      48938.76   2023     q1  4958836 #> 2:      49060.95   2023     q1  5798041 #> 3:      45684.18   2023     q1  5017458"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"múltiples-grupos","dir":"Articles","previous_headings":"PoolSurvey: Estimación combinada","what":"Múltiples grupos","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Es posible organizar las encuestas en múltiples grupos:","code":"s4 <- make_survey(\"2023\") s5 <- make_survey(\"2023\") s6 <- make_survey(\"2023\")  pool_semester <- PoolSurvey$new(   list(annual = list(     \"q1\" = list(s1, s2, s3),     \"q2\" = list(s4, s5, s6)   )) )  result_semester <- workflow(   pool_semester,   survey::svymean(~income, na.rm = TRUE),   estimation_type = \"annual\" )  result_semester #>                       stat    value       se         cv confint_lower #>                     <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: income 44574.23 2226.844 0.04995811      40209.69 #> 2: survey::svymean: income 44341.53 2407.912 0.05430377      39622.10 #> 3: survey::svymean: income 41293.92 2239.968 0.05424451      36903.66 #> 4: survey::svymean: income 41760.06 2296.170 0.05498485      37259.64 #> 5: survey::svymean: income 48051.67 2374.145 0.04940816      43398.43 #> 6: survey::svymean: income 42721.21 2276.767 0.05329359      38258.83 #>    confint_upper period   type variance #>            <num>  <num> <char>    <num> #> 1:      48938.76   2023     q1  4958836 #> 2:      49060.95   2023     q1  5798041 #> 3:      45684.18   2023     q1  5017458 #> 4:      46260.47   2023     q2  5272399 #> 5:      52704.90   2023     q2  5636562 #> 6:      47183.59   2023     q2  5183666"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"extracción-de-encuestas-desde-paneles","dir":"Articles","previous_headings":"","what":"Extracción de encuestas desde paneles","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Utilice extract_surveys() para seleccionar períodos específicos de un RotativePanelSurvey:","code":"# Extract specific follow-ups by index first_two <- extract_surveys(panel, index = 1:2) class(first_two) #> [1] \"list\" # Extract by month (requires Date-format editions) march_data <- extract_surveys(panel, monthly = 3)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"patrones-temporales","dir":"Articles","previous_headings":"","what":"Patrones temporales","title":"Paneles Rotativos y PoolSurvey (ES)","text":"metasurvey proporciona utilidades para trabajar con las fechas de edición de las encuestas:","code":"# Extract periodicity from edition strings extract_time_pattern(\"2023\") #> $year #> [1] 2023 #>  #> $periodicity #> [1] \"Annual\" extract_time_pattern(\"2023-06\") #> $year #> [1] 2023 #>  #> $month #> [1] 6 #>  #> $periodicity #> [1] \"Monthly\" # Validate edition format validate_time_pattern(svy_type = \"ech\", svy_edition = \"2023\") #> $svy_type #> [1] \"ech\" #>  #> $svy_edition #> [1] 2023 #>  #> $svy_periodicity #> [1] \"Annual\" # Group dates by period dates <- as.Date(c(   \"2023-01-15\", \"2023-03-20\", \"2023-06-10\",   \"2023-09-05\", \"2023-11-30\" )) group_dates(dates, type = \"quarterly\") #> 2023-01-15 2023-03-20 2023-06-10 2023-09-05 2023-11-30  #>          1          1          2          3          4 group_dates(dates, type = \"biannual\") #> 2023-01-15 2023-03-20 2023-06-10 2023-09-05 2023-11-30  #>          1          1          1          2          2"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"carga-de-datos-de-panel-desde-archivos","dir":"Articles","previous_headings":"","what":"Carga de datos de panel desde archivos","title":"Paneles Rotativos y PoolSurvey (ES)","text":"En la práctica, los datos de panel se cargan desde archivos utilizando load_panel_survey():","code":"panel <- load_panel_survey(   path_implantation = \"data/ECH_implantacion_2023.csv\",   path_follow_up = \"data/seguimiento/\",   svy_type = \"ech\",   svy_weight_implantation = add_weight(annual = \"pesoano\"),   svy_weight_follow_up = add_weight(monthly = \"pesomes\") )  # Access components imp <- get_implantation(panel) fups <- get_follow_up(panel)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"pesos-replicados-bootstrap","dir":"Articles","previous_headings":"","what":"Pesos replicados bootstrap","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Para encuestas que proveen pesos replicados bootstrap (como la ECH), utilice add_replicate() dentro de add_weight() para configurar la estimación robusta de la varianza: Cuando se configuran pesos replicados, workflow() utiliza automáticamente survey::svrepdesign() para la estimación de la varianza en lugar del enfoque estándar de linealización de Taylor.","code":"panel <- load_panel_survey(   path_implantation = \"data/ECH_implantacion_2023.csv\",   path_follow_up = \"data/seguimiento/\",   svy_type = \"ech\",   svy_weight_implantation = add_weight(     annual = add_replicate(       weight = \"pesoano\",       replicate_pattern = \"wr\\\\d+\",       replicate_path = \"data/pesos_replicados_anual.csv\",       replicate_id = c(\"numero\" = \"numero\"),       replicate_type = \"bootstrap\"     )   ),   svy_weight_follow_up = add_weight(monthly = \"pesomes\") )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"buenas-prácticas","dir":"Articles","previous_headings":"","what":"Buenas prácticas","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Establezca la periodicidad en cada encuesta componente antes de construir el panel Aplique las transformaciones de manera uniforme – asegúrese de que los mismos pasos se apliquen las encuestas de implantación y de seguimiento para garantizar la comparabilidad Utilice PoolSurvey cuando combine encuestas para reducir la varianza o para agregaciones trimestrales/anuales Valide los resultados – compare las estimaciones agrupadas con las estimaciones directas para verificar la consistencia Utilice pesos replicados bootstrap cuando estén disponibles para una estimación más robusta de la varianza","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis-es.html","id":"próximos-pasos","dir":"Articles","previous_headings":"","what":"Próximos pasos","title":"Paneles Rotativos y PoolSurvey (ES)","text":"Diseños de encuesta y validación – Estratificación, conglomerados y validación de pipelines Estudio de caso ECH – Análisis completo del mercado laboral con el panel rotativo de la ECH Flujos de estimación – workflow() y RecipeWorkflow","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Rotating Panels and PoolSurvey","text":"Many national household surveys use rotating panel designs, sample respondents interviewed initial wave (implantation) followed successive periods. Uruguay’s ECH, example, interviews household conducts monthly follow-ups rest year. metasurvey provides two classes type design: RotativePanelSurvey – panel implantation survey list follow-surveys PoolSurvey – collection surveys grouped together combined estimation across periods","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"creating-a-rotativepanelsurvey","dir":"Articles","previous_headings":"","what":"Creating a RotativePanelSurvey","title":"Rotating Panels and PoolSurvey","text":"RotativePanelSurvey requires implantation Survey one follow-Survey objects.","code":"library(metasurvey) library(data.table) set_use_copy(TRUE)  set.seed(42) n <- 100  make_survey <- function(edition) {   dt <- data.table(     id       = 1:n,     age      = sample(18:80, n, replace = TRUE),     income   = round(runif(n, 5000, 80000)),     employed = sample(0:1, n, replace = TRUE),     w        = round(runif(n, 0.5, 3.0), 4)   )   Survey$new(     data = dt, edition = edition, type = \"ech\",     psu = NULL, engine = \"data.table\",     weight = add_weight(annual = \"w\")   ) }  # Implantation: 2023 wave 1 impl <- make_survey(\"2023\")  # Follow-ups: waves 2 through 4 fu_2 <- make_survey(\"2023\") fu_3 <- make_survey(\"2023\") fu_4 <- make_survey(\"2023\")  panel <- RotativePanelSurvey$new(   implantation   = impl,   follow_up      = list(fu_2, fu_3, fu_4),   type           = \"ech\",   default_engine = \"data.table\",   steps          = list(),   recipes        = list(),   workflows      = list(),   design         = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"accessing-panel-components","dir":"Articles","previous_headings":"","what":"Accessing panel components","title":"Rotating Panels and PoolSurvey","text":"Use get_implantation() get_follow_up() retrieve individual surveys:","code":"# Implantation survey imp <- get_implantation(panel) class(imp) #> [1] \"Survey\" \"R6\" head(get_data(imp), 3) #>       id   age income employed      w #>    <int> <int>  <num>    <int>  <num> #> 1:     1    66  21287        1 1.6114 #> 2:     2    54  21243        0 0.6510 #> 3:     3    18  34171        1 1.3188 # Follow-up surveys follow_ups <- get_follow_up(panel) cat(\"Number of follow-ups:\", length(follow_ups), \"\\n\") #> Number of follow-ups: 3"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"applying-steps-to-panel-components","dir":"Articles","previous_headings":"","what":"Applying steps to panel components","title":"Rotating Panels and PoolSurvey","text":"Apply transformations individual panel components. step functions work implantation follow-surveys:","code":"# Transform the implantation survey panel$implantation <- step_compute(panel$implantation,   income_k = income / 1000,   comment = \"Income in thousands\" )  # Apply the same step to each follow-up panel$follow_up <- lapply(panel$follow_up, function(svy) {   step_compute(svy, income_k = income / 1000, comment = \"Income in thousands\") })"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"estimation-on-panel-components","dir":"Articles","previous_headings":"","what":"Estimation on panel components","title":"Rotating Panels and PoolSurvey","text":"Use workflow() individual panel components perform cross-sectional time-series analysis.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"cross-sectional-analysis-implantation","dir":"Articles","previous_headings":"Estimation on panel components","what":"Cross-sectional analysis (Implantation)","title":"Rotating Panels and PoolSurvey","text":"","code":"result_impl <- workflow(   list(panel$implantation),   survey::svymean(~income, na.rm = TRUE),   estimation_type = \"annual\" )  result_impl #>                       stat    value       se         cv confint_lower #>                     <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: income 43742.45 2420.706 0.05533997      38997.96 #>    confint_upper #>            <num> #> 1:      48486.95"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"comparison-across-follow-ups","dir":"Articles","previous_headings":"Estimation on panel components","what":"Comparison across follow-ups","title":"Rotating Panels and PoolSurvey","text":"","code":"results <- rbindlist(lapply(seq_along(panel$follow_up), function(i) {   r <- workflow(     list(panel$follow_up[[i]]),     survey::svymean(~income, na.rm = TRUE),     estimation_type = \"annual\"   )   r$period <- panel$follow_up[[i]]$edition   r }))  results[, .(period, stat, value, se, cv)] #>    period                    stat    value       se         cv #>     <num>                  <char>    <num>    <num>      <num> #> 1:   2023 survey::svymean: income 41537.99 2328.715 0.05606230 #> 2:   2023 survey::svymean: income 42809.39 2383.860 0.05568546 #> 3:   2023 survey::svymean: income 41314.46 2232.803 0.05404409"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"poolsurvey-combined-estimation","dir":"Articles","previous_headings":"","what":"PoolSurvey: Combined estimation","title":"Rotating Panels and PoolSurvey","text":"PoolSurvey groups multiple surveys combined estimation. useful want aggregate monthly data quarterly annual estimates, combining surveys reduces sampling variability. constructor takes nested list: list(estimation_type = list(group = list(surveys))).","code":"s1 <- make_survey(\"2023\") s2 <- make_survey(\"2023\") s3 <- make_survey(\"2023\")  pool <- PoolSurvey$new(   list(annual = list(\"q1\" = list(s1, s2, s3))) )  class(pool) #> [1] \"PoolSurvey\" \"R6\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"pooled-estimation","dir":"Articles","previous_headings":"PoolSurvey: Combined estimation","what":"Pooled estimation","title":"Rotating Panels and PoolSurvey","text":"","code":"pool_result <- workflow(   pool,   survey::svymean(~income, na.rm = TRUE),   estimation_type = \"annual\" )  pool_result #>                       stat    value       se         cv confint_lower #>                     <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: income 44574.23 2226.844 0.04995811      40209.69 #> 2: survey::svymean: income 44341.53 2407.912 0.05430377      39622.10 #> 3: survey::svymean: income 41293.92 2239.968 0.05424451      36903.66 #>    confint_upper period   type variance #>            <num>  <num> <char>    <num> #> 1:      48938.76   2023     q1  4958836 #> 2:      49060.95   2023     q1  5798041 #> 3:      45684.18   2023     q1  5017458"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"multiple-groups","dir":"Articles","previous_headings":"PoolSurvey: Combined estimation","what":"Multiple groups","title":"Rotating Panels and PoolSurvey","text":"Surveys can organized multiple groups:","code":"s4 <- make_survey(\"2023\") s5 <- make_survey(\"2023\") s6 <- make_survey(\"2023\")  pool_semester <- PoolSurvey$new(   list(annual = list(     \"q1\" = list(s1, s2, s3),     \"q2\" = list(s4, s5, s6)   )) )  result_semester <- workflow(   pool_semester,   survey::svymean(~income, na.rm = TRUE),   estimation_type = \"annual\" )  result_semester #>                       stat    value       se         cv confint_lower #>                     <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: income 44574.23 2226.844 0.04995811      40209.69 #> 2: survey::svymean: income 44341.53 2407.912 0.05430377      39622.10 #> 3: survey::svymean: income 41293.92 2239.968 0.05424451      36903.66 #> 4: survey::svymean: income 41760.06 2296.170 0.05498485      37259.64 #> 5: survey::svymean: income 48051.67 2374.145 0.04940816      43398.43 #> 6: survey::svymean: income 42721.21 2276.767 0.05329359      38258.83 #>    confint_upper period   type variance #>            <num>  <num> <char>    <num> #> 1:      48938.76   2023     q1  4958836 #> 2:      49060.95   2023     q1  5798041 #> 3:      45684.18   2023     q1  5017458 #> 4:      46260.47   2023     q2  5272399 #> 5:      52704.90   2023     q2  5636562 #> 6:      47183.59   2023     q2  5183666"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"extracting-surveys-from-panels","dir":"Articles","previous_headings":"","what":"Extracting surveys from panels","title":"Rotating Panels and PoolSurvey","text":"Use extract_surveys() select specific periods RotativePanelSurvey:","code":"# Extract specific follow-ups by index first_two <- extract_surveys(panel, index = 1:2) class(first_two) #> [1] \"list\" # Extract by month (requires Date-format editions) march_data <- extract_surveys(panel, monthly = 3)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"time-patterns","dir":"Articles","previous_headings":"","what":"Time patterns","title":"Rotating Panels and PoolSurvey","text":"metasurvey provides utilities working survey edition dates:","code":"# Extract periodicity from edition strings extract_time_pattern(\"2023\") #> $year #> [1] 2023 #>  #> $periodicity #> [1] \"Annual\" extract_time_pattern(\"2023-06\") #> $year #> [1] 2023 #>  #> $month #> [1] 6 #>  #> $periodicity #> [1] \"Monthly\" # Validate edition format validate_time_pattern(svy_type = \"ech\", svy_edition = \"2023\") #> $svy_type #> [1] \"ech\" #>  #> $svy_edition #> [1] 2023 #>  #> $svy_periodicity #> [1] \"Annual\" # Group dates by period dates <- as.Date(c(   \"2023-01-15\", \"2023-03-20\", \"2023-06-10\",   \"2023-09-05\", \"2023-11-30\" )) group_dates(dates, type = \"quarterly\") #> 2023-01-15 2023-03-20 2023-06-10 2023-09-05 2023-11-30  #>          1          1          2          3          4 group_dates(dates, type = \"biannual\") #> 2023-01-15 2023-03-20 2023-06-10 2023-09-05 2023-11-30  #>          1          1          1          2          2"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"loading-panel-data-from-files","dir":"Articles","previous_headings":"","what":"Loading panel data from files","title":"Rotating Panels and PoolSurvey","text":"practice, panel data loaded files using load_panel_survey():","code":"panel <- load_panel_survey(   path_implantation = \"data/ECH_implantacion_2023.csv\",   path_follow_up = \"data/seguimiento/\",   svy_type = \"ech\",   svy_weight_implantation = add_weight(annual = \"pesoano\"),   svy_weight_follow_up = add_weight(monthly = \"pesomes\") )  # Access components imp <- get_implantation(panel) fups <- get_follow_up(panel)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"bootstrap-replicate-weights","dir":"Articles","previous_headings":"","what":"Bootstrap replicate weights","title":"Rotating Panels and PoolSurvey","text":"surveys provide bootstrap replicate weights (ECH), use add_replicate() inside add_weight() configure robust variance estimation: replicate weights configured, workflow() automatically uses survey::svrepdesign() variance estimation instead standard Taylor linearization approach.","code":"panel <- load_panel_survey(   path_implantation = \"data/ECH_implantacion_2023.csv\",   path_follow_up = \"data/seguimiento/\",   svy_type = \"ech\",   svy_weight_implantation = add_weight(     annual = add_replicate(       weight = \"pesoano\",       replicate_pattern = \"wr\\\\d+\",       replicate_path = \"data/pesos_replicados_anual.csv\",       replicate_id = c(\"numero\" = \"numero\"),       replicate_type = \"bootstrap\"     )   ),   svy_weight_follow_up = add_weight(monthly = \"pesomes\") )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"best-practices","dir":"Articles","previous_headings":"","what":"Best practices","title":"Rotating Panels and PoolSurvey","text":"Set periodicity component survey building panel Apply transformations uniformly – ensure steps applied implantation follow-surveys guarantee comparability Use PoolSurvey combining surveys reduce variance quarterly/annual aggregations Validate results – compare pooled estimates direct estimates verify consistency Use bootstrap replicate weights available robust variance estimation","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/panel-analysis.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Rotating Panels and PoolSurvey","text":"Survey designs validation – Stratification, clustering, pipeline validation ECH case study – Complete labor market analysis ECH rotating panel Estimation workflows – workflow() RecipeWorkflow","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"por-qué-recipes","dir":"Articles","previous_headings":"","what":"¿Por qué Recipes?","title":"Creación y Compartición de Recipes (ES)","text":"Cualquier persona que trabaje con microdatos de encuestas de hogares conoce este patrón: se descargan los archivos sin procesar, se abre el libro de códigos y se pasan días recodificando la situación laboral, armonizando variables de ingreso y construyendo indicadores. Meses después, un colega comienza el mismo proyecto y escribe el mismo código desde cero. En STATA, los equipos comparten archivos ., pero estos están fuertemente acoplados rutas de archivos y nombres de variables específicos, y existe una forma estándar de descubrirlos o validarlos. Las Recipes son la respuesta de metasurvey este problema. Una recipe es una colección portable, documentada y validada de pasos de transformación que puede: Aplicarse cualquier edición compatible de una encuesta con una sola llamada función Publicarse en un registro donde otros pueden descubrirlas y reutilizarlas Ser certificada por instituciones para uso oficial Generar documentación automática de inputs, outputs y pipeline","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"ciclo-de-vida-de-una-recipe","dir":"Articles","previous_headings":"","what":"Ciclo de Vida de una Recipe","title":"Creación y Compartición de Recipes (ES)","text":"","code":"┌──────────────┐     ┌──────────────┐     ┌──────────────┐   │ 1. Desarrollar│────▶│ 2. Empaquetar │────▶│  3. Validar   │   │  steps sobre  │     │  steps en     │     │  contra datos │   │  una encuesta │     │  una recipe   │     │  nuevos       │   └──────────────┘     └──────────────┘     └──────┬───────┘                                                     │   ┌──────────────┐     ┌──────────────┐             │   │ 5. Descubrir  │◀────│ 4. Publicar   │◀────────────┘   │  y reutilizar │     │  en registro  │   │  recipes      │     │  o API        │   └──────────────┘     └──────────────┘"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"cargando-una-encuesta","dir":"Articles","previous_headings":"","what":"Cargando una Encuesta","title":"Creación y Compartición de Recipes (ES)","text":"El punto de partida típico es cargar una encuesta con load_survey(). Se pueden cargar datos de ejemplo o apuntar archivos propios:","code":"library(metasurvey)  # Cargar ECH 2022 con datos de ejemplo ech_2022 <- load_survey(   load_survey_example(\"ech\", \"ech_2022\"),   svy_type    = \"ech\",   svy_edition = \"2022\",   svy_weight  = add_weight(annual = \"pesoano\") )  # O cargar con recipes existentes del registry ech_2022 <- load_survey(   load_survey_example(\"ech\", \"ech_2022\"),   svy_type    = \"ech\",   svy_edition = \"2022\",   svy_weight  = add_weight(annual = \"pesoano\"),   recipes     = get_recipe(\"ech\", \"2022\") )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"construyendo-una-recipe-a-partir-de-steps","dir":"Articles","previous_headings":"","what":"Construyendo una Recipe a partir de Steps","title":"Creación y Compartición de Recipes (ES)","text":"El flujo de trabajo más común consiste en desarrollar las transformaciones de forma interactiva sobre una encuesta y luego convertir los steps registrados en una recipe.","code":"library(metasurvey) library(data.table)  set.seed(42) n <- 200  # Simular microdatos de encuesta (sustituto de load_survey) dt <- data.table(   id = 1:n,   age = sample(18:80, n, replace = TRUE),   sex = sample(c(1, 2), n, replace = TRUE),   income = round(runif(n, 5000, 80000)),   activity = sample(c(2, 3, 5, 6), n,     replace = TRUE,     prob = c(0.55, 0.05, 0.05, 0.35)   ),   weight = round(runif(n, 0.5, 3.0), 4) )  svy <- Survey$new(   data    = dt,   edition = \"2023\",   type    = \"ech\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"weight\") )  # Desarrollar transformaciones interactivamente svy <- step_compute(svy,   income_thousands = income / 1000,   employed = ifelse(activity == 2, 1L, 0L),   comment = \"Escalado de ingreso e indicador de empleo\" )  svy <- step_recode(svy, labor_status,   activity == 2 ~ \"Empleado\",   activity %in% 3:5 ~ \"Desempleado\",   activity %in% 6:8 ~ \"Inactivo\",   .default = \"Otro\",   comment = \"Clasificacion OIT de fuerza laboral\" )  svy <- step_recode(svy, age_group,   age < 25 ~ \"Joven\",   age < 45 ~ \"Adulto\",   age < 65 ~ \"Maduro\",   .default = \"Mayor\",   comment = \"Grupos etarios estandar\" )  # Convertir todos los steps a una recipe labor_recipe <- steps_to_recipe(   name        = \"Indicadores de Fuerza Laboral\",   user        = \"Equipo de Investigacion\",   svy         = svy,   description = \"Indicadores estandar de fuerza laboral segun definiciones OIT\",   steps       = get_steps(svy),   topic       = \"labor\" )  labor_recipe #>  #> ── Recipe: Indicadores de Fuerza Laboral ── #> Author:  Equipo de Investigacion #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:   labor #> Description: Indicadores estandar de fuerza laboral segun definiciones OIT #> Certification: community #>  #> ── Requires (3 variables) ── #>   income, activity, age #>  #> ── Pipeline (3 steps) ── #>   1. [compute] -> income_thousands, employed  \"Escalado de ingreso e indicador de empleo\" #>   2. [recode] -> labor_status  \"Clasificacion OIT de fuerza laboral\" #>   3. [recode] -> age_group  \"Grupos etarios estandar\" #>  #> ── Produces (4 variables) ── #>   labor_status [categorical], age_group [categorical], income_thousands [numeric], employed [numeric]"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"documentación-de-recipes","dir":"Articles","previous_headings":"","what":"Documentación de Recipes","title":"Creación y Compartición de Recipes (ES)","text":"Toda recipe puede generar automáticamente su documentación partir de sus steps. El método doc() devuelve una lista con las variables de entrada, las variables de salida y el pipeline paso paso: Esta documentación se genera automáticamente, sin necesidad de esfuerzo manual.","code":"doc <- labor_recipe$doc() names(doc) #> [1] \"meta\"             \"input_variables\"  \"output_variables\" \"pipeline\" # ¿Qué variables necesita la recipe? doc$input_variables #> [1] \"income\"   \"activity\" \"age\"  # ¿Qué variables crea? doc$output_variables #> [1] \"income_thousands\" \"employed\"         \"labor_status\"     \"age_group\"  # Pipeline paso a paso doc$pipeline #> [[1]] #> [[1]]$index #> [1] 1 #>  #> [[1]]$type #> [1] \"compute\" #>  #> [[1]]$outputs #> [1] \"income_thousands\" \"employed\"         #>  #> [[1]]$inputs #> [1] \"income\"   \"activity\" #>  #> [[1]]$inferred_type #> [1] \"numeric\" #>  #> [[1]]$comment #> [1] \"Escalado de ingreso e indicador de empleo\" #>  #>  #> [[2]] #> [[2]]$index #> [1] 2 #>  #> [[2]]$type #> [1] \"recode\" #>  #> [[2]]$outputs #> [1] \"labor_status\" #>  #> [[2]]$inputs #> [1] \"activity\" #>  #> [[2]]$inferred_type #> [1] \"categorical\" #>  #> [[2]]$comment #> [1] \"Clasificacion OIT de fuerza laboral\" #>  #>  #> [[3]] #> [[3]]$index #> [1] 3 #>  #> [[3]]$type #> [1] \"recode\" #>  #> [[3]]$outputs #> [1] \"age_group\" #>  #> [[3]]$inputs #> [1] \"age\" #>  #> [[3]]$inferred_type #> [1] \"categorical\" #>  #> [[3]]$comment #> [1] \"Grupos etarios estandar\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"validación","dir":"Articles","previous_headings":"","what":"Validación","title":"Creación y Compartición de Recipes (ES)","text":"Antes de aplicar una recipe nuevos datos, es conveniente verificar que todas las variables requeridas existan. El método validate() se detiene con un error claro si falta alguna dependencia:","code":"labor_recipe$validate(svy) #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"aplicación-de-recipes-a-una-encuesta","dir":"Articles","previous_headings":"","what":"Aplicación de Recipes a una Encuesta","title":"Creación y Compartición de Recipes (ES)","text":"Se pueden adjuntar una o más recipes una encuesta y aplicarlas con bake_recipes(): La misma recipe aplicada una edición diferente produce resultados consistentes. Así es como metasurvey garantiza la reproducibilidad lo largo del tiempo. En la práctica, se puede cargar una encuesta y aplicar recipes publicadas en una sola llamada:","code":"# Crear una encuesta nueva con la misma estructura (simulando una nueva edición) set.seed(99) dt2 <- data.table(   id = 1:100,   age = sample(18:80, 100, replace = TRUE),   sex = sample(c(1, 2), 100, replace = TRUE),   income = round(runif(100, 5000, 80000)),   activity = sample(c(2, 3, 5, 6), 100,     replace = TRUE,     prob = c(0.55, 0.05, 0.05, 0.35)   ),   weight = round(runif(100, 0.5, 3.0), 4) )  svy2 <- Survey$new(   data = dt2, edition = \"2024\", type = \"ech\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"weight\") )  # Adjuntar y aplicar svy2 <- add_recipe(svy2, labor_recipe) svy2 <- bake_recipes(svy2)  head(get_data(svy2)[, .(id, income_thousands, labor_status, age_group)], 5) #>       id income_thousands labor_status age_group #>    <int>            <num>       <char>    <char> #> 1:     1           47.346  Desempleado     Mayor #> 2:     2           28.114     Empleado    Maduro #> 3:     3           43.583     Empleado    Maduro #> 4:     4           13.440  Desempleado    Maduro #> 5:     5           55.638     Empleado     Mayor # Cargar ECH 2023 y aplicar la recipe laboral del registry ech_2023 <- load_survey(   load_survey_example(\"ech\", \"ech_2023\"),   svy_type    = \"ech\",   svy_edition = \"2023\",   svy_weight  = add_weight(annual = \"pesoano\"),   recipes     = get_recipe(\"ech\", \"2023\", topic = \"labor_market\"),   bake        = TRUE )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"categorías","dir":"Articles","previous_headings":"","what":"Categorías","title":"Creación y Compartición de Recipes (ES)","text":"Las categorías ayudan organizar las recipes por tema: Agregar categorías una recipe con add_category():","code":"cats <- default_categories() vapply(cats, function(c) c$name, character(1)) #> [1] \"labor_market\" \"income\"       \"education\"    \"health\"       \"demographics\" #> [6] \"housing\" labor_recipe <- add_category(labor_recipe, \"labor_market\", \"Analisis del mercado laboral\") labor_recipe <- add_category(labor_recipe, \"income\", \"Indicadores de ingreso\") labor_recipe #>  #> ── Recipe: Indicadores de Fuerza Laboral ── #> Author:  Equipo de Investigacion #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:   labor #> Description: Indicadores estandar de fuerza laboral segun definiciones OIT #> Certification: community #> Categories: labor_market, income #>  #> ── Requires (3 variables) ── #>   income, activity, age #>  #> ── Pipeline (3 steps) ── #>   1. [compute] -> income_thousands, employed  \"Escalado de ingreso e indicador de empleo\" #>   2. [recode] -> labor_status  \"Clasificacion OIT de fuerza laboral\" #>   3. [recode] -> age_group  \"Grupos etarios estandar\" #>  #> ── Produces (4 variables) ── #>   labor_status [categorical], age_group [categorical], income_thousands [numeric], employed [numeric]"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"certificación","dir":"Articles","previous_headings":"","what":"Certificación","title":"Creación y Compartición de Recipes (ES)","text":"El sistema de certificación ofrece tres niveles de confianza: Los niveles de certificación más altos aparecen primero en los resultados de búsqueda e indican que la recipe ha sido revisada.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"publicación-y-descubrimiento-de-recipes","dir":"Articles","previous_headings":"","what":"Publicación y Descubrimiento de Recipes","title":"Creación y Compartición de Recipes (ES)","text":"El verdadero poder de las recipes radica en compartirlas. Cada recipe que crees puede ser publicada en el registry de metasurvey, donde otros investigadores pueden descubrirla, reutilizarla y construir sobre tu trabajo.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"publicar-en-el-registry-público","dir":"Articles","previous_headings":"Publicación y Descubrimiento de Recipes","what":"Publicar en el Registry Público","title":"Creación y Compartición de Recipes (ES)","text":"El flujo recomendado es publicar las recipes en la API pública. Cualquier persona puede explorar recipes sin cuenta; para publicar se necesita registro: Al estar autenticado, api_publish_recipe() adjunta automáticamente tu perfil de usuario la recipe. Los demás usuarios ven quién la publicó, junto con la afiliación institucional y el nivel de certificación. Esto genera responsabilidad y confianza en las recipes compartidas.","code":"# Una sola vez: registrarse y autenticarse api_register(\"Tu Nombre\", \"tu@email.com\", \"password\") api_login(\"tu@email.com\", \"password\")  # Publicar tu recipe (tu perfil se adjunta automáticamente) api_publish_recipe(labor_recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"exploración-y-búsqueda","dir":"Articles","previous_headings":"Publicación y Descubrimiento de Recipes","what":"Exploración y Búsqueda","title":"Creación y Compartición de Recipes (ES)","text":"se necesita autenticación para explorar y descargar recipes:","code":"# Explorar todas las recipes de la ECH ech_recipes <- api_list_recipes(survey_type = \"ech\")  # Obtener una recipe por ID r <- api_get_recipe(id = \"recipe_id_aqui\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"explorador-interactivo","dir":"Articles","previous_headings":"Publicación y Descubrimiento de Recipes","what":"Explorador Interactivo","title":"Creación y Compartición de Recipes (ES)","text":"La app Shiny provee una interfaz visual para explorar recipes y workflows: El explorador muestra tarjetas de recipes con badges de certificacion, conteo de descargas y preview del pipeline. Al hacer clic en una recipe se abre una vista de detalle con el pipeline completo, snippet de codigo R y links workflows relacionados.","code":"explore_recipes()"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"registry-privado-para-instituciones","dir":"Articles","previous_headings":"Publicación y Descubrimiento de Recipes","what":"Registry Privado para Instituciones","title":"Creación y Compartición de Recipes (ES)","text":"Las instituciones que trabajan con encuestas confidenciales o de acceso restringido pueden necesitar un registry privado. metasurvey soporta esto mediante un backend propio con MongoDB: Consulta la vignette API y Base de Datos para instrucciones sobre cómo desplegar la API Plumber con MongoDB para tu propia organización.","code":"# Apuntar a la API privada de tu institución configure_api(\"https://tu-institucion.example.com/api\")  # A partir de aquí, el flujo es idéntico api_login(\"analista@institucion.edu\", \"password\") api_publish_recipe(labor_recipe) api_list_recipes(survey_type = \"ech\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"buenas-prácticas","dir":"Articles","previous_headings":"","what":"Buenas Prácticas","title":"Creación y Compartición de Recipes (ES)","text":"Nombrar las recipes de forma descriptiva – incluir el tipo de encuesta y el tema (por ejemplo, \"ECH Indicadores de Fuerza Laboral\"). Agregar descripciones – documentar qué calcula la recipe y por qué. Usar categorías y temas – facilitar que las recipes sean descubribles. Validar antes de compartir – llamar validate() sobre datos de ejemplo para asegurar que todas las dependencias existan. Versionar las recipes – usar set_version() al actualizarlas.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes-es.html","id":"próximos-pasos","dir":"Articles","previous_headings":"","what":"Próximos Pasos","title":"Creación y Compartición de Recipes (ES)","text":"Flujos de Estimación – Usar workflow() para calcular estimaciones ponderadas partir de los datos procesados Caso de Estudio ECH – Ver recipes en acción en un análisis real del mercado laboral Primeros Pasos – Revisar los conceptos básicos de steps y objetos Survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"why-recipes","dir":"Articles","previous_headings":"","what":"Why Recipes?","title":"Creating and Sharing Recipes","text":"Anyone works household survey microdata knows pattern: download raw files, open codebook, spend days recoding employment status, harmonizing income variables, building indicators. Months later, colleague starts project writes code scratch. STATA, teams share .files, tightly coupled specific file paths variable names, standard way discover validate . Recipes metasurvey’s answer problem. recipe portable, documented, validated collection transformation steps can: applied compatible edition survey single function call published registry others can discover reuse certified institutions official use Generate automatic documentation inputs, outputs, pipeline","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"recipe-lifecycle","dir":"Articles","previous_headings":"","what":"Recipe Lifecycle","title":"Creating and Sharing Recipes","text":"","code":"┌──────────────┐     ┌──────────────┐     ┌──────────────┐   │  1. Develop   │────▶│  2. Package   │────▶│  3. Validate  │   │  steps on a   │     │  steps into   │     │  against new  │   │  survey       │     │  a recipe     │     │  data         │   └──────────────┘     └──────────────┘     └──────┬───────┘                                                     │   ┌──────────────┐     ┌──────────────┐             │   │  5. Discover  │◀────│  4. Publish   │◀────────────┘   │  & reuse      │     │  to registry  │   │  recipes      │     │  or API       │   └──────────────┘     └──────────────┘"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"loading-a-survey","dir":"Articles","previous_headings":"","what":"Loading a Survey","title":"Creating and Sharing Recipes","text":"typical starting point loading survey load_survey(). can load example data point files:","code":"library(metasurvey)  # Load ECH 2022 with example data (downloads from GitHub) ech_2022 <- load_survey(   load_survey_example(\"ech\", \"ech_2022\"),   svy_type    = \"ech\",   svy_edition = \"2022\",   svy_weight  = add_weight(annual = \"pesoano\") )  # Or load with existing recipes from the registry (requires API server) ech_2022 <- load_survey(   load_survey_example(\"ech\", \"ech_2022\"),   svy_type    = \"ech\",   svy_edition = \"2022\",   svy_weight  = add_weight(annual = \"pesoano\"),   recipes     = get_recipe(\"ech\", \"2022\") )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"building-a-recipe-from-steps","dir":"Articles","previous_headings":"","what":"Building a Recipe from Steps","title":"Creating and Sharing Recipes","text":"common workflow consists developing transformations interactively survey converting recorded steps recipe.","code":"library(metasurvey) library(data.table)  set.seed(42) n <- 200  # Simulate survey microdata (standing in for load_survey) dt <- data.table(   id = 1:n,   age = sample(18:80, n, replace = TRUE),   sex = sample(c(1, 2), n, replace = TRUE),   income = round(runif(n, 5000, 80000)),   activity = sample(c(2, 3, 5, 6), n,     replace = TRUE,     prob = c(0.55, 0.05, 0.05, 0.35)   ),   weight = round(runif(n, 0.5, 3.0), 4) )  svy <- Survey$new(   data    = dt,   edition = \"2023\",   type    = \"ech\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"weight\") )  # Develop transformations interactively svy <- step_compute(svy,   income_thousands = income / 1000,   employed = ifelse(activity == 2, 1L, 0L),   comment = \"Income scaling and employment indicator\" )  svy <- step_recode(svy, labor_status,   activity == 2 ~ \"Employed\",   activity %in% 3:5 ~ \"Unemployed\",   activity %in% 6:8 ~ \"Inactive\",   .default = \"Other\",   comment = \"ILO labor force classification\" )  svy <- step_recode(svy, age_group,   age < 25 ~ \"Youth\",   age < 45 ~ \"Adult\",   age < 65 ~ \"Mature\",   .default = \"Senior\",   comment = \"Standard age groups\" )  # Convert all steps to a recipe labor_recipe <- steps_to_recipe(   name        = \"Labor Force Indicators\",   user        = \"Research Team\",   svy         = svy,   description = \"Standard labor force indicators following ILO definitions\",   steps       = get_steps(svy),   topic       = \"labor\" )  labor_recipe #>  #> ── Recipe: Labor Force Indicators ── #> Author:  Research Team #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:   labor #> Description: Standard labor force indicators following ILO definitions #> Certification: community #>  #> ── Requires (3 variables) ── #>   income, activity, age #>  #> ── Pipeline (3 steps) ── #>   1. [compute] -> income_thousands, employed  \"Income scaling and employment indicator\" #>   2. [recode] -> labor_status  \"ILO labor force classification\" #>   3. [recode] -> age_group  \"Standard age groups\" #>  #> ── Produces (4 variables) ── #>   labor_status [categorical], age_group [categorical], income_thousands [numeric], employed [numeric]"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"recipe-documentation","dir":"Articles","previous_headings":"","what":"Recipe Documentation","title":"Creating and Sharing Recipes","text":"Every recipe can automatically generate documentation steps. doc() method returns list input variables, output variables, step--step pipeline: documentation generated automatically, manual effort required.","code":"doc <- labor_recipe$doc() names(doc) #> [1] \"meta\"             \"input_variables\"  \"output_variables\" \"pipeline\" # What variables does the recipe need? doc$input_variables #> [1] \"income\"   \"activity\" \"age\"  # What variables does it create? doc$output_variables #> [1] \"income_thousands\" \"employed\"         \"labor_status\"     \"age_group\"  # Step-by-step pipeline doc$pipeline #> [[1]] #> [[1]]$index #> [1] 1 #>  #> [[1]]$type #> [1] \"compute\" #>  #> [[1]]$outputs #> [1] \"income_thousands\" \"employed\"         #>  #> [[1]]$inputs #> [1] \"income\"   \"activity\" #>  #> [[1]]$inferred_type #> [1] \"numeric\" #>  #> [[1]]$comment #> [1] \"Income scaling and employment indicator\" #>  #>  #> [[2]] #> [[2]]$index #> [1] 2 #>  #> [[2]]$type #> [1] \"recode\" #>  #> [[2]]$outputs #> [1] \"labor_status\" #>  #> [[2]]$inputs #> [1] \"activity\" #>  #> [[2]]$inferred_type #> [1] \"categorical\" #>  #> [[2]]$comment #> [1] \"ILO labor force classification\" #>  #>  #> [[3]] #> [[3]]$index #> [1] 3 #>  #> [[3]]$type #> [1] \"recode\" #>  #> [[3]]$outputs #> [1] \"age_group\" #>  #> [[3]]$inputs #> [1] \"age\" #>  #> [[3]]$inferred_type #> [1] \"categorical\" #>  #> [[3]]$comment #> [1] \"Standard age groups\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"validation","dir":"Articles","previous_headings":"","what":"Validation","title":"Creating and Sharing Recipes","text":"applying recipe new data, verify required variables exist. validate() method stops clear error dependency missing:","code":"labor_recipe$validate(svy) #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"applying-recipes-to-a-survey","dir":"Articles","previous_headings":"","what":"Applying Recipes to a Survey","title":"Creating and Sharing Recipes","text":"Attach one recipes survey apply bake_recipes(): recipe applied different edition produces consistent results. metasurvey ensures reproducibility time. practice, can load survey apply published recipes single call:","code":"# Create a fresh survey with same structure (simulating a new edition) set.seed(99) dt2 <- data.table(   id = 1:100,   age = sample(18:80, 100, replace = TRUE),   sex = sample(c(1, 2), 100, replace = TRUE),   income = round(runif(100, 5000, 80000)),   activity = sample(c(2, 3, 5, 6), 100,     replace = TRUE,     prob = c(0.55, 0.05, 0.05, 0.35)   ),   weight = round(runif(100, 0.5, 3.0), 4) )  svy2 <- Survey$new(   data = dt2, edition = \"2024\", type = \"ech\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"weight\") )  # Attach and bake svy2 <- add_recipe(svy2, labor_recipe) svy2 <- bake_recipes(svy2)  head(get_data(svy2)[, .(id, income_thousands, labor_status, age_group)], 5) #>       id income_thousands labor_status age_group #>    <int>            <num>       <char>    <char> #> 1:     1           47.346   Unemployed    Senior #> 2:     2           28.114     Employed    Mature #> 3:     3           43.583     Employed    Mature #> 4:     4           13.440   Unemployed    Mature #> 5:     5           55.638     Employed    Senior # Load ECH 2023 and apply the labor recipe from the registry (requires API) ech_2023 <- load_survey(   load_survey_example(\"ech\", \"ech_2023\"),   svy_type    = \"ech\",   svy_edition = \"2023\",   svy_weight  = add_weight(annual = \"pesoano\"),   recipes     = get_recipe(\"ech\", \"2023\", topic = \"labor_market\"),   bake        = TRUE )"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"categories","dir":"Articles","previous_headings":"","what":"Categories","title":"Creating and Sharing Recipes","text":"Categories help organize recipes topic: Add categories recipe using add_category():","code":"cats <- default_categories() vapply(cats, function(c) c$name, character(1)) #> [1] \"labor_market\" \"income\"       \"education\"    \"health\"       \"demographics\" #> [6] \"housing\" labor_recipe <- add_category(labor_recipe, \"labor_market\", \"Labor market analysis\") labor_recipe <- add_category(labor_recipe, \"income\", \"Income-related indicators\") labor_recipe #>  #> ── Recipe: Labor Force Indicators ── #> Author:  Research Team #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:   labor #> Description: Standard labor force indicators following ILO definitions #> Certification: community #> Categories: labor_market, income #>  #> ── Requires (3 variables) ── #>   income, activity, age #>  #> ── Pipeline (3 steps) ── #>   1. [compute] -> income_thousands, employed  \"Income scaling and employment indicator\" #>   2. [recode] -> labor_status  \"ILO labor force classification\" #>   3. [recode] -> age_group  \"Standard age groups\" #>  #> ── Produces (4 variables) ── #>   labor_status [categorical], age_group [categorical], income_thousands [numeric], employed [numeric]"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"certification","dir":"Articles","previous_headings":"","what":"Certification","title":"Creating and Sharing Recipes","text":"certification system offers three levels trust: Higher certification levels appear first search results signal recipe reviewed.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"publishing-and-discovering-recipes","dir":"Articles","previous_headings":"","what":"Publishing and Discovering Recipes","title":"Creating and Sharing Recipes","text":"real power recipes lies sharing . Every recipe create can published metasurvey registry, researchers can discover, reuse, build upon work.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"publishing-to-the-public-registry","dir":"Articles","previous_headings":"Publishing and Discovering Recipes","what":"Publishing to the Public Registry","title":"Creating and Sharing Recipes","text":"recommended workflow publish recipes public API. Anyone can browse recipes without account; publishing requires registration: authenticated, api_publish_recipe() attaches user profile recipe. users see published , along institutional affiliation certification level. builds accountability trust shared recipes.","code":"# One-time: register and authenticate api_register(\"Your Name\", \"you@example.com\", \"password\") api_login(\"you@example.com\", \"password\")  # Publish your recipe (your profile is attached automatically) api_publish_recipe(labor_recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"browsing-and-searching","dir":"Articles","previous_headings":"Publishing and Discovering Recipes","what":"Browsing and Searching","title":"Creating and Sharing Recipes","text":"authentication needed browse download recipes:","code":"# Browse all ECH recipes ech_recipes <- api_list_recipes(survey_type = \"ech\")  # Get a specific recipe by ID r <- api_get_recipe(id = \"recipe_id_here\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"interactive-explorer","dir":"Articles","previous_headings":"Publishing and Discovering Recipes","what":"Interactive Explorer","title":"Creating and Sharing Recipes","text":"Shiny app provides visual interface browsing recipes workflows: explorer shows recipe cards certification badges, download counts, pipeline previews. Clicking recipe opens detail view full pipeline, R code snippet, links related workflows.","code":"explore_recipes()"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"private-registry-for-institutions","dir":"Articles","previous_headings":"Publishing and Discovering Recipes","what":"Private Registry for Institutions","title":"Creating and Sharing Recipes","text":"Institutions work confidential restricted-access surveys may need private registry. metasurvey supports via self-hosted backend MongoDB: See API Database vignette instructions deploying Plumber API MongoDB organization.","code":"# Point to your institution's private API configure_api(\"https://your-institution.example.com/api\")  # From here, the workflow is identical api_login(\"analyst@institution.edu\", \"password\") api_publish_recipe(labor_recipe) api_list_recipes(survey_type = \"ech\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"best-practices","dir":"Articles","previous_headings":"","what":"Best Practices","title":"Creating and Sharing Recipes","text":"Name recipes descriptively – include survey type topic (e.g., \"ECH Labor Force Indicators\"). Add descriptions – document recipe computes . Use categories topics – make recipes easier discover. Validate sharing – call validate() sample data ensure dependencies exist. Version recipes – use set_version() updating .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/recipes.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Creating and Sharing Recipes","text":"Estimation Workflows – Use workflow() compute weighted estimates processed data ECH Case Study – See recipes action real labor market analysis Getting Started – Review basics steps Survey objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"descripcion-general","dir":"Articles","previous_headings":"","what":"Descripcion general","title":"Guia de Self-Hosting (ES)","text":"Muchas organizaciones publican indicadores estadisticos derivados de encuestas (tasas de desempleo, pobreza, innovacion) sin mostrar como fueron calculados. El numero final es publico, pero la metodologia – que variables se usaron, que transformaciones se aplicaron, que diseno muestral se uso – queda oculta. metasurvey resuelve esto separando los datos privados de la metodologia publica. Se despliega la API de metasurvey en tu propia infraestructura donde: Los microdatos son privados: los archivos de la encuesta nunca salen de tu red. Los indicadores son publicos: los resultados (estimaciones puntuales, errores estandar, intervalos de confianza) se sirven via la API. La metodologia es transparente: cualquiera puede consultar la receta (pasos de transformacion) y el workflow (llamadas de estimacion y diseno muestral) que produjo cada indicador. La cadena de trazabilidad es:","code":"Indicador                 Workflow                      Receta (el numero)        -->    (como se estimo)          --> (como se construyeron las variables) value: 0.082              svymean(~pd, design)          step_compute(svy, pd = ...) se: 0.003                 estimation_type: annual       step_recode(svy, pea, ...) cv: 0.037                 recipe_ids: [ech_emp_001]     depends_on: [e27, f66, ...]"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"arquitectura","dir":"Articles","previous_headings":"","what":"Arquitectura","title":"Guia de Self-Hosting (ES)","text":"El sistema tiene dos servicios R: una API publica que sirve indicadores y su trazabilidad, y un Worker privado que tiene metasurvey instalado y acceso los microdatos. El worker es el unico componente que toca los datos crudos de la encuesta. Infraestructura de self-hosting de metasurvey Separacion clave: El Worker carga los microdatos, busca las recetas en MongoDB, las aplica (bake_steps), ejecuta la estimacion (workflow), y publica el resultado en la API. La API publica nunca toca los microdatos – solo sirve indicadores pre-computados y su trazabilidad. El frontend tambien puede solicitar estimaciones bajo demanda con filtros (ej., “tasa de desempleo para mujeres en Montevideo”) via POST /indicators/compute, que la API delega al Worker.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"inicio-rapido-con-docker-compose","dir":"Articles","previous_headings":"","what":"Inicio rapido con Docker Compose","title":"Guia de Self-Hosting (ES)","text":"El repositorio incluye un docker-compose.yml que levanta MongoDB, la API plumber y el explorador Shiny de recetas. se necesita base de datos externa.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"clonar-y-configurar","dir":"Articles","previous_headings":"Inicio rapido con Docker Compose","what":"1. Clonar y configurar","title":"Guia de Self-Hosting (ES)","text":"Crear un archivo .env (o usar los valores por defecto para desarrollo):","code":"git clone https://github.com/metasurveyr/metasurvey.git cd metasurvey # .env MONGO_USER=metasurvey MONGO_PASSWORD=cambiar-en-produccion METASURVEY_JWT_SECRET=cambiar-en-produccion METASURVEY_ADMIN_EMAIL=admin@example.com"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"levantar-el-stack","dir":"Articles","previous_headings":"Inicio rapido con Docker Compose","what":"2. Levantar el stack","title":"Guia de Self-Hosting (ES)","text":"Esto inicia cuatro servicios:","code":"docker compose up --build"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"inicializar-la-base-de-datos","dir":"Articles","previous_headings":"Inicio rapido con Docker Compose","what":"3. Inicializar la base de datos","title":"Guia de Self-Hosting (ES)","text":"","code":"# Crear colecciones e indices docker compose exec mongo mongosh \\   -u metasurvey -p cambiar-en-produccion \\   --authenticationDatabase admin \\   metasurvey /dev/stdin < inst/scripts/setup_mongodb.js  # Cargar recetas, workflows e indicadores de ejemplo docker compose exec api Rscript -e '   Sys.setenv(     METASURVEY_MONGO_URI = \"mongodb://metasurvey:cambiar-en-produccion@mongo:27017/?authSource=admin\"   )   source(\"/app/seed_ech_recipes.R\") '"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"verificar","dir":"Articles","previous_headings":"Inicio rapido con Docker Compose","what":"4. Verificar","title":"Guia de Self-Hosting (ES)","text":"","code":"curl http://localhost:8787/health {   \"status\": \"ok\",   \"service\": \"metasurvey-api\",   \"mongodb\": \"connected\" }"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"calcular-y-publicar-indicadores","dir":"Articles","previous_headings":"","what":"Calcular y publicar indicadores","title":"Guia de Self-Hosting (ES)","text":"El flujo tipico: cargar datos de la encuesta, aplicar una receta, ejecutar un workflow y publicar el resultado como indicador con trazabilidad completa. Publicar el indicador en la API:","code":"library(metasurvey)  # 1. Cargar datos de la encuesta (privado -- se queda en tu servidor) svy <- Survey$new(   data = my_survey_data,   edition = \"2024\",   type = \"ech\",   engine = \"data.table\",   weight = add_weight(annual = \"W_ANO\") )  # 2. Aplicar una receta (define variables como estado de desempleo) svy <- step_compute(svy,   pd = data.table::fcase(     pobpcoac == 2, 1L,     pobpcoac %in% c(1, 3), 0L   ),   comment = \"Desocupado: POBPCOAC == 2\" ) svy <- bake_steps(svy)  # 3. Ejecutar la estimacion (workflow) result <- workflow(   svy = list(svy),   survey::svymean(~pd, na.rm = TRUE),   estimation_type = \"annual\" )  # result es un data.table: #       stat      value     se     cv # svymean: pd    0.082  0.003  0.037 # Conectar a la API local configure_api(\"http://localhost:8787\") api_login(\"admin@example.com\", \"tu-password\")  # Construir el payload del indicador indicator <- list(   name = \"Tasa de desempleo 2024\",   description = \"Tasa de desempleo anual, poblacion de 14 y mas\",   recipe_id = \"ech_employment_001\",   workflow_id = \"ech_wf_labor\",   survey_type = \"ech\",   edition = \"2024\",   estimation_type = \"annual\",   stat = result$stat[1],   value = result$value[1],   se = result$se[1],   cv = result$cv[1],   confint_lower = result$confint_lower[1],   confint_upper = result$confint_upper[1],   metadata = list(     formula = \"~pd\",     estimation_function = \"svymean\"   ) )  # Publicar (requiere autenticacion) resp <- httr2::request(\"http://localhost:8787/indicators\") |>   httr2::req_headers(     Authorization = paste(\"Bearer\", Sys.getenv(\"METASURVEY_TOKEN\"))   ) |>   httr2::req_body_json(indicator) |>   httr2::req_perform()  httr2::resp_body_json(resp) # {ok: true, id: \"ind_1708099200_42\"}"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"consumir-indicadores-transparencia","dir":"Articles","previous_headings":"","what":"Consumir indicadores (transparencia)","title":"Guia de Self-Hosting (ES)","text":"Una vez publicados, los indicadores y su metodologia completa son accesibles sin autenticacion. Esta es la capa de transparencia.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"obtener-el-valor-del-indicador","dir":"Articles","previous_headings":"Consumir indicadores (transparencia)","what":"Obtener el valor del indicador","title":"Guia de Self-Hosting (ES)","text":"","code":"curl http://localhost:8787/indicators/ind_ech_unemployment_2024 {   \"ok\": true,   \"indicator\": {     \"id\": \"ind_ech_unemployment_2024\",     \"name\": \"Tasa de desempleo 2024\",     \"value\": 0.082,     \"se\": 0.003,     \"cv\": 0.037,     \"confint_lower\": 0.076,     \"confint_upper\": 0.088,     \"survey_type\": \"ech\",     \"edition\": \"2024\",     \"recipe_id\": \"ech_employment_001\",     \"workflow_id\": \"ech_wf_labor\"   } }"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"obtener-el-workflow-como-se-estimo","dir":"Articles","previous_headings":"Consumir indicadores (transparencia)","what":"Obtener el workflow (como se estimo)","title":"Guia de Self-Hosting (ES)","text":"El workflow indica que funcion estadistica se uso (svymean), que formula (~pd), y que recetas se aplicaron los datos antes de la estimacion.","code":"curl http://localhost:8787/indicators/ind_ech_unemployment_2024/workflow {   \"ok\": true,   \"indicator_id\": \"ind_ech_unemployment_2024\",   \"workflow\": {     \"id\": \"ech_wf_labor\",     \"name\": \"Mercado Laboral ECH\",     \"estimation_type\": \"annual\",     \"recipe_ids\": [\"ech_pobpcoac_000\", \"ech_employment_001\"],     \"calls\": [       \"svymean(~pea, design, na.rm=TRUE)\",       \"svymean(~po, design, na.rm=TRUE)\",       \"svymean(~pd, design, na.rm=TRUE)\"     ],     \"call_metadata\": [       {         \"type\": \"svymean\",         \"formula\": \"~pea\",         \"description\": \"Tasa de actividad\"       },       {         \"type\": \"svymean\",         \"formula\": \"~pd\",         \"description\": \"Tasa de desempleo\"       }     ]   } }"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"obtener-la-receta-como-se-construyeron-las-variables","dir":"Articles","previous_headings":"Consumir indicadores (transparencia)","what":"Obtener la receta (como se construyeron las variables)","title":"Guia de Self-Hosting (ES)","text":"La receta muestra exactamente como se construyo cada variable partir de las variables originales de la encuesta. Combinada con el workflow, cualquiera puede verificar la cadena completa de calculo sin acceder los microdatos.","code":"curl http://localhost:8787/indicators/ind_ech_unemployment_2024/recipe {   \"ok\": true,   \"indicator_id\": \"ind_ech_unemployment_2024\",   \"recipe\": {     \"id\": \"ech_employment_001\",     \"name\": \"Employment Status\",     \"steps\": [       \"step_compute(svy, po = fcase(pobpcoac == 1, 1L, TRUE, 0L), comment = 'Employed')\",       \"step_compute(svy, pd = fcase(pobpcoac == 2, 1L, TRUE, 0L), comment = 'Unemployed')\",       \"step_compute(svy, pea = fcase(pobpcoac %in% 1:2, 1L, TRUE, 0L), comment = 'EAP')\"     ],     \"depends_on\": [\"pobpcoac\"],     \"doc\": {       \"input_variables\": [\"pobpcoac\"],       \"output_variables\": [\"po\", \"pd\", \"pea\"],       \"pipeline\": [         {\"step\": 1, \"type\": \"compute\", \"outputs\": [\"po\"]},         {\"step\": 2, \"type\": \"compute\", \"outputs\": [\"pd\"]},         {\"step\": 3, \"type\": \"compute\", \"outputs\": [\"pea\"]}       ]     }   } }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"despliegue-con-minikube","dir":"Articles","previous_headings":"","what":"Despliegue con Minikube","title":"Guia de Self-Hosting (ES)","text":"Para despliegue local basado en Kubernetes, se puede usar Minikube.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"iniciar-minikube","dir":"Articles","previous_headings":"Despliegue con Minikube","what":"Iniciar Minikube","title":"Guia de Self-Hosting (ES)","text":"","code":"minikube start"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"deployment-de-mongodb","dir":"Articles","previous_headings":"Despliegue con Minikube","what":"Deployment de MongoDB","title":"Guia de Self-Hosting (ES)","text":"","code":"# k8s/mongo.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-mongo   namespace: metasurvey spec:   replicas: 1   selector:     matchLabels:       app: metasurvey-mongo   template:     metadata:       labels:         app: metasurvey-mongo     spec:       containers:         - name: mongo           image: mongo:7           ports:             - containerPort: 27017           env:             - name: MONGO_INITDB_ROOT_USERNAME               value: metasurvey             - name: MONGO_INITDB_ROOT_PASSWORD               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-password --- apiVersion: v1 kind: Service metadata:   name: mongo-service   namespace: metasurvey spec:   selector:     app: metasurvey-mongo   ports:     - port: 27017       targetPort: 27017"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"deployment-del-worker","dir":"Articles","previous_headings":"Despliegue con Minikube","what":"Deployment del Worker","title":"Guia de Self-Hosting (ES)","text":"","code":"# k8s/worker.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-worker   namespace: metasurvey spec:   replicas: 1   selector:     matchLabels:       app: metasurvey-worker   template:     metadata:       labels:         app: metasurvey-worker     spec:       containers:         - name: worker           image: ghcr.io/metasurveyr/metasurvey-worker:latest           ports:             - containerPort: 8788           env:             - name: METASURVEY_MONGO_URI               value: \"mongodb://metasurvey:$(MONGO_PASSWORD)@mongo-service:27017/?authSource=admin\"             - name: MONGO_PASSWORD               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-password           volumeMounts:             - name: survey-data               mountPath: /data/surveys               readOnly: true           resources:             requests:               memory: \"1Gi\"               cpu: \"500m\"             limits:               memory: \"4Gi\"               cpu: \"2000m\"       volumes:         - name: survey-data           persistentVolumeClaim:             claimName: survey-microdata-pvc --- apiVersion: v1 kind: Service metadata:   name: worker-service   namespace: metasurvey spec:   selector:     app: metasurvey-worker   ports:     - port: 8788       targetPort: 8788"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"deployment-de-la-api","dir":"Articles","previous_headings":"Despliegue con Minikube","what":"Deployment de la API","title":"Guia de Self-Hosting (ES)","text":"","code":"# k8s/api.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-api   namespace: metasurvey spec:   replicas: 2   selector:     matchLabels:       app: metasurvey-api   template:     metadata:       labels:         app: metasurvey-api     spec:       containers:         - name: api           image: ghcr.io/metasurveyr/metasurvey-api:latest           ports:             - containerPort: 8787           env:             - name: METASURVEY_MONGO_URI               value: \"mongodb://metasurvey:$(MONGO_PASSWORD)@mongo-service:27017/?authSource=admin\"             - name: MONGO_PASSWORD               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-password             - name: METASURVEY_JWT_SECRET               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: jwt-secret             - name: METASURVEY_WORKER_URL               value: \"http://worker-service:8788\"           livenessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 30           readinessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 10           resources:             requests:               memory: \"512Mi\"               cpu: \"250m\"             limits:               memory: \"1Gi\"               cpu: \"500m\" --- apiVersion: v1 kind: Service metadata:   name: metasurvey-api   namespace: metasurvey spec:   type: NodePort   selector:     app: metasurvey-api   ports:     - port: 8787       targetPort: 8787"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"aplicar-y-probar","dir":"Articles","previous_headings":"Despliegue con Minikube","what":"Aplicar y probar","title":"Guia de Self-Hosting (ES)","text":"","code":"kubectl create namespace metasurvey  kubectl create secret generic metasurvey-secrets \\   --namespace metasurvey \\   --from-literal=mongo-password=cambiar \\   --from-literal=jwt-secret=cambiar  kubectl apply -f k8s/mongo.yaml -f k8s/worker.yaml -f k8s/api.yaml  # Acceder a la API minikube service metasurvey-api -n metasurvey"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"despliegue-en-aws-eks","dir":"Articles","previous_headings":"","what":"Despliegue en AWS (EKS)","title":"Guia de Self-Hosting (ES)","text":"Para produccion en AWS se usa EKS con DocumentDB (MongoDB compatible) como base de datos gestionada.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"crear-el-cluster-eks","dir":"Articles","previous_headings":"Despliegue en AWS (EKS)","what":"1. Crear el cluster EKS","title":"Guia de Self-Hosting (ES)","text":"","code":"# Requiere: aws-cli, eksctl eksctl create cluster \\   --name metasurvey-prod \\   --region sa-east-1 \\   --node-type t3.medium \\   --nodes 2 \\   --nodes-min 1 \\   --nodes-max 5"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"crear-documentdb-mongodb-compatible","dir":"Articles","previous_headings":"Despliegue en AWS (EKS)","what":"2. Crear DocumentDB (MongoDB compatible)","title":"Guia de Self-Hosting (ES)","text":"","code":"aws docdb create-db-cluster \\   --db-cluster-identifier metasurvey-db \\   --engine docdb \\   --master-username metasurvey_admin \\   --master-user-password \"$DB_PASSWORD\" \\   --vpc-security-group-ids \"$SG_ID\" \\   --db-subnet-group-name \"$SUBNET_GROUP\"  aws docdb create-db-instance \\   --db-instance-identifier metasurvey-db-1 \\   --db-cluster-identifier metasurvey-db \\   --db-instance-class db.r6g.large \\   --engine docdb"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"configurar-secrets-en-kubernetes","dir":"Articles","previous_headings":"Despliegue en AWS (EKS)","what":"3. Configurar secrets en Kubernetes","title":"Guia de Self-Hosting (ES)","text":"","code":"aws eks update-kubeconfig --name metasurvey-prod --region sa-east-1  kubectl create namespace metasurvey  kubectl create secret generic metasurvey-secrets \\   --namespace metasurvey \\   --from-literal=mongo-uri=\"mongodb://metasurvey_admin:$DB_PASSWORD@metasurvey-db.cluster-xxx.sa-east-1.docdb.amazonaws.com:27017/?tls=true&tlsCAFile=/rds-combined-ca-bundle.pem&retryWrites=false\" \\   --from-literal=jwt-secret=\"$(openssl rand -hex 32)\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"deployment-con-alb-ingress","dir":"Articles","previous_headings":"Despliegue en AWS (EKS)","what":"4. Deployment con ALB Ingress","title":"Guia de Self-Hosting (ES)","text":"","code":"# k8s/aws-api.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-api   namespace: metasurvey spec:   replicas: 2   selector:     matchLabels:       app: metasurvey-api   template:     metadata:       labels:         app: metasurvey-api     spec:       containers:         - name: api           image: ghcr.io/metasurveyr/metasurvey-api:latest           ports:             - containerPort: 8787           env:             - name: METASURVEY_MONGO_URI               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-uri             - name: METASURVEY_JWT_SECRET               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: jwt-secret             - name: METASURVEY_WORKER_URL               value: \"http://worker-service:8788\"           resources:             requests:               memory: \"512Mi\"               cpu: \"250m\"             limits:               memory: \"1Gi\"               cpu: \"500m\"           livenessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 30           readinessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 10 --- apiVersion: v1 kind: Service metadata:   name: metasurvey-api   namespace: metasurvey spec:   type: ClusterIP   selector:     app: metasurvey-api   ports:     - port: 8787 --- apiVersion: networking.k8s.io/v1 kind: Ingress metadata:   name: metasurvey-ingress   namespace: metasurvey   annotations:     kubernetes.io/ingress.class: alb     alb.ingress.kubernetes.io/scheme: internet-facing     alb.ingress.kubernetes.io/target-type: ip     alb.ingress.kubernetes.io/certificate-arn: \"$ACM_CERT_ARN\"     alb.ingress.kubernetes.io/listen-ports: '[{\"HTTPS\":443}]' spec:   rules:     - host: api.metasurvey.ejemplo.org       http:         paths:           - path: /             pathType: Prefix             backend:               service:                 name: metasurvey-api                 port:                   number: 8787 # Instalar AWS Load Balancer Controller (si no esta instalado) helm repo add eks https://aws.github.io/eks-charts helm install aws-load-balancer-controller eks/aws-load-balancer-controller \\   -n kube-system \\   --set clusterName=metasurvey-prod  kubectl apply -f k8s/aws-api.yaml"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"despliegue-en-azure-aks","dir":"Articles","previous_headings":"","what":"Despliegue en Azure (AKS)","title":"Guia de Self-Hosting (ES)","text":"Para produccion en Azure se usa AKS con CosmosDB (API MongoDB) como base de datos gestionada.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"crear-el-cluster-aks","dir":"Articles","previous_headings":"Despliegue en Azure (AKS)","what":"1. Crear el cluster AKS","title":"Guia de Self-Hosting (ES)","text":"","code":"# Requiere: az cli az group create --name rg-metasurvey --location brazilsouth  az aks create \\   --resource-group rg-metasurvey \\   --name aks-metasurvey \\   --node-count 2 \\   --node-vm-size Standard_B2ms \\   --generate-ssh-keys \\   --enable-managed-identity"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"crear-cosmosdb-con-api-mongodb","dir":"Articles","previous_headings":"Despliegue en Azure (AKS)","what":"2. Crear CosmosDB con API MongoDB","title":"Guia de Self-Hosting (ES)","text":"","code":"az cosmosdb create \\   --name cosmos-metasurvey \\   --resource-group rg-metasurvey \\   --kind MongoDB \\   --capabilities EnableMongo \\   --default-consistency-level Session \\   --locations regionName=brazilsouth  # Obtener connection string COSMOS_URI=$(az cosmosdb keys list \\   --name cosmos-metasurvey \\   --resource-group rg-metasurvey \\   --type connection-strings \\   --query \"connectionStrings[0].connectionString\" -o tsv)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"configurar-secrets-en-kubernetes-1","dir":"Articles","previous_headings":"Despliegue en Azure (AKS)","what":"3. Configurar secrets en Kubernetes","title":"Guia de Self-Hosting (ES)","text":"","code":"az aks get-credentials \\   --resource-group rg-metasurvey \\   --name aks-metasurvey  kubectl create namespace metasurvey  kubectl create secret generic metasurvey-secrets \\   --namespace metasurvey \\   --from-literal=mongo-uri=\"$COSMOS_URI\" \\   --from-literal=jwt-secret=\"$(openssl rand -hex 32)\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"deployment-con-nginx-ingress","dir":"Articles","previous_headings":"Despliegue en Azure (AKS)","what":"4. Deployment con NGINX Ingress","title":"Guia de Self-Hosting (ES)","text":"","code":"# k8s/azure-api.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-api   namespace: metasurvey spec:   replicas: 2   selector:     matchLabels:       app: metasurvey-api   template:     metadata:       labels:         app: metasurvey-api     spec:       containers:         - name: api           image: ghcr.io/metasurveyr/metasurvey-api:latest           ports:             - containerPort: 8787           env:             - name: METASURVEY_MONGO_URI               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-uri             - name: METASURVEY_JWT_SECRET               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: jwt-secret             - name: METASURVEY_WORKER_URL               value: \"http://worker-service:8788\"           resources:             requests:               memory: \"512Mi\"               cpu: \"250m\"             limits:               memory: \"1Gi\"               cpu: \"500m\"           livenessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 30           readinessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 10 --- apiVersion: v1 kind: Service metadata:   name: metasurvey-api   namespace: metasurvey spec:   type: ClusterIP   selector:     app: metasurvey-api   ports:     - port: 8787 --- apiVersion: networking.k8s.io/v1 kind: Ingress metadata:   name: metasurvey-ingress   namespace: metasurvey   annotations:     cert-manager.io/cluster-issuer: letsencrypt-prod     nginx.ingress.kubernetes.io/ssl-redirect: \"true\" spec:   ingressClassName: nginx   tls:     - hosts:         - api.metasurvey.ejemplo.org       secretName: metasurvey-tls   rules:     - host: api.metasurvey.ejemplo.org       http:         paths:           - path: /             pathType: Prefix             backend:               service:                 name: metasurvey-api                 port:                   number: 8787 # Instalar NGINX Ingress Controller helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx helm install ingress-nginx ingress-nginx/ingress-nginx \\   --namespace ingress-nginx --create-namespace  # Instalar cert-manager para TLS helm repo add jetstack https://charts.jetstack.io helm install cert-manager jetstack/cert-manager \\   --namespace cert-manager --create-namespace \\   --set crds.enabled=true  kubectl apply -f k8s/azure-api.yaml"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"feature-flags","dir":"Articles","previous_headings":"","what":"Feature Flags","title":"Guia de Self-Hosting (ES)","text":"La API soporta variables de entorno para controlar que modulos estan disponibles. Esto permite usar la misma imagen en diferentes configuraciones: Por ejemplo, la API publica de metasurvey en Railway solo sirve recetas y workflows – indicadores y worker estan deshabilitados: Un despliegue self-hosted con todas las capacidades:","code":"METASURVEY_ENABLE_INDICATORS=0 METASURVEY_ENABLE_WORKER=0 METASURVEY_ENABLE_INDICATORS=1 METASURVEY_ENABLE_WORKER=1 METASURVEY_WORKER_URL=http://worker:8788"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"despliegue-hibrido-registro-publico-infraestructura-privada","dir":"Articles","previous_headings":"","what":"Despliegue hibrido: Registro publico + Infraestructura privada","title":"Guia de Self-Hosting (ES)","text":"necesitas correr tu propio MongoDB para acceder las recetas compartidas. Podes desplegar tu propia API + Worker apuntando al registro publico de recetas de metasurvey, para que investigadores con acceso microdatos apliquen recetas publicadas por la comunidad. La organizacion despliega dos servicios: plumber API (:8787) – se conecta al MongoDB publico para leer recetas y workflows. Recibe requests del frontend o investigadores, y delega las estimaciones al worker. Worker (:8788) – tiene metasurvey instalado y acceso los microdatos privados. Obtiene las recetas del registro publico (via MongoDB), las aplica, y ejecuta las estimaciones. En este modo: Recetas y workflows se obtienen del registro publico – cualquier receta publicada por la comunidad esta disponible para tu API y worker. Los microdatos son privados – el worker carga archivos de encuesta desde un volumen local, nunca expuestos externamente. La estimacion es local – la API recibe el request, lo delega al worker, que aplica las recetas y ejecuta workflow() en tu infraestructura. Sin MongoDB propio – usas el registro publico tal cual. Esto es util para equipos de investigacion que tienen acceso microdatos restringidos y quieren aplicar recetas estandarizadas sin mantener su propia base de datos.","code":"MongoDB publico de metasurvey         Tu infraestructura   (recetas, workflows)                  (red privada)   +-------------------+           +---------------------------+   |  MongoDB Atlas     |<----------| plumber API  :8787        |   |  (solo lectura)    |           |   - lee recetas/wf        |   +-------------------+           |   - proxie POST /compute   |                                    +-------------+-------------+                                                  |                                     POST /compute|                                                  v                                    +-------------+-------------+                                    | Worker  :8788              |                                    |   - carga microdatos       |                                    |   - aplica recetas         |                                    |   - ejecuta workflow()     |                                    +---------------------------+                                                  ^                                    +-------------+-------------+                                    | Microdatos (.sav, .dta)   |                                    | PRIVADOS — nunca salen    |                                    +---------------------------+ # .env para despliegue hibrido # Ambos (API y Worker) apuntan al MongoDB publico de metasurvey METASURVEY_MONGO_URI=mongodb+srv://readonly:public@metasurvey.mongodb.net METASURVEY_DB=metasurvey  # El worker tiene microdatos locales SURVEY_DATA_PATH=/secure/microdatos  # La API delega estimaciones al worker METASURVEY_WORKER_URL=http://worker:8788 METASURVEY_ENABLE_WORKER=1  # Indicadores deshabilitados (no hay MongoDB local para guardarlos) METASURVEY_ENABLE_INDICATORS=0 docker compose up api worker"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"despliegue-en-produccion","dir":"Articles","previous_headings":"","what":"Despliegue en produccion","title":"Guia de Self-Hosting (ES)","text":"Para despliegues de produccion con modulos Terraform (AWS/Azure/GCP), Helm charts y pipelines CI/CD, ver el repositorio de infraestructura: El repositorio de infraestructura incluira: Modulos Terraform para bases de datos gestionadas (RDS, DocumentDB/CosmosDB, Cloud SQL, Memorystore) Manifiestos Kubernetes con autoescalado, ingress TLS y gestion de secretos Builds de imagenes Docker y configuracion de registry Monitoreo y health checks","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting-es.html","id":"proximos-pasos","dir":"Articles","previous_headings":"","what":"Proximos pasos","title":"Guia de Self-Hosting (ES)","text":"Referencia de la API y Base de Datos – Documentacion completa de endpoints, esquema MongoDB y autenticacion Creacion y publicacion de recetas – Construir recetas para procesamiento reproducible de encuestas Workflows de estimacion – Calcular estimaciones ponderadas de encuestas con workflow()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Self-Hosting Guide","text":"Many organizations publish statistical indicators derived survey data (unemployment rates, poverty rates, innovation metrics) without disclosing indicators computed. final number public, methodology – variables used, transformations applied, survey design used – remains opaque. metasurvey solves separating private data public methodology. can deploy metasurvey API infrastructure : Microdata stays private: raw survey files never leave network. Indicators public: computed results (point estimates, standard errors, confidence intervals) served via API. Methodology transparent: anyone can query recipe (data transformation steps) workflow (estimation calls survey design) produced indicator. traceability chain :","code":"Indicator                Workflow                    Recipe (the number)      -->    (how it was estimated)  --> (how variables were built) value: 0.082             svymean(~pd, design)        step_compute(svy, pd = ...) se: 0.003                estimation_type: annual     step_recode(svy, pea, ...) cv: 0.037                recipe_ids: [ech_emp_001]   depends_on: [e27, f66, ...]"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"architecture","dir":"Articles","previous_headings":"","what":"Architecture","title":"Self-Hosting Guide","text":"system two R services: public API serves indicators traceability, private Worker metasurvey installed access microdata. worker component touches raw survey data. metasurvey self-hosting infrastructure Key separation: Worker loads microdata, fetches recipes MongoDB, applies (bake_steps), runs estimation (workflow), posts result back API. public API never touches microdata – serves pre-computed indicators traceability. frontend can also request -demand computations filters (e.g., “unemployment rate women Montevideo”) via POST /indicators/compute, API proxies Worker.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"quick-start-with-docker-compose","dir":"Articles","previous_headings":"","what":"Quick Start with Docker Compose","title":"Self-Hosting Guide","text":"repository includes docker-compose.yml starts MongoDB, plumber API, Shiny recipe explorer. external database required.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"clone-and-configure","dir":"Articles","previous_headings":"Quick Start with Docker Compose","what":"1. Clone and configure","title":"Self-Hosting Guide","text":"Create .env file (use defaults development):","code":"git clone https://github.com/metasurveyr/metasurvey.git cd metasurvey # .env MONGO_USER=metasurvey MONGO_PASSWORD=change-me-in-production METASURVEY_JWT_SECRET=change-me-in-production METASURVEY_ADMIN_EMAIL=admin@example.com"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"start-the-stack","dir":"Articles","previous_headings":"Quick Start with Docker Compose","what":"2. Start the stack","title":"Self-Hosting Guide","text":"starts four services:","code":"docker compose up --build"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"initialize-the-database","dir":"Articles","previous_headings":"Quick Start with Docker Compose","what":"3. Initialize the database","title":"Self-Hosting Guide","text":"","code":"# Create collections and indexes docker compose exec mongo mongosh \\   -u metasurvey -p change-me-in-production \\   --authenticationDatabase admin \\   metasurvey /dev/stdin < inst/scripts/setup_mongodb.js  # Seed example recipes, workflows, and indicators docker compose exec api Rscript -e '   Sys.setenv(     METASURVEY_MONGO_URI = \"mongodb://metasurvey:change-me-in-production@mongo:27017/?authSource=admin\"   )   source(\"/app/seed_ech_recipes.R\") '"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"verify","dir":"Articles","previous_headings":"Quick Start with Docker Compose","what":"4. Verify","title":"Self-Hosting Guide","text":"","code":"curl http://localhost:8787/health {   \"status\": \"ok\",   \"service\": \"metasurvey-api\",   \"mongodb\": \"connected\" }"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"computing-and-publishing-indicators","dir":"Articles","previous_headings":"","what":"Computing and Publishing Indicators","title":"Self-Hosting Guide","text":"typical flow: load survey data, apply recipe, run workflow, publish result indicator full traceability. Now publish indicator API:","code":"library(metasurvey)  # 1. Load survey data (private -- stays on your server) svy <- Survey$new(   data = my_survey_data,   edition = \"2024\",   type = \"ech\",   engine = \"data.table\",   weight = add_weight(annual = \"W_ANO\") )  # 2. Apply a recipe (defines variables like unemployment status) svy <- step_compute(svy,   pd = data.table::fcase(     pobpcoac == 2, 1L,     pobpcoac %in% c(1, 3), 0L   ),   comment = \"Unemployed: POBPCOAC == 2\" ) svy <- bake_steps(svy)  # 3. Run the estimation (workflow) result <- workflow(   svy = list(svy),   survey::svymean(~pd, na.rm = TRUE),   estimation_type = \"annual\" )  # result is a data.table: #       stat      value     se     cv # svymean: pd    0.082  0.003  0.037 # Connect to your local API configure_api(\"http://localhost:8787\") api_login(\"admin@example.com\", \"your-password\")  # Build the indicator payload indicator <- list(   name = \"Unemployment Rate 2024\",   description = \"Annual unemployment rate, population 14+\",   recipe_id = \"ech_employment_001\",   workflow_id = \"ech_wf_labor\",   survey_type = \"ech\",   edition = \"2024\",   estimation_type = \"annual\",   stat = result$stat[1],   value = result$value[1],   se = result$se[1],   cv = result$cv[1],   confint_lower = result$confint_lower[1],   confint_upper = result$confint_upper[1],   metadata = list(     formula = \"~pd\",     estimation_function = \"svymean\"   ) )  # Publish (requires authentication) resp <- httr2::request(\"http://localhost:8787/indicators\") |>   httr2::req_headers(     Authorization = paste(\"Bearer\", Sys.getenv(\"METASURVEY_TOKEN\"))   ) |>   httr2::req_body_json(indicator) |>   httr2::req_perform()  httr2::resp_body_json(resp) # {ok: true, id: \"ind_1708099200_42\"}"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"consuming-indicators-transparency","dir":"Articles","previous_headings":"","what":"Consuming Indicators (Transparency)","title":"Self-Hosting Guide","text":"published, indicators full methodology accessible without authentication. transparency layer.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"get-the-indicator-value","dir":"Articles","previous_headings":"Consuming Indicators (Transparency)","what":"Get the indicator value","title":"Self-Hosting Guide","text":"","code":"curl http://localhost:8787/indicators/ind_ech_unemployment_2024 {   \"ok\": true,   \"indicator\": {     \"id\": \"ind_ech_unemployment_2024\",     \"name\": \"Tasa de desempleo 2024\",     \"value\": 0.082,     \"se\": 0.003,     \"cv\": 0.037,     \"confint_lower\": 0.076,     \"confint_upper\": 0.088,     \"survey_type\": \"ech\",     \"edition\": \"2024\",     \"recipe_id\": \"ech_employment_001\",     \"workflow_id\": \"ech_wf_labor\"   } }"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"get-the-workflow-how-it-was-estimated","dir":"Articles","previous_headings":"Consuming Indicators (Transparency)","what":"Get the workflow (how it was estimated)","title":"Self-Hosting Guide","text":"workflow tells statistical function used (svymean), formula (~pd), recipes applied data estimation.","code":"curl http://localhost:8787/indicators/ind_ech_unemployment_2024/workflow {   \"ok\": true,   \"indicator_id\": \"ind_ech_unemployment_2024\",   \"workflow\": {     \"id\": \"ech_wf_labor\",     \"name\": \"Mercado Laboral ECH\",     \"estimation_type\": \"annual\",     \"recipe_ids\": [\"ech_pobpcoac_000\", \"ech_employment_001\"],     \"calls\": [       \"svymean(~pea, design, na.rm=TRUE)\",       \"svymean(~po, design, na.rm=TRUE)\",       \"svymean(~pd, design, na.rm=TRUE)\"     ],     \"call_metadata\": [       {         \"type\": \"svymean\",         \"formula\": \"~pea\",         \"description\": \"Tasa de actividad\"       },       {         \"type\": \"svymean\",         \"formula\": \"~pd\",         \"description\": \"Tasa de desempleo\"       }     ]   } }"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"get-the-recipe-how-variables-were-built","dir":"Articles","previous_headings":"Consuming Indicators (Transparency)","what":"Get the recipe (how variables were built)","title":"Self-Hosting Guide","text":"recipe tells exactly variable constructed original survey variables. Combined workflow, anyone can verify full computation chain without accessing microdata.","code":"curl http://localhost:8787/indicators/ind_ech_unemployment_2024/recipe {   \"ok\": true,   \"indicator_id\": \"ind_ech_unemployment_2024\",   \"recipe\": {     \"id\": \"ech_employment_001\",     \"name\": \"Employment Status\",     \"steps\": [       \"step_compute(svy, po = fcase(pobpcoac == 1, 1L, TRUE, 0L), comment = 'Employed')\",       \"step_compute(svy, pd = fcase(pobpcoac == 2, 1L, TRUE, 0L), comment = 'Unemployed')\",       \"step_compute(svy, pea = fcase(pobpcoac %in% 1:2, 1L, TRUE, 0L), comment = 'EAP')\"     ],     \"depends_on\": [\"pobpcoac\"],     \"doc\": {       \"input_variables\": [\"pobpcoac\"],       \"output_variables\": [\"po\", \"pd\", \"pea\"],       \"pipeline\": [         {\"step\": 1, \"type\": \"compute\", \"outputs\": [\"po\"]},         {\"step\": 2, \"type\": \"compute\", \"outputs\": [\"pd\"]},         {\"step\": 3, \"type\": \"compute\", \"outputs\": [\"pea\"]}       ]     }   } }"},{"path":[]},{"path":[]},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"deploying-with-minikube","dir":"Articles","previous_headings":"","what":"Deploying with Minikube","title":"Self-Hosting Guide","text":"Kubernetes-based deployment, can test locally Minikube.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"start-minikube","dir":"Articles","previous_headings":"Deploying with Minikube","what":"Start Minikube","title":"Self-Hosting Guide","text":"","code":"minikube start"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"mongodb-deployment","dir":"Articles","previous_headings":"Deploying with Minikube","what":"MongoDB deployment","title":"Self-Hosting Guide","text":"","code":"# k8s/mongo.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-mongo   namespace: metasurvey spec:   replicas: 1   selector:     matchLabels:       app: metasurvey-mongo   template:     metadata:       labels:         app: metasurvey-mongo     spec:       containers:         - name: mongo           image: mongo:7           ports:             - containerPort: 27017           env:             - name: MONGO_INITDB_ROOT_USERNAME               value: metasurvey             - name: MONGO_INITDB_ROOT_PASSWORD               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-password --- apiVersion: v1 kind: Service metadata:   name: mongo-service   namespace: metasurvey spec:   selector:     app: metasurvey-mongo   ports:     - port: 27017       targetPort: 27017"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"worker-deployment","dir":"Articles","previous_headings":"Deploying with Minikube","what":"Worker deployment","title":"Self-Hosting Guide","text":"","code":"# k8s/worker.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-worker   namespace: metasurvey spec:   replicas: 1   selector:     matchLabels:       app: metasurvey-worker   template:     metadata:       labels:         app: metasurvey-worker     spec:       containers:         - name: worker           image: ghcr.io/metasurveyr/metasurvey-worker:latest           ports:             - containerPort: 8788           env:             - name: METASURVEY_MONGO_URI               value: \"mongodb://metasurvey:$(MONGO_PASSWORD)@mongo-service:27017/?authSource=admin\"             - name: MONGO_PASSWORD               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-password           volumeMounts:             - name: survey-data               mountPath: /data/surveys               readOnly: true           resources:             requests:               memory: \"1Gi\"               cpu: \"500m\"             limits:               memory: \"4Gi\"               cpu: \"2000m\"       volumes:         - name: survey-data           persistentVolumeClaim:             claimName: survey-microdata-pvc --- apiVersion: v1 kind: Service metadata:   name: worker-service   namespace: metasurvey spec:   selector:     app: metasurvey-worker   ports:     - port: 8788       targetPort: 8788"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"api-deployment","dir":"Articles","previous_headings":"Deploying with Minikube","what":"API deployment","title":"Self-Hosting Guide","text":"","code":"# k8s/api.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-api   namespace: metasurvey spec:   replicas: 2   selector:     matchLabels:       app: metasurvey-api   template:     metadata:       labels:         app: metasurvey-api     spec:       containers:         - name: api           image: ghcr.io/metasurveyr/metasurvey-api:latest           ports:             - containerPort: 8787           env:             - name: METASURVEY_MONGO_URI               value: \"mongodb://metasurvey:$(MONGO_PASSWORD)@mongo-service:27017/?authSource=admin\"             - name: MONGO_PASSWORD               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-password             - name: METASURVEY_JWT_SECRET               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: jwt-secret             - name: METASURVEY_WORKER_URL               value: \"http://worker-service:8788\"           livenessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 30           readinessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 10           resources:             requests:               memory: \"512Mi\"               cpu: \"250m\"             limits:               memory: \"1Gi\"               cpu: \"500m\" --- apiVersion: v1 kind: Service metadata:   name: metasurvey-api   namespace: metasurvey spec:   type: NodePort   selector:     app: metasurvey-api   ports:     - port: 8787       targetPort: 8787"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"apply-and-test","dir":"Articles","previous_headings":"Deploying with Minikube","what":"Apply and test","title":"Self-Hosting Guide","text":"","code":"kubectl create namespace metasurvey  kubectl create secret generic metasurvey-secrets \\   --namespace metasurvey \\   --from-literal=mongo-password=change-me \\   --from-literal=jwt-secret=change-me  kubectl apply -f k8s/mongo.yaml -f k8s/worker.yaml -f k8s/api.yaml  # Access the API minikube service metasurvey-api -n metasurvey"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"deploying-on-aws-eks","dir":"Articles","previous_headings":"","what":"Deploying on AWS (EKS)","title":"Self-Hosting Guide","text":"production AWS, use EKS DocumentDB (MongoDB compatible) managed database.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"create-the-eks-cluster","dir":"Articles","previous_headings":"Deploying on AWS (EKS)","what":"1. Create the EKS cluster","title":"Self-Hosting Guide","text":"","code":"# Requires: aws-cli, eksctl eksctl create cluster \\   --name metasurvey-prod \\   --region sa-east-1 \\   --node-type t3.medium \\   --nodes 2 \\   --nodes-min 1 \\   --nodes-max 5"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"create-documentdb-mongodb-compatible","dir":"Articles","previous_headings":"Deploying on AWS (EKS)","what":"2. Create DocumentDB (MongoDB compatible)","title":"Self-Hosting Guide","text":"","code":"aws docdb create-db-cluster \\   --db-cluster-identifier metasurvey-db \\   --engine docdb \\   --master-username metasurvey_admin \\   --master-user-password \"$DB_PASSWORD\" \\   --vpc-security-group-ids \"$SG_ID\" \\   --db-subnet-group-name \"$SUBNET_GROUP\"  aws docdb create-db-instance \\   --db-instance-identifier metasurvey-db-1 \\   --db-cluster-identifier metasurvey-db \\   --db-instance-class db.r6g.large \\   --engine docdb"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"configure-secrets-in-kubernetes","dir":"Articles","previous_headings":"Deploying on AWS (EKS)","what":"3. Configure secrets in Kubernetes","title":"Self-Hosting Guide","text":"","code":"aws eks update-kubeconfig --name metasurvey-prod --region sa-east-1  kubectl create namespace metasurvey  kubectl create secret generic metasurvey-secrets \\   --namespace metasurvey \\   --from-literal=mongo-uri=\"mongodb://metasurvey_admin:$DB_PASSWORD@metasurvey-db.cluster-xxx.sa-east-1.docdb.amazonaws.com:27017/?tls=true&tlsCAFile=/rds-combined-ca-bundle.pem&retryWrites=false\" \\   --from-literal=jwt-secret=\"$(openssl rand -hex 32)\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"deployment-with-alb-ingress","dir":"Articles","previous_headings":"Deploying on AWS (EKS)","what":"4. Deployment with ALB Ingress","title":"Self-Hosting Guide","text":"","code":"# k8s/aws-api.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-api   namespace: metasurvey spec:   replicas: 2   selector:     matchLabels:       app: metasurvey-api   template:     metadata:       labels:         app: metasurvey-api     spec:       containers:         - name: api           image: ghcr.io/metasurveyr/metasurvey-api:latest           ports:             - containerPort: 8787           env:             - name: METASURVEY_MONGO_URI               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-uri             - name: METASURVEY_JWT_SECRET               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: jwt-secret             - name: METASURVEY_WORKER_URL               value: \"http://worker-service:8788\"           resources:             requests:               memory: \"512Mi\"               cpu: \"250m\"             limits:               memory: \"1Gi\"               cpu: \"500m\"           livenessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 30           readinessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 10 --- apiVersion: v1 kind: Service metadata:   name: metasurvey-api   namespace: metasurvey spec:   type: ClusterIP   selector:     app: metasurvey-api   ports:     - port: 8787 --- apiVersion: networking.k8s.io/v1 kind: Ingress metadata:   name: metasurvey-ingress   namespace: metasurvey   annotations:     kubernetes.io/ingress.class: alb     alb.ingress.kubernetes.io/scheme: internet-facing     alb.ingress.kubernetes.io/target-type: ip     alb.ingress.kubernetes.io/certificate-arn: \"$ACM_CERT_ARN\"     alb.ingress.kubernetes.io/listen-ports: '[{\"HTTPS\":443}]' spec:   rules:     - host: api.metasurvey.example.org       http:         paths:           - path: /             pathType: Prefix             backend:               service:                 name: metasurvey-api                 port:                   number: 8787 # Install AWS Load Balancer Controller (if not installed) helm repo add eks https://aws.github.io/eks-charts helm install aws-load-balancer-controller eks/aws-load-balancer-controller \\   -n kube-system \\   --set clusterName=metasurvey-prod  kubectl apply -f k8s/aws-api.yaml"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"deploying-on-azure-aks","dir":"Articles","previous_headings":"","what":"Deploying on Azure (AKS)","title":"Self-Hosting Guide","text":"production Azure, use AKS CosmosDB (MongoDB API) managed database.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"create-the-aks-cluster","dir":"Articles","previous_headings":"Deploying on Azure (AKS)","what":"1. Create the AKS cluster","title":"Self-Hosting Guide","text":"","code":"# Requires: az cli az group create --name rg-metasurvey --location brazilsouth  az aks create \\   --resource-group rg-metasurvey \\   --name aks-metasurvey \\   --node-count 2 \\   --node-vm-size Standard_B2ms \\   --generate-ssh-keys \\   --enable-managed-identity"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"create-cosmosdb-with-mongodb-api","dir":"Articles","previous_headings":"Deploying on Azure (AKS)","what":"2. Create CosmosDB with MongoDB API","title":"Self-Hosting Guide","text":"","code":"az cosmosdb create \\   --name cosmos-metasurvey \\   --resource-group rg-metasurvey \\   --kind MongoDB \\   --capabilities EnableMongo \\   --default-consistency-level Session \\   --locations regionName=brazilsouth  # Get connection string COSMOS_URI=$(az cosmosdb keys list \\   --name cosmos-metasurvey \\   --resource-group rg-metasurvey \\   --type connection-strings \\   --query \"connectionStrings[0].connectionString\" -o tsv)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"configure-secrets-in-kubernetes-1","dir":"Articles","previous_headings":"Deploying on Azure (AKS)","what":"3. Configure secrets in Kubernetes","title":"Self-Hosting Guide","text":"","code":"az aks get-credentials \\   --resource-group rg-metasurvey \\   --name aks-metasurvey  kubectl create namespace metasurvey  kubectl create secret generic metasurvey-secrets \\   --namespace metasurvey \\   --from-literal=mongo-uri=\"$COSMOS_URI\" \\   --from-literal=jwt-secret=\"$(openssl rand -hex 32)\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"deployment-with-nginx-ingress","dir":"Articles","previous_headings":"Deploying on Azure (AKS)","what":"4. Deployment with NGINX Ingress","title":"Self-Hosting Guide","text":"","code":"# k8s/azure-api.yaml apiVersion: apps/v1 kind: Deployment metadata:   name: metasurvey-api   namespace: metasurvey spec:   replicas: 2   selector:     matchLabels:       app: metasurvey-api   template:     metadata:       labels:         app: metasurvey-api     spec:       containers:         - name: api           image: ghcr.io/metasurveyr/metasurvey-api:latest           ports:             - containerPort: 8787           env:             - name: METASURVEY_MONGO_URI               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: mongo-uri             - name: METASURVEY_JWT_SECRET               valueFrom:                 secretKeyRef:                   name: metasurvey-secrets                   key: jwt-secret             - name: METASURVEY_WORKER_URL               value: \"http://worker-service:8788\"           resources:             requests:               memory: \"512Mi\"               cpu: \"250m\"             limits:               memory: \"1Gi\"               cpu: \"500m\"           livenessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 30           readinessProbe:             httpGet:               path: /health               port: 8787             initialDelaySeconds: 10 --- apiVersion: v1 kind: Service metadata:   name: metasurvey-api   namespace: metasurvey spec:   type: ClusterIP   selector:     app: metasurvey-api   ports:     - port: 8787 --- apiVersion: networking.k8s.io/v1 kind: Ingress metadata:   name: metasurvey-ingress   namespace: metasurvey   annotations:     cert-manager.io/cluster-issuer: letsencrypt-prod     nginx.ingress.kubernetes.io/ssl-redirect: \"true\" spec:   ingressClassName: nginx   tls:     - hosts:         - api.metasurvey.example.org       secretName: metasurvey-tls   rules:     - host: api.metasurvey.example.org       http:         paths:           - path: /             pathType: Prefix             backend:               service:                 name: metasurvey-api                 port:                   number: 8787 # Install NGINX Ingress Controller helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx helm install ingress-nginx ingress-nginx/ingress-nginx \\   --namespace ingress-nginx --create-namespace  # Install cert-manager for TLS helm repo add jetstack https://charts.jetstack.io helm install cert-manager jetstack/cert-manager \\   --namespace cert-manager --create-namespace \\   --set crds.enabled=true  kubectl apply -f k8s/azure-api.yaml"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"feature-flags","dir":"Articles","previous_headings":"","what":"Feature Flags","title":"Self-Hosting Guide","text":"API supports feature flags via environment variables control modules available. lets run API image different configurations: example, public metasurvey API Railway serves recipes workflows – indicators worker disabled: self-hosted deployment full capabilities:","code":"METASURVEY_ENABLE_INDICATORS=0 METASURVEY_ENABLE_WORKER=0 METASURVEY_ENABLE_INDICATORS=1 METASURVEY_ENABLE_WORKER=1 METASURVEY_WORKER_URL=http://worker:8788"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"hybrid-deployment-public-registry-private-infrastructure","dir":"Articles","previous_headings":"","what":"Hybrid Deployment: Public Registry + Private Infrastructure","title":"Self-Hosting Guide","text":"don’t need run MongoDB access shared recipes. can deploy API + Worker pointing public metasurvey recipe registry, researchers access microdata can apply community-published recipes locally. organization deploys two services: plumber API (:8787) – connects public MongoDB read recipes workflows. Receives requests frontend researchers, proxies compute requests worker. Worker (:8788) – metasurvey installed access private microdata. Fetches recipes public registry (via MongoDB), applies , runs estimations. mode: Recipes workflows fetched public registry – recipe published community available API worker. Microdata stays private – worker loads survey files local volume, never exposed externally. Estimation local – API receives request, proxies worker, applies recipes runs workflow() infrastructure. MongoDB maintain – use public registry -. useful research teams access restricted microdata want apply standardized recipes without maintaining database.","code":"Public metasurvey MongoDB             Your infrastructure   (recipes, workflows)                  (private network)   +-------------------+           +---------------------------+   |  MongoDB Atlas     |<----------| plumber API  :8787        |   |  (read-only)       |           |   - reads recipes/wf      |   +-------------------+           |   - proxies POST /compute  |                                    +-------------+-------------+                                                  |                                     POST /compute|                                                  v                                    +-------------+-------------+                                    | Worker  :8788              |                                    |   - loads microdata        |                                    |   - applies recipes        |                                    |   - runs workflow()        |                                    +---------------------------+                                                  ^                                    +-------------+-------------+                                    | Microdata (.sav, .dta)    |                                    | PRIVATE — never leaves    |                                    +---------------------------+ # .env for hybrid deployment # Both API and Worker point to the public metasurvey MongoDB METASURVEY_MONGO_URI=mongodb+srv://readonly:public@metasurvey.mongodb.net METASURVEY_DB=metasurvey  # Worker has local microdata SURVEY_DATA_PATH=/secure/microdata  # API proxies compute requests to the worker METASURVEY_WORKER_URL=http://worker:8788 METASURVEY_ENABLE_WORKER=1  # Indicators disabled (no local MongoDB to store them) METASURVEY_ENABLE_INDICATORS=0 docker compose up api worker"},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"production-deployment","dir":"Articles","previous_headings":"","what":"Production Deployment","title":"Self-Hosting Guide","text":"production deployments Terraform modules (AWS/Azure/GCP), Helm charts, CI/CD pipelines, see infrastructure repository: infrastructure repository include: Terraform modules managed databases (RDS, DocumentDB/CosmosDB, Cloud SQL, Memorystore) Kubernetes manifests autoscaling, TLS ingress, secrets management Docker image builds registry configuration Monitoring health check setup","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/self-hosting.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Self-Hosting Guide","text":"API Database Reference – Full endpoint documentation, MongoDB schema, authentication details Creating Sharing Recipes – Build recipes reproducible survey processing Estimation Workflows – Compute weighted survey estimates workflow()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"descripción-general","dir":"Articles","previous_headings":"","what":"Descripción general","title":"Explorador Interactivo de Recetas (ES)","text":"metasurvey incluye una aplicación web Shiny para explorar, buscar y gestionar recetas y workflows de forma interactiva. La aplicación se conecta la API de metasurvey para mostrar recetas contribuidas por la comunidad, o funciona en modo offline con datos de ejemplo incorporados.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"iniciar-la-aplicación","dir":"Articles","previous_headings":"","what":"Iniciar la aplicación","title":"Explorador Interactivo de Recetas (ES)","text":"La función explore_recipes() inicia la aplicación Shiny y la abre en el navegador. se necesita configuración adicional: la aplicación se conecta automáticamente la API de producción.","code":"library(metasurvey)  # Open in your default browser explore_recipes()  # Or specify host and port explore_recipes(port = 3838, host = \"127.0.0.1\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"navegación-de-la-interfaz","dir":"Articles","previous_headings":"","what":"Navegación de la interfaz","title":"Explorador Interactivo de Recetas (ES)","text":"La aplicación tiene tres pestañas principales en la barra de navegación superior:","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"pestaña-de-recetas","dir":"Articles","previous_headings":"Navegación de la interfaz","what":"Pestaña de Recetas","title":"Explorador Interactivo de Recetas (ES)","text":"La pestaña Recipes es el punto de entrada principal. Muestra una grilla con búsqueda de recetas publicadas, cada una presentada como una tarjeta con: Nombre y edición como metadatos Descripción (truncada dos líneas) Etiquetas de categoría con insignias de colores (Labor Market, Income, Education, Health, Demographics, Housing) Índigo = Official Esmeralda = Reviewed Pizarra = Community Cantidad de descargas y un botón “View”","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"búsqueda-y-filtrado","dir":"Articles","previous_headings":"Navegación de la interfaz > Pestaña de Recetas","what":"Búsqueda y filtrado","title":"Explorador Interactivo de Recetas (ES)","text":"La parte superior de la pestaña de Recetas ofrece cuatro filtros: Los filtros se aplican del lado del cliente para obtener resultados instantáneos. Utilice el botón de actualización para recargar los datos desde la API.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"fila-de-estadísticas","dir":"Articles","previous_headings":"Navegación de la interfaz > Pestaña de Recetas","what":"Fila de estadísticas","title":"Explorador Interactivo de Recetas (ES)","text":"Debajo de los filtros, tres cuadros de estadísticas resumen los datos actuales: Recetas totales en el registro Recetas oficiales con certificación institucional Descargas totales de todas las recetas","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"modal-de-detalle-de-receta","dir":"Articles","previous_headings":"Navegación de la interfaz > Pestaña de Recetas","what":"Modal de detalle de receta","title":"Explorador Interactivo de Recetas (ES)","text":"Haga clic en “View” en cualquier tarjeta de receta para abrir un modal de detalle que muestra: Metadatos: nombre, descripción, edición, tipo de encuesta Información del autor: nombre del creador, institución, nivel de confianza Variables de entrada: lo que la receta espera encontrar en los datos de la encuesta (mostradas como chips) Variables de salida: lo que la receta crea (mostradas como chips) Visualización del pipeline: grafo interactivo de pasos (si el paquete visNetwork está instalado) Recetas dependientes: otras recetas de las que esta depende (con enlaces para navegación) Workflows que la referencian: workflows que utilizan esta receta (con enlace para ir la pestaña de Workflows) Metadatos ANDA: etiquetas de variables del catálogo de datos del INE, cuando están disponibles (integración oficial; verifique contra el libro de códigos oficial)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"pestaña-de-workflows","dir":"Articles","previous_headings":"Navegación de la interfaz","what":"Pestaña de Workflows","title":"Explorador Interactivo de Recetas (ES)","text":"La pestaña Workflows muestra los workflows de estimación publicados. Cada tarjeta de workflow presenta el tipo de estimación (Annual, Quarterly, Monthly) y las recetas que referencia. Los workflows utilizan la misma interfaz de búsqueda y filtrado que las recetas. El modal de detalle muestra: Todas las llamadas de estimación (svymean, svytotal, svyratio, svyby) presentadas como una línea de tiempo visual Referencias cruzadas las recetas utilizadas para la preparación de datos Haga clic en una receta referenciada para navegar directamente su detalle","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"navegación-cruzada","dir":"Articles","previous_headings":"Navegación de la interfaz","what":"Navegación cruzada","title":"Explorador Interactivo de Recetas (ES)","text":"Las recetas y los workflows están vinculados bidireccionalmente: Desde el detalle de una receta, haga clic en un workflow que la referencia para ir la pestaña de Workflows y abrir el detalle de ese workflow Desde el detalle de un workflow, haga clic en una receta referenciada para volver la pestaña de Recetas y abrir el detalle de esa receta Esto permite rastrear el pipeline de análisis completo: desde la transformación de datos (receta) hasta la estimación (workflow).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"pestaña-de-perfil","dir":"Articles","previous_headings":"Navegación de la interfaz","what":"Pestaña de Perfil","title":"Explorador Interactivo de Recetas (ES)","text":"La pestaña de Perfil cambia según el estado de autenticación: Antes de iniciar sesión: muestra un formulario de inicio de sesión/registro con dos sub-pestañas: Login: correo electrónico y contraseña Register: nombre, correo electrónico, contraseña, tipo de cuenta (Individual, Institutional Member o Institution) Después de iniciar sesión: muestra el perfil con: Nombre, tipo de cuenta, nivel de confianza, correo electrónico e institución Botón Recipes para ver las recetas publicadas Sección API Token para generar un token de larga duración para uso en scripts Botón Logout","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"generación-de-un-api-token","dir":"Articles","previous_headings":"Navegación de la interfaz > Pestaña de Perfil","what":"Generación de un API Token","title":"Explorador Interactivo de Recetas (ES)","text":"Desde la pestaña de Perfil, haga clic en “Generate API Token” para crear un token de 90 días para usar en scripts de R: Esto es útil para scripts automatizados y pipelines de CI/CD.","code":"# Use the token generated from the app Sys.setenv(METASURVEY_TOKEN = \"your-token-here\")  # Now API calls work without interactive login recipes <- api_list_recipes(survey_type = \"ech\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"panel-de-administración","dir":"Articles","previous_headings":"Navegación de la interfaz > Pestaña de Perfil","what":"Panel de administración","title":"Explorador Interactivo de Recetas (ES)","text":"Si su cuenta tiene privilegios de administrador, aparece un panel adicional para revisar solicitudes de cuentas institucionales. Los administradores pueden aprobar o rechazar registros pendientes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"modo-offline","dir":"Articles","previous_headings":"","what":"Modo offline","title":"Explorador Interactivo de Recetas (ES)","text":"Si la API está disponible, la aplicación cambia automáticamente al modo offline utilizando datos de ejemplo incorporados. Esto incluye 13 recetas de muestra y 6 workflows de muestra que cubren casos de uso comunes de la ECH: Indicadores del mercado laboral Distribución del ingreso y pobreza Educación y cobertura de salud Demografía y vivienda Indicadores de innovación (EAII) El modo offline es útil para demostraciones y para explorar la interfaz sin acceso la red.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"despliegue-con-docker","dir":"Articles","previous_headings":"","what":"Despliegue con Docker","title":"Explorador Interactivo de Recetas (ES)","text":"Para despliegue en producción o uso interno de un equipo, la aplicación incluye un Dockerfile: La variable de entorno METASURVEY_API_URL configura qué API se conecta la aplicación. Puede apuntar una instancia auto-alojada.","code":"# Build the image docker build -t metasurvey-shiny inst/shiny/  # Run on port 3838 docker run -p 3838:3838 \\   -e METASURVEY_API_URL=\"https://metasurvey-api-production.up.railway.app\" \\   metasurvey-shiny"},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer-es.html","id":"próximos-pasos","dir":"Articles","previous_headings":"","what":"Próximos pasos","title":"Explorador Interactivo de Recetas (ES)","text":"Referencia de API y Base de Datos – Detalles técnicos sobre los endpoints de la API y el esquema de MongoDB Creación y Compartición de Recetas – Construir recetas de forma programática y publicarlas Workflows de Estimación – Calcular estimaciones ponderadas de encuestas con workflow()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Interactive Recipe Explorer","text":"metasurvey includes Shiny web application interactively exploring, searching, managing recipes workflows. application connects metasurvey API display community-contributed recipes, works offline mode built-sample data.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"launching-the-application","dir":"Articles","previous_headings":"","what":"Launching the application","title":"Interactive Recipe Explorer","text":"explore_recipes() function starts Shiny application opens browser. additional configuration needed: application automatically connects production API.","code":"library(metasurvey)  # Open in your default browser explore_recipes()  # Or specify host and port explore_recipes(port = 3838, host = \"127.0.0.1\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"interface-navigation","dir":"Articles","previous_headings":"","what":"Interface navigation","title":"Interactive Recipe Explorer","text":"application three main tabs top navigation bar:","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"recipes-tab","dir":"Articles","previous_headings":"Interface navigation","what":"Recipes tab","title":"Interactive Recipe Explorer","text":"Recipes tab main entry point. displays searchable grid published recipes, presented card : Name edition metadata Description (truncated two lines) Category tags colored badges (Labor Market, Income, Education, Health, Demographics, Housing) Indigo = Official Emerald = Reviewed Slate = Community Download count “View” button","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"search-and-filtering","dir":"Articles","previous_headings":"Interface navigation > Recipes tab","what":"Search and filtering","title":"Interactive Recipe Explorer","text":"top Recipes tab offers four filters: Filters applied client-side instant results. Use refresh button reload data API.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"statistics-row","dir":"Articles","previous_headings":"Interface navigation > Recipes tab","what":"Statistics row","title":"Interactive Recipe Explorer","text":"filters, three statistics boxes summarize current data: Total recipes registry Official recipes institutional certification Total downloads across recipes","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"recipe-detail-modal","dir":"Articles","previous_headings":"Interface navigation > Recipes tab","what":"Recipe detail modal","title":"Interactive Recipe Explorer","text":"Click “View” recipe card open detail modal showing: Metadata: name, description, edition, survey type Author information: creator name, institution, trust level Input variables: recipe expects find survey data (displayed chips) Output variables: recipe creates (displayed chips) Pipeline visualization: interactive step graph (visNetwork package installed) Dependent recipes: recipes one depends (navigation links) Referencing workflows: workflows use recipe (link navigate Workflows tab) ANDA metadata: variable labels INE data catalog, available (unofficial integration; verify official codebook)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"workflows-tab","dir":"Articles","previous_headings":"Interface navigation","what":"Workflows tab","title":"Interactive Recipe Explorer","text":"Workflows tab displays published estimation workflows. workflow card shows estimation type (Annual, Quarterly, Monthly) recipes references. Workflows use search filtering interface recipes. detail modal shows: estimation calls (svymean, svytotal, svyratio, svyby) presented visual timeline Cross-references recipes used data preparation Click referenced recipe navigate directly detail","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"cross-navigation","dir":"Articles","previous_headings":"Interface navigation","what":"Cross-navigation","title":"Interactive Recipe Explorer","text":"Recipes workflows linked bidirectionally: recipe detail, click referencing workflow go Workflows tab open workflow’s detail workflow detail, click referenced recipe return Recipes tab open recipe’s detail allows tracing complete analysis pipeline: data transformation (recipe) estimation (workflow).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"profile-tab","dir":"Articles","previous_headings":"Interface navigation","what":"Profile tab","title":"Interactive Recipe Explorer","text":"Profile tab changes based authentication state: logging : displays login/registration form two sub-tabs: Login: email password Register: name, email, password, account type (Individual, Institutional Member, Institution) logging : displays profile : Name, account type, trust level, email, institution Recipes button view published recipes API Token section generate long-lived token use scripts Logout button","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"generating-an-api-token","dir":"Articles","previous_headings":"Interface navigation > Profile tab","what":"Generating an API Token","title":"Interactive Recipe Explorer","text":"Profile tab, click “Generate API Token” create 90-day token use R scripts: useful automated scripts CI/CD pipelines.","code":"# Use the token generated from the app Sys.setenv(METASURVEY_TOKEN = \"your-token-here\")  # Now API calls work without interactive login recipes <- api_list_recipes(survey_type = \"ech\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"administration-panel","dir":"Articles","previous_headings":"Interface navigation > Profile tab","what":"Administration panel","title":"Interactive Recipe Explorer","text":"account administrator privileges, additional panel appears reviewing institutional account requests. Administrators can approve reject pending registrations.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"offline-mode","dir":"Articles","previous_headings":"","what":"Offline mode","title":"Interactive Recipe Explorer","text":"API unavailable, application automatically switches offline mode using built-sample data. includes 13 sample recipes 6 sample workflows covering common ECH use cases: Labor market indicators Income distribution poverty Education health coverage Demographics housing Innovation indicators (EAII) Offline mode useful demonstrations exploring interface without network access.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"docker-deployment","dir":"Articles","previous_headings":"","what":"Docker deployment","title":"Interactive Recipe Explorer","text":"production deployment team-internal use, application includes Dockerfile: METASURVEY_API_URL environment variable configures API application connects . can point self-hosted instance.","code":"# Build the image docker build -t metasurvey-shiny inst/shiny/  # Run on port 3838 docker run -p 3838:3838 \\   -e METASURVEY_API_URL=\"https://metasurvey-api-production.up.railway.app\" \\   metasurvey-shiny"},{"path":"https://metasurveyr.github.io/metasurvey/articles/shiny-explorer.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Interactive Recipe Explorer","text":"API Database Reference – Technical details API endpoints MongoDB schema Creating Sharing Recipes – Build recipes programmatically publish Estimation Workflows – Compute weighted survey estimates workflow()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"motivacion","dir":"Articles","previous_headings":"","what":"Motivacion","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"Muchos grupos de investigacion latinoamericanos mantienen decadas de archivos .de STATA que procesan microdatos de encuestas de hogares. Estos scripts codifican conocimiento institucional sobre armonizacion de variables, descomposicion de ingresos y construccion de indicadores – pero estan encerrados en un formato dificil de versionar, compartir o integrar con flujos de trabajo modernos en R. El transpilador de metasurvey convierte archivos .de STATA en objetos Recipe de metasurvey. Esto permite: Reproducibilidad: los pipelines de STATA se convierten en recetas JSON versionadas Interoperabilidad: la misma receta se ejecuta sobre cualquier objeto Survey respaldado por data.table Descubrimiento: las recetas transpiladas pueden publicarse en la API de metasurvey para que otros investigadores las encuentren y reutilicen El transpilador maneja los patrones de STATA mas comunes en scripts de procesamiento de encuestas: generacion de variables, reemplazo condicional, recodificacion, agregacion, loops, codificacion de valores faltantes y extraccion de etiquetas.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"inicio-rapido","dir":"Articles","previous_headings":"","what":"Inicio rapido","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"El resultado es una lista con cuatro elementos:","code":"library(metasurvey)  # Transpilar un archivo .do result <- transpile_stata(\"demographics.do\") result$steps[1:3] #> [1] \"step_rename(svy, hh_id = \\\"id\\\", person_id = \\\"nper\\\")\" #> [2] \"step_compute(svy, weight_yr = pesoano)\" #> [3] \"step_compute(svy, sex = e26)\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"pipeline-de-transpilacion","dir":"Articles","previous_headings":"","what":"Pipeline de transpilacion","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"El transpilador trabaja en cuatro pasadas:","code":"archivo .do      |      v   [1] parse_do_file()      -- tokenizar lineas en objetos de comando      |      v   [2] translate_commands()  -- mapear cada comando STATA a steps de metasurvey      |      v   [3] optimize_steps()      -- consolidar renames, drops, etc. consecutivos      |      v   [4] Recipe / JSON         -- empaquetar steps con metadatos"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"pasada-1-parsing","dir":"Articles","previous_headings":"Pipeline de transpilacion","what":"Pasada 1: Parsing","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"parse_do_file() lee un archivo .y produce una lista de objetos de comando. Maneja: Eliminacion de comentarios: *, //, y bloques /* */ Continuacion de linea: /// y /* */ usados como marcadores de continuacion Expansion de loops: foreach y forvalues se desenrollan, sustituyendo macros con backtick (`var') con cada valor de iteracion Manejo de prefijos: capture, bysort group:, y abreviaciones de comandos (g por gen, cap por capture)","code":"commands <- parse_do_file(\"demographics.do\") commands[[1]] #> $cmd #> [1] \"gen\" #> $args #> [1] \"sex = e26\" #> $if_clause #> NULL #> $by_group #> NULL #> $capture #> [1] FALSE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"pasada-2-traduccion-de-comandos","dir":"Articles","previous_headings":"Pipeline de transpilacion","what":"Pasada 2: Traduccion de comandos","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"Cada comando parseado se mapea una o mas cadenas de steps de metasurvey. La siguiente tabla muestra los comandos de STATA soportados y sus traducciones.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"gen-generate","dir":"Articles","previous_headings":"Patrones soportados","what":"gen / generate","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"La creacion simple de variables se traduce step_compute: Cuando un gen incluye una clausula , la condicion se envuelve en fifelse:","code":"gen sex = q01 gen is_urban = (region < 3) gen byte age_group = -9 step_compute(svy, sex = q01) step_compute(svy, is_urban = (region < 3)) step_compute(svy, age_group = -9L) gen employed = hours_worked if age >= 14 step_compute(svy, employed = data.table::fifelse(age >= 14, hours_worked, NA))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"cadenas-gen-replace-el-patron-dominante","dir":"Articles","previous_headings":"Patrones soportados","what":"Cadenas gen + replace (el patron dominante)","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"El patron mas comun en archivos .de encuestas es inicializar una variable y luego completarla con reemplazos condicionales: Cuando todos los lados derechos son constantes, el transpilador emite un unico step_recode: Cuando algun lado derecho es una expresion, el transpilador emite una cadena de step_compute con fifelse:","code":"gen relationship = -9 replace relationship = 1 if q05 == 1 replace relationship = 2 if q05 == 2 replace relationship = 3 if inrange(q05, 3, 5) replace relationship = 4 if q05 == 6 step_recode(svy, relationship,     q05 == 1 ~ 1L,     q05 == 2 ~ 2L,     q05 >= 3 & q05 <= 5 ~ 3L,     q05 == 6 ~ 4L,     .default = -9L) gen labour_inc = 0 replace labour_inc = wage if job_type == 1 replace labour_inc = wage + bonus if job_type == 2 step_compute(svy, labour_inc = 0L) step_compute(svy, labour_inc = data.table::fifelse(     job_type == 1, wage, labour_inc)) step_compute(svy, labour_inc = data.table::fifelse(     job_type == 2, wage + bonus, labour_inc))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"recode","dir":"Articles","previous_headings":"Patrones soportados","what":"recode","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"STATA recode con mapeos entre parentesis o sintaxis inline:","code":"recode urban_filter (0=2) recode edu_level (2=2) (3=-9) (4=3) (5=4), gen(edu_compat) recode var1 var2 var3 .=0 step_compute(svy, urban_filter = data.table::fifelse(     urban_filter == 0, 2, urban_filter))  step_compute(svy, edu_compat = edu_level) step_compute(svy, edu_compat = data.table::fifelse(     edu_compat == 2, 2, edu_compat)) # ... un fifelse por mapeo  # Recode multi-variable: un step por variable step_compute(svy, var1 = data.table::fifelse(is.na(var1), 0, var1)) step_compute(svy, var2 = data.table::fifelse(is.na(var2), 0, var2)) step_compute(svy, var3 = data.table::fifelse(is.na(var3), 0, var3))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"egen-agregacion-con-by-groups","dir":"Articles","previous_headings":"Patrones soportados","what":"egen (agregacion con by-groups)","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"Funciones egen soportadas: sum, max, min, mean, count, sd, median, total, rowtotal, rowmean.","code":"bysort household: egen hh_income = sum(income) egen max_age = max(age), by(household) step_compute(svy, hh_income = sum(income, na.rm = TRUE),     .by = \"household\") step_compute(svy, max_age = max(age, na.rm = TRUE),     .by = \"household\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"loops-foreach","dir":"Articles","previous_headings":"Patrones soportados","what":"Loops foreach","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"Los loops se expanden durante el parsing. El transpilador desenrolla foreach tanto con listas como con rangos numlist, incluyendo loops anidados: Se expande 4 pares de gen+replace, cada uno transpilado independientemente:","code":"foreach i of numlist 1/4 {     gen contrib`i' = 0     replace contrib`i' = amount if provider == `i' } step_recode(svy, contrib1, provider == 1 ~ amount, .default = 0L) step_recode(svy, contrib2, provider == 2 ~ amount, .default = 0L) step_recode(svy, contrib3, provider == 3 ~ amount, .default = 0L) step_recode(svy, contrib4, provider == 4 ~ amount, .default = 0L)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"mvencode-codificacion-de-valores-faltantes","dir":"Articles","previous_headings":"Patrones soportados","what":"mvencode (codificacion de valores faltantes)","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"","code":"mvencode income_1 income_2 income_3, mv(0) step_compute(svy, income_1 = data.table::fifelse(     is.na(income_1), 0, income_1)) step_compute(svy, income_2 = data.table::fifelse(     is.na(income_2), 0, income_2)) step_compute(svy, income_3 = data.table::fifelse(     is.na(income_3), 0, income_3))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"destring","dir":"Articles","previous_headings":"Patrones soportados","what":"destring","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"","code":"destring wage bonus, replace force step_compute(svy, wage = suppressWarnings(     as.numeric(as.character(wage)))) step_compute(svy, bonus = suppressWarnings(     as.numeric(as.character(bonus))))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"rename-drop-keep","dir":"Articles","previous_headings":"Patrones soportados","what":"rename, drop, keep","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"Los renames consecutivos se consolidan en una unica llamada step_rename, y los drops consecutivos se fusionan en un solo step_remove.","code":"rename id hh_id drop aux1 aux2 aux3 step_rename(svy, hh_id = \"id\") step_remove(svy, aux1, aux2, aux3)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"traduccion-de-expresiones-stata","dir":"Articles","previous_headings":"Patrones soportados","what":"Traduccion de expresiones STATA","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"La sintaxis especifica de STATA en expresiones se traduce automaticamente:","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"rangos-de-variables","dir":"Articles","previous_headings":"Patrones soportados","what":"Rangos de variables","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"STATA permite rangos de variables como aux1-aux4 que significan aux1 aux2 aux3 aux4. El transpilador los expande en comandos drop, recode y mvencode:","code":"drop contrib1-contrib4 step_remove(svy, contrib1, contrib2, contrib3, contrib4)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"etiquetas","dir":"Articles","previous_headings":"Patrones soportados","what":"Etiquetas","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"Las etiquetas de variables y valores se extraen y almacenan en los metadatos de la receta:","code":"lab var sex \"Sex of respondent\" lab def sex_lbl 1 \"Male\" 2 \"Female\" lab val sex sex_lbl result$labels #> $var_labels #> $var_labels$sex #> [1] \"Sex of respondent\" #> #> $val_labels #> $val_labels$sex #> $val_labels$sex$`1` #> [1] \"Male\" #> $val_labels$sex$`2` #> [1] \"Female\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"comandos-omitidos","dir":"Articles","previous_headings":"","what":"Comandos omitidos","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"Los comandos que modifican datos de la encuesta se omiten silenciosamente durante la transpilacion. Estos incluyen: E/S: use, save, import, export, insheet, outsheet Visualizacion: tabulate, summarize, describe, list, browse, display Flujo de control: /else, , program, exit Configuracion: set, sort, order, compress, format Macros: global, local, scalar, matrix El elemento $stats del resultado reporta cuantos comandos cayeron en cada categoria.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"un-ejemplo-realista","dir":"Articles","previous_headings":"","what":"Un ejemplo realista","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"El siguiente archivo .es una version simplificada de un modulo tipico de demografia de encuestas. es un script de produccion real, pero usa los mismos patrones encontrados en pipelines reales de procesamiento de la ECH. Guardar como demo_module.:","code":"* ────────────────────────────────────────────── * Modulo de demografia -- ejemplo simplificado * ──────────────────────────────────────────────  rename id hh_id rename nper person_id  gen weight_yr = pesoano gen weight_qt = pesotri  * ── Sexo ── gen sex = q01  * ── Relacion con el jefe de hogar ── g relationship = -9 replace relationship = 1 if q05 == 1 replace relationship = 2 if q05 == 2 replace relationship = 3 if inrange(q05, 3, 5) replace relationship = 4 if q05 == 6 replace relationship = 5 if q05 == 7  * ── Area ── gen area = . replace area = 1 if region == 1 replace area = 2 if region == 2 replace area = 3 if region == 3  * ── Nivel educativo (armonizado) ── recode q20 (2=2) (3=-9) (4=3) (5=4), gen(edu_compat)  * ── Estadisticas de edad a nivel de hogar ── bysort hh_id: egen max_age = max(edad) bysort hh_id: egen n_members = count(person_id)  * ── Inicializar contribuciones de seguro de salud ── foreach i of numlist 1/3 {     gen contrib`i' = 0     replace contrib`i' = amount if provider == `i' }  * ── Codificar valores faltantes ── mvencode contrib1 contrib2 contrib3, mv(0)  * ── Limpiar ── drop region q01 q05 q20  * ── Etiquetas ── lab var sex \"Sexo\" lab var relationship \"Relacion con el jefe de hogar\" lab def sex_lbl 1 \"Hombre\" 2 \"Mujer\" lab val sex sex_lbl lab def rel_lbl 1 \"Jefe\" 2 \"Conyuge\" 3 \"Hijo\" 4 \"Otro familiar\" 5 \"No familiar\" lab val relationship rel_lbl library(metasurvey)  # Escribir el archivo .do de ejemplo en una ubicacion temporal # Nota: las macros de STATA usan backtick-quote (`var') que construimos con paste0 bt <- \"`\" # backtick sq <- \"'\" # comilla simple do_lines <- c(   \"rename id hh_id\",   \"rename nper person_id\",   \"gen weight_yr = pesoano\",   \"gen weight_qt = pesotri\",   \"gen sex = q01\",   \"g relationship = -9\",   \"replace relationship = 1 if q05 == 1\",   \"replace relationship = 2 if q05 == 2\",   \"replace relationship = 3 if inrange(q05, 3, 5)\",   \"replace relationship = 4 if q05 == 6\",   \"replace relationship = 5 if q05 == 7\",   \"gen area = .\",   \"replace area = 1 if region == 1\",   \"replace area = 2 if region == 2\",   \"replace area = 3 if region == 3\",   \"recode q20 (2=2) (3=-9) (4=3) (5=4), gen(edu_compat)\",   \"bysort hh_id: egen max_age = max(edad)\",   \"bysort hh_id: egen n_members = count(person_id)\",   \"foreach i of numlist 1/3 {\",   paste0(\"gen contrib\", bt, \"i\", sq, \" = 0\"),   paste0(\"replace contrib\", bt, \"i\", sq, \" = amount if provider == \", bt, \"i\", sq),   \"}\",   \"mvencode contrib1 contrib2 contrib3, mv(0)\",   \"drop region q01 q05 q20\",   'lab var sex \"Sexo\"',   'lab var relationship \"Relacion con el jefe de hogar\"',   'lab def sex_lbl 1 \"Hombre\" 2 \"Mujer\"',   \"lab val sex sex_lbl\",   'lab def rel_lbl 1 \"Jefe\" 2 \"Conyuge\" 3 \"Hijo\" 4 \"Otro familiar\" 5 \"No familiar\"',   \"lab val relationship rel_lbl\" ) do_file <- tempfile(fileext = \".do\") writeLines(do_lines, do_file)  result <- transpile_stata(do_file)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"inspeccionando-la-salida","dir":"Articles","previous_headings":"Un ejemplo realista","what":"Inspeccionando la salida","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"","code":"cat(\"Traducidos:\", result$stats$translated, \"\\n\") #> Traducidos: 27 cat(\"Omitidos:  \", result$stats$skipped, \"\\n\") #> Omitidos:   6 cat(\"Manual:    \", result$stats$manual_review, \"\\n\") #> Manual:     0 # Imprimir los steps generados for (s in result$steps) cat(s, \"\\n\") #> step_rename(svy, hh_id = \"id\", person_id = \"nper\")  #> step_compute(svy, weight_yr = pesoano, weight_qt = pesotri, sex = q01)  #> step_recode(svy, relationship, #>     q05 == 1 ~ \"1\", #>     q05 == 2 ~ \"2\", #>     (q05 >= 3 & q05 <= 5) ~ \"3\", #>     q05 == 6 ~ \"4\", #>     q05 == 7 ~ \"5\", #>     .default = \"-9\")  #> step_compute(svy, area = NA, area = data.table::fifelse(region == 1, 1, area), area = data.table::fifelse(region == 2, 2, area), area = data.table::fifelse(region == 3, 3, area), edu_compat = q20, edu_compat = data.table::fifelse(q20 == 2, 2, edu_compat), edu_compat = data.table::fifelse(q20 == 3, -9, edu_compat), edu_compat = data.table::fifelse(q20 == 4, 3, edu_compat), edu_compat = data.table::fifelse(q20 == 5, 4, edu_compat))  #> step_compute(svy, max_age = max(edad, na.rm = TRUE), n_members = sum(!is.na(person_id)), .by = \"hh_id\")  #> step_compute(svy, contrib1 = 0, contrib1 = data.table::fifelse(provider == 1, amount, contrib1), contrib2 = 0, contrib2 = data.table::fifelse(provider == 2, amount, contrib2), contrib3 = 0, contrib3 = data.table::fifelse(provider == 3, amount, contrib3), contrib1 = data.table::fifelse(is.na(contrib1), 0, contrib1), contrib2 = data.table::fifelse(is.na(contrib2), 0, contrib2), contrib3 = data.table::fifelse(is.na(contrib3), 0, contrib3))  #> step_remove(svy, region, q01, q05, q20)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"etiquetas-1","dir":"Articles","previous_headings":"Un ejemplo realista","what":"Etiquetas","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"","code":"str(result$labels$var_labels) #> List of 2 #>  $ sex         : chr \"Sexo\" #>  $ relationship: chr \"Relacion con el jefe de hogar\" str(result$labels$val_labels) #> List of 2 #>  $ sex         :List of 2 #>   ..$ 1: chr \"Hombre\" #>   ..$ 2: chr \"Mujer\" #>  $ relationship:List of 5 #>   ..$ 1: chr \"Jefe\" #>   ..$ 2: chr \"Conyuge\" #>   ..$ 3: chr \"Hijo\" #>   ..$ 4: chr \"Otro familiar\" #>   ..$ 5: chr \"No familiar\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"construir-una-recipe-a-partir-de-los-steps-transpilados","dir":"Articles","previous_headings":"Un ejemplo realista","what":"Construir una Recipe a partir de los steps transpilados","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"","code":"rec <- Recipe$new(   id = \"example_demographics\",   name = \"Demografia (transpilada)\",   user = \"equipo_investigacion\",   edition = \"2022\",   survey_type = \"ech\",   default_engine = \"data.table\",   depends_on = character(0),   description = \"Demografia armonizada desde transpilacion de STATA\",   steps = result$steps,   labels = result$labels )  # Guardar como JSON save_recipe(rec, \"demographics_recipe.json\")  # Aplicar a datos de encuesta svy <- survey_empty(type = \"ech\", edition = \"2022\") |>   set_data(my_data) |>   add_recipe(rec) |>   bake_recipes()"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"transpilacion-a-nivel-de-modulo","dir":"Articles","previous_headings":"","what":"Transpilacion a nivel de modulo","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"Para proyectos que organizan archivos .por anio y modulo tematico, transpile_stata_module() procesa un directorio de un anio completo y agrupa los resultados en objetos Recipe separados:","code":"recipes <- transpile_stata_module(   year_dir = \"do_files/2022\",   year = 2022,   user = \"equipo_investigacion\",   output_dir = \"recipes/\" )  names(recipes) #> [1] \"data_prep\"        \"demographics\"     \"income_detail\" #> [4] \"income_aggregate\" \"cleanup\"  # Cada receta tiene dependencias inter-modulo recipes$income_detail$depends_on_recipes #> [1] \"ech_2022_data_prep\"    \"ech_2022_demographics\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"analisis-de-cobertura","dir":"Articles","previous_headings":"","what":"Analisis de cobertura","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"transpile_coverage() reporta cuantos comandos en un archivo .(o directorio) pueden transpilarse automaticamente: La columna coverage_pct reporta el porcentaje de comandos que transforman datos que fueron traducidos (excluyendo comandos -datos omitidos). Un valor por debajo de 100% significa que algunos comandos necesitan revision manual – consultar el elemento $warnings para detalles.","code":"transpile_coverage(\"do_files/\") #>                               file total translated skipped manual coverage #> 1   2022/2_correc_datos.do             82        60      22      0   100.00 #> 2   2022/3_compatibiliz...do          420       380      40      0   100.00 #> 3   2022/4_ingreso_ht11...do          310       270      40      0   100.00"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler-es.html","id":"limitaciones","dir":"Articles","previous_headings":"","what":"Limitaciones","title":"Transpilando archivos .do de STATA a Recetas metasurvey (ES)","text":"El transpilador maneja: Comandos merge (dependen de archivos externos y se traducen como comentarios con # MANUAL_REVIEW) collapse / reshape (transformaciones estructurales de datos) Definiciones de program personalizados Bloques mata o llamadas plugin Comentarios de bloque /* */ anidados que contienen continuaciones de linea /* */ internamente (raro; solo visto en codigo legacy comentado) Los comandos que quedan fuera del alcance del transpilador se marcan con # MANUAL_REVIEW en la salida y se cuentan en $stats$manual_review.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"motivation","dir":"Articles","previous_headings":"","what":"Motivation","title":"Transpiling STATA do-files to metasurvey Recipes","text":"Many Latin American research groups maintain decades STATA .files process household survey microdata. scripts encode institutional knowledge variable harmonization, income decomposition, indicator construction – locked format hard version, share, integrate modern R workflows. metasurvey transpiler converts STATA .files metasurvey Recipe objects. enables: Reproducibility: STATA pipelines become version-controlled JSON recipes Interoperability: recipe runs data.table-backed Survey object Discovery: transpiled recipes can published metasurvey API researchers find reuse transpiler handles common STATA patterns found survey processing scripts: variable generation, conditional replacement, recoding, aggregation, loops, missing-value encoding, label extraction.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick start","title":"Transpiling STATA do-files to metasurvey Recipes","text":"result list four elements:","code":"library(metasurvey)  # Transpile a single .do file result <- transpile_stata(\"demographics.do\") result$steps[1:3] #> [1] \"step_rename(svy, hh_id = \\\"id\\\", person_id = \\\"nper\\\")\" #> [2] \"step_compute(svy, weight_yr = pesoano)\" #> [3] \"step_compute(svy, sex = e26)\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"transpilation-pipeline","dir":"Articles","previous_headings":"","what":"Transpilation pipeline","title":"Transpiling STATA do-files to metasurvey Recipes","text":"transpiler works four passes:","code":".do file      |      v   [1] parse_do_file()      -- tokenize lines into command objects      |      v   [2] translate_commands()  -- map each STATA command to metasurvey steps      |      v   [3] optimize_steps()      -- consolidate consecutive renames, drops, etc.      |      v   [4] Recipe / JSON         -- bundle steps with metadata"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"pass-1-parsing","dir":"Articles","previous_headings":"Transpilation pipeline","what":"Pass 1: Parsing","title":"Transpiling STATA do-files to metasurvey Recipes","text":"parse_do_file() reads .file produces list command objects. handles: Comment stripping: *, //, /* */ block comments Line continuation: /// /* */ used continuation markers Loop expansion: foreach forvalues unrolled, substituting backtick macros (`var') iteration value Prefix handling: capture, bysort group:, command abbreviations (g gen, cap capture)","code":"commands <- parse_do_file(\"demographics.do\") commands[[1]] #> $cmd #> [1] \"gen\" #> $args #> [1] \"sex = e26\" #> $if_clause #> NULL #> $by_group #> NULL #> $capture #> [1] FALSE"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"pass-2-command-translation","dir":"Articles","previous_headings":"Transpilation pipeline","what":"Pass 2: Command translation","title":"Transpiling STATA do-files to metasurvey Recipes","text":"parsed command mapped one metasurvey step strings. following table shows supported STATA commands translations.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"gen-generate","dir":"Articles","previous_headings":"Supported patterns","what":"gen / generate","title":"Transpiling STATA do-files to metasurvey Recipes","text":"Simple variable creation translates step_compute: gen includes clause, condition wrapped fifelse:","code":"gen sex = q01 gen is_urban = (region < 3) gen byte age_group = -9 step_compute(svy, sex = q01) step_compute(svy, is_urban = (region < 3)) step_compute(svy, age_group = -9L) gen employed = hours_worked if age >= 14 step_compute(svy, employed = data.table::fifelse(age >= 14, hours_worked, NA))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"gen-replace-chains-the-dominant-pattern","dir":"Articles","previous_headings":"Supported patterns","what":"gen + replace chains (the dominant pattern)","title":"Transpiling STATA do-files to metasurvey Recipes","text":"common pattern survey .files initializing variable filling conditional replacements: right-hand sides constants, transpiler emits single step_recode: right-hand side expression, transpiler emits chain step_compute fifelse:","code":"gen relationship = -9 replace relationship = 1 if q05 == 1 replace relationship = 2 if q05 == 2 replace relationship = 3 if inrange(q05, 3, 5) replace relationship = 4 if q05 == 6 step_recode(svy, relationship,     q05 == 1 ~ 1L,     q05 == 2 ~ 2L,     q05 >= 3 & q05 <= 5 ~ 3L,     q05 == 6 ~ 4L,     .default = -9L) gen labour_inc = 0 replace labour_inc = wage if job_type == 1 replace labour_inc = wage + bonus if job_type == 2 step_compute(svy, labour_inc = 0L) step_compute(svy, labour_inc = data.table::fifelse(     job_type == 1, wage, labour_inc)) step_compute(svy, labour_inc = data.table::fifelse(     job_type == 2, wage + bonus, labour_inc))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"recode","dir":"Articles","previous_headings":"Supported patterns","what":"recode","title":"Transpiling STATA do-files to metasurvey Recipes","text":"STATA recode parenthesized mappings inline syntax:","code":"recode urban_filter (0=2) recode edu_level (2=2) (3=-9) (4=3) (5=4), gen(edu_compat) recode var1 var2 var3 .=0 step_compute(svy, urban_filter = data.table::fifelse(     urban_filter == 0, 2, urban_filter))  step_compute(svy, edu_compat = edu_level) step_compute(svy, edu_compat = data.table::fifelse(     edu_compat == 2, 2, edu_compat)) # ... one fifelse per mapping  # Multi-variable recode: one step per variable step_compute(svy, var1 = data.table::fifelse(is.na(var1), 0, var1)) step_compute(svy, var2 = data.table::fifelse(is.na(var2), 0, var2)) step_compute(svy, var3 = data.table::fifelse(is.na(var3), 0, var3))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"egen-aggregation-with-by-groups","dir":"Articles","previous_headings":"Supported patterns","what":"egen (aggregation with by-groups)","title":"Transpiling STATA do-files to metasurvey Recipes","text":"Supported egen functions: sum, max, min, mean, count, sd, median, total, rowtotal, rowmean.","code":"bysort household: egen hh_income = sum(income) egen max_age = max(age), by(household) step_compute(svy, hh_income = sum(income, na.rm = TRUE),     .by = \"household\") step_compute(svy, max_age = max(age, na.rm = TRUE),     .by = \"household\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"foreach-loops","dir":"Articles","previous_headings":"Supported patterns","what":"foreach loops","title":"Transpiling STATA do-files to metasurvey Recipes","text":"Loops expanded parsing. transpiler unrolls foreach lists numlist ranges, including nested loops: Expands 4 pairs gen+replace, transpiled independently:","code":"foreach i of numlist 1/4 {     gen contrib`i' = 0     replace contrib`i' = amount if provider == `i' } step_recode(svy, contrib1, provider == 1 ~ amount, .default = 0L) step_recode(svy, contrib2, provider == 2 ~ amount, .default = 0L) step_recode(svy, contrib3, provider == 3 ~ amount, .default = 0L) step_recode(svy, contrib4, provider == 4 ~ amount, .default = 0L)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"mvencode-missing-value-encoding","dir":"Articles","previous_headings":"Supported patterns","what":"mvencode (missing value encoding)","title":"Transpiling STATA do-files to metasurvey Recipes","text":"","code":"mvencode income_1 income_2 income_3, mv(0) step_compute(svy, income_1 = data.table::fifelse(     is.na(income_1), 0, income_1)) step_compute(svy, income_2 = data.table::fifelse(     is.na(income_2), 0, income_2)) step_compute(svy, income_3 = data.table::fifelse(     is.na(income_3), 0, income_3))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"destring","dir":"Articles","previous_headings":"Supported patterns","what":"destring","title":"Transpiling STATA do-files to metasurvey Recipes","text":"","code":"destring wage bonus, replace force step_compute(svy, wage = suppressWarnings(     as.numeric(as.character(wage)))) step_compute(svy, bonus = suppressWarnings(     as.numeric(as.character(bonus))))"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"rename-drop-keep","dir":"Articles","previous_headings":"Supported patterns","what":"rename, drop, keep","title":"Transpiling STATA do-files to metasurvey Recipes","text":"Consecutive renames consolidated single step_rename call, consecutive drops merged one step_remove.","code":"rename id hh_id drop aux1 aux2 aux3 step_rename(svy, hh_id = \"id\") step_remove(svy, aux1, aux2, aux3)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"stata-expression-translation","dir":"Articles","previous_headings":"Supported patterns","what":"STATA expression translation","title":"Transpiling STATA do-files to metasurvey Recipes","text":"STATA-specific syntax expressions automatically translated:","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"variable-ranges","dir":"Articles","previous_headings":"Supported patterns","what":"Variable ranges","title":"Transpiling STATA do-files to metasurvey Recipes","text":"STATA allows variable ranges like aux1-aux4 meaning aux1 aux2 aux3 aux4. transpiler expands drop, recode, mvencode commands:","code":"drop contrib1-contrib4 step_remove(svy, contrib1, contrib2, contrib3, contrib4)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"labels","dir":"Articles","previous_headings":"Supported patterns","what":"Labels","title":"Transpiling STATA do-files to metasurvey Recipes","text":"Variable value labels extracted stored recipe metadata:","code":"lab var sex \"Sex of respondent\" lab def sex_lbl 1 \"Male\" 2 \"Female\" lab val sex sex_lbl result$labels #> $var_labels #> $var_labels$sex #> [1] \"Sex of respondent\" #> #> $val_labels #> $val_labels$sex #> $val_labels$sex$`1` #> [1] \"Male\" #> $val_labels$sex$`2` #> [1] \"Female\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"skipped-commands","dir":"Articles","previous_headings":"","what":"Skipped commands","title":"Transpiling STATA do-files to metasurvey Recipes","text":"Commands modify survey data silently skipped transpilation. include: /O: use, save, import, export, insheet, outsheet Display: tabulate, summarize, describe, list, browse, display Control flow: /else, , program, exit Settings: set, sort, order, compress, format Macros: global, local, scalar, matrix $stats element result reports many commands fell category.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"a-realistic-example","dir":"Articles","previous_headings":"","what":"A realistic example","title":"Transpiling STATA do-files to metasurvey Recipes","text":"following .file simplified version typical survey demographics module. real production script, uses patterns found actual ECH processing pipelines. Save demo_module.:","code":"* ────────────────────────────────────────────── * Demographics module -- simplified example * ──────────────────────────────────────────────  rename id hh_id rename nper person_id  gen weight_yr = pesoano gen weight_qt = pesotri  * ── Sex ── gen sex = q01  * ── Relationship to head ── g relationship = -9 replace relationship = 1 if q05 == 1 replace relationship = 2 if q05 == 2 replace relationship = 3 if inrange(q05, 3, 5) replace relationship = 4 if q05 == 6 replace relationship = 5 if q05 == 7  * ── Area ── gen area = . replace area = 1 if region == 1 replace area = 2 if region == 2 replace area = 3 if region == 3  * ── Education level (harmonized) ── recode q20 (2=2) (3=-9) (4=3) (5=4), gen(edu_compat)  * ── Household-level age stats ── bysort hh_id: egen max_age = max(edad) bysort hh_id: egen n_members = count(person_id)  * ── Initialize health insurance contributions ── foreach i of numlist 1/3 {     gen contrib`i' = 0     replace contrib`i' = amount if provider == `i' }  * ── Encode missing values ── mvencode contrib1 contrib2 contrib3, mv(0)  * ── Clean up ── drop region q01 q05 q20  * ── Labels ── lab var sex \"Sex\" lab var relationship \"Relationship to household head\" lab def sex_lbl 1 \"Male\" 2 \"Female\" lab val sex sex_lbl lab def rel_lbl 1 \"Head\" 2 \"Spouse\" 3 \"Child\" 4 \"Other relative\" 5 \"Non-relative\" lab val relationship rel_lbl library(metasurvey)  # Write the example do-file to a temp location # Note: STATA macros use backtick-quote (`var') which we build with paste0 bt <- \"`\" # backtick sq <- \"'\" # single quote do_lines <- c(   \"rename id hh_id\",   \"rename nper person_id\",   \"gen weight_yr = pesoano\",   \"gen weight_qt = pesotri\",   \"gen sex = q01\",   \"g relationship = -9\",   \"replace relationship = 1 if q05 == 1\",   \"replace relationship = 2 if q05 == 2\",   \"replace relationship = 3 if inrange(q05, 3, 5)\",   \"replace relationship = 4 if q05 == 6\",   \"replace relationship = 5 if q05 == 7\",   \"gen area = .\",   \"replace area = 1 if region == 1\",   \"replace area = 2 if region == 2\",   \"replace area = 3 if region == 3\",   \"recode q20 (2=2) (3=-9) (4=3) (5=4), gen(edu_compat)\",   \"bysort hh_id: egen max_age = max(edad)\",   \"bysort hh_id: egen n_members = count(person_id)\",   \"foreach i of numlist 1/3 {\",   paste0(\"gen contrib\", bt, \"i\", sq, \" = 0\"),   paste0(\"replace contrib\", bt, \"i\", sq, \" = amount if provider == \", bt, \"i\", sq),   \"}\",   \"mvencode contrib1 contrib2 contrib3, mv(0)\",   \"drop region q01 q05 q20\",   'lab var sex \"Sex\"',   'lab var relationship \"Relationship to household head\"',   'lab def sex_lbl 1 \"Male\" 2 \"Female\"',   \"lab val sex sex_lbl\",   'lab def rel_lbl 1 \"Head\" 2 \"Spouse\" 3 \"Child\" 4 \"Other relative\" 5 \"Non-relative\"',   \"lab val relationship rel_lbl\" ) do_file <- tempfile(fileext = \".do\") writeLines(do_lines, do_file)  result <- transpile_stata(do_file)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"inspecting-the-output","dir":"Articles","previous_headings":"A realistic example","what":"Inspecting the output","title":"Transpiling STATA do-files to metasurvey Recipes","text":"","code":"cat(\"Translated:\", result$stats$translated, \"\\n\") #> Translated: 27 cat(\"Skipped:   \", result$stats$skipped, \"\\n\") #> Skipped:    6 cat(\"Manual:    \", result$stats$manual_review, \"\\n\") #> Manual:     0 # Print the generated steps for (s in result$steps) cat(s, \"\\n\") #> step_rename(svy, hh_id = \"id\", person_id = \"nper\")  #> step_compute(svy, weight_yr = pesoano, weight_qt = pesotri, sex = q01)  #> step_recode(svy, relationship, #>     q05 == 1 ~ \"1\", #>     q05 == 2 ~ \"2\", #>     (q05 >= 3 & q05 <= 5) ~ \"3\", #>     q05 == 6 ~ \"4\", #>     q05 == 7 ~ \"5\", #>     .default = \"-9\")  #> step_compute(svy, area = NA, area = data.table::fifelse(region == 1, 1, area), area = data.table::fifelse(region == 2, 2, area), area = data.table::fifelse(region == 3, 3, area), edu_compat = q20, edu_compat = data.table::fifelse(q20 == 2, 2, edu_compat), edu_compat = data.table::fifelse(q20 == 3, -9, edu_compat), edu_compat = data.table::fifelse(q20 == 4, 3, edu_compat), edu_compat = data.table::fifelse(q20 == 5, 4, edu_compat))  #> step_compute(svy, max_age = max(edad, na.rm = TRUE), n_members = sum(!is.na(person_id)), .by = \"hh_id\")  #> step_compute(svy, contrib1 = 0, contrib1 = data.table::fifelse(provider == 1, amount, contrib1), contrib2 = 0, contrib2 = data.table::fifelse(provider == 2, amount, contrib2), contrib3 = 0, contrib3 = data.table::fifelse(provider == 3, amount, contrib3), contrib1 = data.table::fifelse(is.na(contrib1), 0, contrib1), contrib2 = data.table::fifelse(is.na(contrib2), 0, contrib2), contrib3 = data.table::fifelse(is.na(contrib3), 0, contrib3))  #> step_remove(svy, region, q01, q05, q20)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"labels-1","dir":"Articles","previous_headings":"A realistic example","what":"Labels","title":"Transpiling STATA do-files to metasurvey Recipes","text":"","code":"str(result$labels$var_labels) #> List of 2 #>  $ sex         : chr \"Sex\" #>  $ relationship: chr \"Relationship to household head\" str(result$labels$val_labels) #> List of 2 #>  $ sex         :List of 2 #>   ..$ 1: chr \"Male\" #>   ..$ 2: chr \"Female\" #>  $ relationship:List of 5 #>   ..$ 1: chr \"Head\" #>   ..$ 2: chr \"Spouse\" #>   ..$ 3: chr \"Child\" #>   ..$ 4: chr \"Other relative\" #>   ..$ 5: chr \"Non-relative\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"building-a-recipe-from-transpiled-steps","dir":"Articles","previous_headings":"A realistic example","what":"Building a Recipe from transpiled steps","title":"Transpiling STATA do-files to metasurvey Recipes","text":"","code":"rec <- Recipe$new(   id = \"example_demographics\",   name = \"Demographics (transpiled)\",   user = \"research_team\",   edition = \"2022\",   survey_type = \"ech\",   default_engine = \"data.table\",   depends_on = character(0),   description = \"Harmonized demographics from STATA transpilation\",   steps = result$steps,   labels = result$labels )  # Save as JSON save_recipe(rec, \"demographics_recipe.json\")  # Apply to survey data svy <- survey_empty(type = \"ech\", edition = \"2022\") |>   set_data(my_data) |>   add_recipe(rec) |>   bake_recipes()"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"module-level-transpilation","dir":"Articles","previous_headings":"","what":"Module-level transpilation","title":"Transpiling STATA do-files to metasurvey Recipes","text":"projects organize .files year thematic module, transpile_stata_module() processes entire year directory groups results separate Recipe objects:","code":"recipes <- transpile_stata_module(   year_dir = \"do_files/2022\",   year = 2022,   user = \"research_team\",   output_dir = \"recipes/\" )  names(recipes) #> [1] \"data_prep\"        \"demographics\"     \"income_detail\" #> [4] \"income_aggregate\" \"cleanup\"  # Each recipe has inter-module dependencies recipes$income_detail$depends_on_recipes #> [1] \"ech_2022_data_prep\"    \"ech_2022_demographics\""},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"coverage-analysis","dir":"Articles","previous_headings":"","what":"Coverage analysis","title":"Transpiling STATA do-files to metasurvey Recipes","text":"transpile_coverage() reports many commands .file (directory) can automatically transpiled: coverage_pct column reports percentage data-transforming commands translated (excluding skipped non-data commands). value 100% means commands need manual review – look $warnings element details.","code":"transpile_coverage(\"do_files/\") #>                               file total translated skipped manual coverage #> 1   2022/2_correc_datos.do             82        60      22      0   100.00 #> 2   2022/3_compatibiliz...do          420       380      40      0   100.00 #> 3   2022/4_ingreso_ht11...do          310       270      40      0   100.00"},{"path":"https://metasurveyr.github.io/metasurvey/articles/stata-transpiler.html","id":"limitations","dir":"Articles","previous_headings":"","what":"Limitations","title":"Transpiling STATA do-files to metasurvey Recipes","text":"transpiler handle: merge commands (depend external files translated comments # MANUAL_REVIEW) collapse / reshape (structural data transformations) Custom program definitions mata blocks plugin calls Nested /* */ block comments contain /* */ line continuations internally (rare; seen commented-legacy code) Commands fall outside transpiler’s scope flagged # MANUAL_REVIEW output counted $stats$manual_review.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"que-es-un-workflow","dir":"Articles","previous_headings":"","what":"Que es un Workflow?","title":"Flujos de Trabajo y Estimacion (ES)","text":"Luego de transformar los datos de la encuesta con steps y recipes, la siguiente tarea es la estimacion: calcular medias, totales, razones y sus errores estandar teniendo en cuenta el diseno complejo de la encuesta. La funcion workflow() envuelve los estimadores del paquete survey (svymean, svytotal, svyratio, svyby) y devuelve resultados ordenados en formato data.table que incluyen: Estimaciones puntuales y errores estandar Coeficientes de variacion (CV) Intervalos de confianza Metadatos para la reproducibilidad","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"configuracion-inicial","dir":"Articles","previous_headings":"","what":"Configuracion inicial","title":"Flujos de Trabajo y Estimacion (ES)","text":"Utilizamos el conjunto de datos Academic Performance Index (API) del paquete survey, que contiene datos reales de escuelas estratificadas de California.","code":"library(metasurvey) library(survey) library(data.table)  data(api, package = \"survey\") dt <- data.table(apistrat)  svy <- Survey$new(   data    = dt,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\") )"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"media","dir":"Articles","previous_headings":"Estimacion basica","what":"Media","title":"Flujos de Trabajo y Estimacion (ES)","text":"Estimamos la media poblacional del puntaje API en el ano 2000:","code":"result <- workflow(   list(svy),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"annual\" )  result #>                      stat    value       se         cv confint_lower #>                    <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: api00 662.2874 9.585429 0.01447322      643.5003 #>    confint_upper #>            <num> #> 1:      681.0745"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"total","dir":"Articles","previous_headings":"Estimacion basica","what":"Total","title":"Flujos de Trabajo y Estimacion (ES)","text":"Estimamos la matriculacion total en todas las escuelas:","code":"result_total <- workflow(   list(svy),   survey::svytotal(~enroll, na.rm = TRUE),   estimation_type = \"annual\" )  result_total #>                        stat   value       se         cv confint_lower #>                      <char>   <num>    <num>      <num>         <num> #> 1: survey::svytotal: enroll 3687178 164532.3 0.04462283       3364700 #>    confint_upper #>            <num> #> 1:       4009655"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"multiples-estimaciones-a-la-vez","dir":"Articles","previous_headings":"Estimacion basica","what":"Multiples estimaciones a la vez","title":"Flujos de Trabajo y Estimacion (ES)","text":"Es posible pasar varias llamadas de estimacion workflow() para calcularlas en un unico paso:","code":"results <- workflow(   list(svy),   survey::svymean(~api00, na.rm = TRUE),   survey::svytotal(~enroll, na.rm = TRUE),   estimation_type = \"annual\" )  results #>                        stat        value           se         cv confint_lower #>                      <char>        <num>        <num>      <num>         <num> #> 1:   survey::svymean: api00     662.2874 9.585429e+00 0.01447322      643.5003 #> 2: survey::svytotal: enroll 3687177.5324 1.645323e+05 0.04462283  3364700.1537 #>    confint_upper #>            <num> #> 1:      681.0745 #> 2:  4009654.9112"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"estimacion-por-dominio","dir":"Articles","previous_headings":"","what":"Estimacion por dominio","title":"Flujos de Trabajo y Estimacion (ES)","text":"Utilizamos survey::svyby() para calcular estimaciones por subpoblaciones (dominios):","code":"# Mean API score by school type api_by_type <- workflow(   list(svy),   survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  api_by_type #>                              stat  value       se         cv confint_lower #>                            <char>  <num>    <num>      <num>         <num> #> 1: survey::svyby: api00 [stype=E] 674.43 12.49343 0.01852443      649.9433 #> 2: survey::svyby: api00 [stype=H] 625.82 15.34078 0.02451309      595.7526 #> 3: survey::svyby: api00 [stype=M] 636.60 16.50239 0.02592270      604.2559 #>    confint_upper  stype #>            <num> <fctr> #> 1:      698.9167      E #> 2:      655.8874      H #> 3:      668.9441      M # Mean enrollment by awards status enroll_by_award <- workflow(   list(svy),   survey::svyby(~enroll, ~awards, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  enroll_by_award #>                                  stat    value       se         cv #>                                <char>    <num>    <num>      <num> #> 1:  survey::svyby: enroll [awards=No] 727.5958 57.54094 0.07908366 #> 2: survey::svyby: enroll [awards=Yes] 520.5114 25.51854 0.04902590 #>    confint_lower confint_upper awards #>            <num>         <num> <fctr> #> 1:      614.8177      840.3740     No #> 2:      470.4960      570.5269    Yes"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"evaluacion-de-la-calidad","dir":"Articles","previous_headings":"","what":"Evaluacion de la calidad","title":"Flujos de Trabajo y Estimacion (ES)","text":"El coeficiente de variacion (CV) mide la precision de la estimacion. Se puede utilizar evaluate_cv() para clasificar la calidad siguiendo las directrices estandar:","code":"# Evaluate quality of the API score estimate cv_pct <- results$cv[1] * 100 quality <- evaluate_cv(cv_pct)  cat(\"CV:\", round(cv_pct, 2), \"%\\n\") #> CV: 1.45 % cat(\"Quality:\", quality, \"\\n\") #> Quality: Excellent"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"recipeworkflow-estimaciones-publicables","dir":"Articles","previous_headings":"","what":"RecipeWorkflow: Estimaciones publicables","title":"Flujos de Trabajo y Estimacion (ES)","text":"Un RecipeWorkflow agrupa llamadas de estimacion con metadatos, lo que hace que el analisis sea reproducible y compartible. Registra: Que recipes se utilizaron para la preparacion de los datos Que llamadas de estimacion se realizaron Informacion de autoria y versionado","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"creacion-de-un-recipeworkflow","dir":"Articles","previous_headings":"RecipeWorkflow: Estimaciones publicables","what":"Creacion de un RecipeWorkflow","title":"Flujos de Trabajo y Estimacion (ES)","text":"","code":"wf <- RecipeWorkflow$new(   name = \"API Score Analysis 2000\",   description = \"Mean API score estimation by school type\",   user = \"Research Team\",   survey_type = \"api\",   edition = \"2000\",   estimation_type = \"annual\",   recipe_ids = character(0),   calls = list(     \"survey::svymean(~api00, na.rm = TRUE)\",     \"survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE)\"   ) )  wf #>  #> ── Workflow: API Score Analysis 2000 ── #> Author:  Research Team #> Survey:  api / 2000 #> Version: 1.0.0 #> Description: Mean API score estimation by school type #> Certification: community #> Estimation types: annual #>  #> ── Calls (2) ── #>   1. survey::svymean(~api00, na.rm = TRUE) #>   2. survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"publicacion-en-el-registro","dir":"Articles","previous_headings":"RecipeWorkflow: Estimaciones publicables","what":"Publicacion en el registro","title":"Flujos de Trabajo y Estimacion (ES)","text":"Publicamos el workflow para que otros puedan descubrirlo y reutilizarlo:","code":"# Configure a local backend wf_path <- tempfile(fileext = \".json\") set_workflow_backend(\"local\", path = wf_path)  # Publish publish_workflow(wf)  # Discover workflows all_wf <- list_workflows() length(all_wf) #> [1] 1  # Search by text found <- search_workflows(\"income\") length(found) #> [1] 0  # Filter by survey type ech_wf <- filter_workflows(survey_type = \"ech\") length(ech_wf) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"busqueda-de-workflows-asociados-a-un-recipe","dir":"Articles","previous_headings":"RecipeWorkflow: Estimaciones publicables","what":"Busqueda de workflows asociados a un recipe","title":"Flujos de Trabajo y Estimacion (ES)","text":"Si se dispone de un recipe y se desea conocer que estimaciones han sido publicadas para el mismo, se puede utilizar find_workflows_for_recipe():","code":"# Create a workflow that references a recipe wf2 <- RecipeWorkflow$new(   name            = \"Labor Market Estimates\",   user            = \"Team\",   survey_type     = \"ech\",   edition         = \"2023\",   estimation_type = \"annual\",   recipe_ids      = c(\"labor_force_recipe_001\"),   calls           = list(\"survey::svymean(~employed, na.rm = TRUE)\") )  publish_workflow(wf2)  # Find all workflows that use this recipe related <- find_workflows_for_recipe(\"labor_force_recipe_001\") length(related) #> [1] 1 if (length(related) > 0) cat(\"Found:\", related[[1]]$name, \"\\n\") #> Found: Labor Market Estimates"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"compartir-mediante-la-api-remota","dir":"Articles","previous_headings":"","what":"Compartir mediante la API remota","title":"Flujos de Trabajo y Estimacion (ES)","text":"Para una difusion mas amplia, es posible publicar workflows en la API de metasurvey:","code":"# Requires authentication api_login(\"you@example.com\", \"password\")  # Publish api_publish_workflow(wf)  # Browse all <- api_list_workflows(survey_type = \"ech\") specific <- api_get_workflow(\"workflow_id_here\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"pipeline-completo","dir":"Articles","previous_headings":"","what":"Pipeline completo","title":"Flujos de Trabajo y Estimacion (ES)","text":"continuacion se presenta un pipeline completo desde los datos crudos hasta la estimacion publicable, utilizando el conjunto de datos API:","code":"# 1. Create survey from real data dt_full <- data.table(apistrat)  svy_full <- Survey$new(   data    = dt_full,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\") )  # 2. Apply steps: compute derived variables svy_full <- step_compute(svy_full,   api_growth = api00 - api99,   high_growth = ifelse(api00 - api99 > 50, 1L, 0L),   comment = \"API score growth indicators\" )  svy_full <- step_recode(svy_full, school_level,   stype == \"E\" ~ \"Elementary\",   stype == \"M\" ~ \"Middle\",   stype == \"H\" ~ \"High\",   .default = \"Other\",   comment = \"School level classification\" )  # 3. Estimate means estimates <- workflow(   list(svy_full),   survey::svymean(~api_growth, na.rm = TRUE),   survey::svymean(~high_growth, na.rm = TRUE),   estimation_type = \"annual\" )  estimates #>                            stat      value        se         cv confint_lower #>                          <char>      <num>     <num>      <num>         <num> #> 1:  survey::svymean: api_growth 32.8925184 2.1583789 0.06561914    28.6621734 #> 2: survey::svymean: high_growth  0.2938489 0.0363651 0.12375443     0.2225746 #>    confint_upper #>            <num> #> 1:    37.1228633 #> 2:     0.3651232 # 4. Domain estimation (by school type) by_school <- workflow(   list(svy_full),   survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  by_school #>                              stat  value       se         cv confint_lower #>                            <char>  <num>    <num>      <num>         <num> #> 1: survey::svyby: api00 [stype=E] 674.43 12.49343 0.01852443      649.9433 #> 2: survey::svyby: api00 [stype=H] 625.82 15.34078 0.02451309      595.7526 #> 3: survey::svyby: api00 [stype=M] 636.60 16.50239 0.02592270      604.2559 #>    confint_upper  stype #>            <num> <fctr> #> 1:      698.9167      E #> 2:      655.8874      H #> 3:      668.9441      M # 5. Assess quality for (i in seq_len(nrow(estimates))) {   cv_val <- estimates$cv[i] * 100   cat(     estimates$stat[i], \":\",     round(cv_val, 1), \"% CV -\",     evaluate_cv(cv_val), \"\\n\"   ) } #> survey::svymean: api_growth : 6.6 % CV - Very good  #> survey::svymean: high_growth : 12.4 % CV - Good"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"provenance-linaje-de-datos","dir":"Articles","previous_headings":"","what":"Provenance: Linaje de datos","title":"Flujos de Trabajo y Estimacion (ES)","text":"Cada objeto Survey registra metadatos de provenance: de donde vinieron los datos, que steps se aplicaron, cuantas filas sobrevivieron cada paso y que versiones de R y metasurvey se utilizaron. Esto permite rastrear cualquier estimacion hasta los datos originales. El provenance tambien se adjunta los resultados de workflow(), de modo que siempre es posible inspeccionar el linaje completo de una estimacion: Para pistas de auditoria, se exporta el provenance JSON: Para comparar dos ejecuciones (por ejemplo, diferentes ediciones), se utiliza provenance_diff():","code":"# El provenance se completa automaticamente despues de bake_steps() prov <- provenance(svy_full) prov #> ── Data Provenance ───────────────────────────────────────────────────────────── #> Loaded: 2026-02-17T15:33:59  #> Initial rows: 200  #>  #> Environment: #>   metasurvey: 0.0.21  #>   R: 4.5.2  #>   survey: 4.4.8 prov_wf <- provenance(estimates) cat(\"metasurvey version:\", prov_wf$environment$metasurvey_version, \"\\n\") #> metasurvey version: 0.0.21 cat(\"Steps applied:\", length(prov_wf$steps), \"\\n\") #> Steps applied: 0 provenance_to_json(prov, \"audit_trail.json\") diff <- provenance_diff(prov_2022, prov_2023) diff$steps_changed diff$n_final_changed"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"tablas-de-calidad-publicacion","dir":"Articles","previous_headings":"","what":"Tablas de calidad publicacion","title":"Flujos de Trabajo y Estimacion (ES)","text":"workflow_table() formatea los resultados de estimacion como tablas listas para publicar usando el paquete gt. Agrega intervalos de confianza, clasificacion de calidad del CV con colores y notas al pie basadas en el provenance. Se puede personalizar la salida: Para estimaciones por dominio, la tabla detecta automaticamente las columnas de grupo: Se exporta cualquier formato soportado por gt::gtsave():","code":"workflow_table(estimates) # Locale en espaniol, ocultar SE, titulo personalizado workflow_table(   estimates,   locale = \"es\",   show_se = FALSE,   title = \"Indicadores de crecimiento API\",   subtitle = \"Escuelas de California, 2000\" ) workflow_table(by_school) tbl <- workflow_table(estimates) gt::gtsave(tbl, \"estimates.html\") gt::gtsave(tbl, \"estimates.docx\") gt::gtsave(tbl, \"estimates.png\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation-es.html","id":"proximos-pasos","dir":"Articles","previous_headings":"","what":"Proximos pasos","title":"Flujos de Trabajo y Estimacion (ES)","text":"Creacion y publicacion de Recipes – Construir pipelines de transformacion reproducibles Disenos de encuesta y validacion – Estratificacion, conglomerados, pesos replicados Estudio de caso: ECH – Analisis completo del mercado laboral con estimacion","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"what-is-a-workflow","dir":"Articles","previous_headings":"","what":"What is a Workflow?","title":"Estimation Workflows","text":"transforming survey data steps recipes, next task estimation: computing means, totals, ratios, standard errors accounting complex survey design. workflow() function wraps estimators survey package (svymean, svytotal, svyratio, svyby) returns tidy results data.table include: Point estimates standard errors Coefficients variation (CV) Confidence intervals Metadata reproducibility","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"initial-setup","dir":"Articles","previous_headings":"","what":"Initial Setup","title":"Estimation Workflows","text":"use Academic Performance Index (API) dataset survey package, contains real data stratified schools California.","code":"library(metasurvey) library(survey) library(data.table)  data(api, package = \"survey\") dt <- data.table(apistrat)  svy <- Survey$new(   data    = dt,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\") )"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"mean","dir":"Articles","previous_headings":"Basic Estimation","what":"Mean","title":"Estimation Workflows","text":"estimate population mean API score year 2000:","code":"result <- workflow(   list(svy),   survey::svymean(~api00, na.rm = TRUE),   estimation_type = \"annual\" )  result #>                      stat    value       se         cv confint_lower #>                    <char>    <num>    <num>      <num>         <num> #> 1: survey::svymean: api00 662.2874 9.585429 0.01447322      643.5003 #>    confint_upper #>            <num> #> 1:      681.0745"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"total","dir":"Articles","previous_headings":"Basic Estimation","what":"Total","title":"Estimation Workflows","text":"estimate total enrollment across schools:","code":"result_total <- workflow(   list(svy),   survey::svytotal(~enroll, na.rm = TRUE),   estimation_type = \"annual\" )  result_total #>                        stat   value       se         cv confint_lower #>                      <char>   <num>    <num>      <num>         <num> #> 1: survey::svytotal: enroll 3687178 164532.3 0.04462283       3364700 #>    confint_upper #>            <num> #> 1:       4009655"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"multiple-estimates-at-once","dir":"Articles","previous_headings":"Basic Estimation","what":"Multiple Estimates at Once","title":"Estimation Workflows","text":"can pass multiple estimation calls workflow() compute single step:","code":"results <- workflow(   list(svy),   survey::svymean(~api00, na.rm = TRUE),   survey::svytotal(~enroll, na.rm = TRUE),   estimation_type = \"annual\" )  results #>                        stat        value           se         cv confint_lower #>                      <char>        <num>        <num>      <num>         <num> #> 1:   survey::svymean: api00     662.2874 9.585429e+00 0.01447322      643.5003 #> 2: survey::svytotal: enroll 3687177.5324 1.645323e+05 0.04462283  3364700.1537 #>    confint_upper #>            <num> #> 1:      681.0745 #> 2:  4009654.9112"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"domain-estimation","dir":"Articles","previous_headings":"","what":"Domain Estimation","title":"Estimation Workflows","text":"use survey::svyby() compute estimates subpopulations (domains):","code":"# Mean API score by school type api_by_type <- workflow(   list(svy),   survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  api_by_type #>                              stat  value       se         cv confint_lower #>                            <char>  <num>    <num>      <num>         <num> #> 1: survey::svyby: api00 [stype=E] 674.43 12.49343 0.01852443      649.9433 #> 2: survey::svyby: api00 [stype=H] 625.82 15.34078 0.02451309      595.7526 #> 3: survey::svyby: api00 [stype=M] 636.60 16.50239 0.02592270      604.2559 #>    confint_upper  stype #>            <num> <fctr> #> 1:      698.9167      E #> 2:      655.8874      H #> 3:      668.9441      M # Mean enrollment by awards status enroll_by_award <- workflow(   list(svy),   survey::svyby(~enroll, ~awards, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  enroll_by_award #>                                  stat    value       se         cv #>                                <char>    <num>    <num>      <num> #> 1:  survey::svyby: enroll [awards=No] 727.5958 57.54094 0.07908366 #> 2: survey::svyby: enroll [awards=Yes] 520.5114 25.51854 0.04902590 #>    confint_lower confint_upper awards #>            <num>         <num> <fctr> #> 1:      614.8177      840.3740     No #> 2:      470.4960      570.5269    Yes"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"quality-assessment","dir":"Articles","previous_headings":"","what":"Quality Assessment","title":"Estimation Workflows","text":"coefficient variation (CV) measures precision estimate. can use evaluate_cv() classify quality following standard guidelines:","code":"# Evaluate quality of the API score estimate cv_pct <- results$cv[1] * 100 quality <- evaluate_cv(cv_pct)  cat(\"CV:\", round(cv_pct, 2), \"%\\n\") #> CV: 1.45 % cat(\"Quality:\", quality, \"\\n\") #> Quality: Excellent"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"recipeworkflow-publishable-estimates","dir":"Articles","previous_headings":"","what":"RecipeWorkflow: Publishable Estimates","title":"Estimation Workflows","text":"RecipeWorkflow bundles estimation calls metadata, making analysis reproducible shareable. records: recipes used data preparation estimation calls performed Authorship versioning information","code":""},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"creating-a-recipeworkflow","dir":"Articles","previous_headings":"RecipeWorkflow: Publishable Estimates","what":"Creating a RecipeWorkflow","title":"Estimation Workflows","text":"","code":"wf <- RecipeWorkflow$new(   name = \"API Score Analysis 2000\",   description = \"Mean API score estimation by school type\",   user = \"Research Team\",   survey_type = \"api\",   edition = \"2000\",   estimation_type = \"annual\",   recipe_ids = character(0),   calls = list(     \"survey::svymean(~api00, na.rm = TRUE)\",     \"survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE)\"   ) )  wf #>  #> ── Workflow: API Score Analysis 2000 ── #> Author:  Research Team #> Survey:  api / 2000 #> Version: 1.0.0 #> Description: Mean API score estimation by school type #> Certification: community #> Estimation types: annual #>  #> ── Calls (2) ── #>   1. survey::svymean(~api00, na.rm = TRUE) #>   2. survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE)"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"publishing-to-the-registry","dir":"Articles","previous_headings":"RecipeWorkflow: Publishable Estimates","what":"Publishing to the Registry","title":"Estimation Workflows","text":"publish workflow others can discover reuse :","code":"# Configure a local backend wf_path <- tempfile(fileext = \".json\") set_workflow_backend(\"local\", path = wf_path)  # Publish publish_workflow(wf)  # Discover workflows all_wf <- list_workflows() length(all_wf) #> [1] 1  # Search by text found <- search_workflows(\"income\") length(found) #> [1] 0  # Filter by survey type ech_wf <- filter_workflows(survey_type = \"ech\") length(ech_wf) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"finding-workflows-associated-with-a-recipe","dir":"Articles","previous_headings":"RecipeWorkflow: Publishable Estimates","what":"Finding Workflows Associated with a Recipe","title":"Estimation Workflows","text":"recipe want know estimates published , can use find_workflows_for_recipe():","code":"# Create a workflow that references a recipe wf2 <- RecipeWorkflow$new(   name            = \"Labor Market Estimates\",   user            = \"Team\",   survey_type     = \"ech\",   edition         = \"2023\",   estimation_type = \"annual\",   recipe_ids      = c(\"labor_force_recipe_001\"),   calls           = list(\"survey::svymean(~employed, na.rm = TRUE)\") )  publish_workflow(wf2)  # Find all workflows that use this recipe related <- find_workflows_for_recipe(\"labor_force_recipe_001\") length(related) #> [1] 1 if (length(related) > 0) cat(\"Found:\", related[[1]]$name, \"\\n\") #> Found: Labor Market Estimates"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"sharing-via-the-remote-api","dir":"Articles","previous_headings":"","what":"Sharing via the Remote API","title":"Estimation Workflows","text":"broader dissemination, can publish workflows metasurvey API:","code":"# Requires authentication api_login(\"you@example.com\", \"password\")  # Publish api_publish_workflow(wf)  # Browse all <- api_list_workflows(survey_type = \"ech\") specific <- api_get_workflow(\"workflow_id_here\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"full-pipeline","dir":"Articles","previous_headings":"","what":"Full Pipeline","title":"Estimation Workflows","text":"complete pipeline raw data publishable estimation, using API dataset:","code":"# 1. Create survey from real data dt_full <- data.table(apistrat)  svy_full <- Survey$new(   data    = dt_full,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\") )  # 2. Apply steps: compute derived variables svy_full <- step_compute(svy_full,   api_growth = api00 - api99,   high_growth = ifelse(api00 - api99 > 50, 1L, 0L),   comment = \"API score growth indicators\" )  svy_full <- step_recode(svy_full, school_level,   stype == \"E\" ~ \"Elementary\",   stype == \"M\" ~ \"Middle\",   stype == \"H\" ~ \"High\",   .default = \"Other\",   comment = \"School level classification\" )  # 3. Estimate means estimates <- workflow(   list(svy_full),   survey::svymean(~api_growth, na.rm = TRUE),   survey::svymean(~high_growth, na.rm = TRUE),   estimation_type = \"annual\" )  estimates #>                            stat      value        se         cv confint_lower #>                          <char>      <num>     <num>      <num>         <num> #> 1:  survey::svymean: api_growth 32.8925184 2.1583789 0.06561914    28.6621734 #> 2: survey::svymean: high_growth  0.2938489 0.0363651 0.12375443     0.2225746 #>    confint_upper #>            <num> #> 1:    37.1228633 #> 2:     0.3651232 # 4. Domain estimation (by school type) by_school <- workflow(   list(svy_full),   survey::svyby(~api00, ~stype, survey::svymean, na.rm = TRUE),   estimation_type = \"annual\" )  by_school #>                              stat  value       se         cv confint_lower #>                            <char>  <num>    <num>      <num>         <num> #> 1: survey::svyby: api00 [stype=E] 674.43 12.49343 0.01852443      649.9433 #> 2: survey::svyby: api00 [stype=H] 625.82 15.34078 0.02451309      595.7526 #> 3: survey::svyby: api00 [stype=M] 636.60 16.50239 0.02592270      604.2559 #>    confint_upper  stype #>            <num> <fctr> #> 1:      698.9167      E #> 2:      655.8874      H #> 3:      668.9441      M # 5. Assess quality for (i in seq_len(nrow(estimates))) {   cv_val <- estimates$cv[i] * 100   cat(     estimates$stat[i], \":\",     round(cv_val, 1), \"% CV -\",     evaluate_cv(cv_val), \"\\n\"   ) } #> survey::svymean: api_growth : 6.6 % CV - Very good  #> survey::svymean: high_growth : 12.4 % CV - Good"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"provenance-data-lineage","dir":"Articles","previous_headings":"","what":"Provenance: Data Lineage","title":"Estimation Workflows","text":"Every Survey object records provenance metadata: data came , steps applied, many rows survived step, versions R metasurvey used. makes possible trace estimate back raw data. Provenance also attached workflow() results, can always inspect full lineage estimate: audit trails, export provenance JSON: compare two runs (e.g., different editions), use provenance_diff():","code":"# Provenance is populated automatically after bake_steps() prov <- provenance(svy_full) prov #> ── Data Provenance ───────────────────────────────────────────────────────────── #> Loaded: 2026-02-17T15:34:04  #> Initial rows: 200  #>  #> Environment: #>   metasurvey: 0.0.21  #>   R: 4.5.2  #>   survey: 4.4.8 prov_wf <- provenance(estimates) cat(\"metasurvey version:\", prov_wf$environment$metasurvey_version, \"\\n\") #> metasurvey version: 0.0.21 cat(\"Steps applied:\", length(prov_wf$steps), \"\\n\") #> Steps applied: 0 provenance_to_json(prov, \"audit_trail.json\") diff <- provenance_diff(prov_2022, prov_2023) diff$steps_changed diff$n_final_changed"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"publication-quality-tables","dir":"Articles","previous_headings":"","what":"Publication-Quality Tables","title":"Estimation Workflows","text":"workflow_table() formats estimation results publication-ready tables using gt package. adds confidence intervals, CV quality classification color coding, provenance-based source notes. can customize output: domain estimates, table detects group columns automatically: Export format supported gt::gtsave():","code":"workflow_table(estimates) # Spanish locale, hide SE, custom title workflow_table(   estimates,   locale = \"es\",   show_se = FALSE,   title = \"API Growth Indicators\",   subtitle = \"California Schools, 2000\" ) workflow_table(by_school) tbl <- workflow_table(estimates) gt::gtsave(tbl, \"estimates.html\") gt::gtsave(tbl, \"estimates.docx\") gt::gtsave(tbl, \"estimates.png\")"},{"path":"https://metasurveyr.github.io/metasurvey/articles/workflows-and-estimation.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Estimation Workflows","text":"Creating Publishing Recipes – Build reproducible transformation pipelines Survey Designs Validation – Stratification, clustering, replicate weights Case Study: ECH – Complete labor market analysis estimation","code":""},{"path":"https://metasurveyr.github.io/metasurvey/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Mauro Loprete. Author, maintainer. Natalia da Silva. Author. Fabricio Machado. Author.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Loprete M, da Silva N, Machado F (2026). metasurvey: Reproducible Survey Data Processing Step Pipelines. R package version 0.0.21, https://github.com/metasurveyr/metasurvey.","code":"@Manual{,   title = {metasurvey: Reproducible Survey Data Processing with Step Pipelines},   author = {Mauro Loprete and Natalia {da Silva} and Fabricio Machado},   year = {2026},   url = {https://github.com/metasurveyr/metasurvey},   note = {R package version 0.0.21}, }"},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"metasurvey","dir":"","previous_headings":"","what":"Reproducible Survey Data Processing with Step Pipelines","title":"Reproducible Survey Data Processing with Step Pipelines","text":"metasurvey R package processing analysing complex survey data using metaprogramming reproducible pipelines. integrates survey package designed complex sampling designs recurring estimations time (rotating panels, repeated cross-sections). find useful, please consider giving us ⭐ star GitHub — helps others discover project!","code":""},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"live-services","dir":"","previous_headings":"","what":"Live services","title":"Reproducible Survey Data Processing with Step Pipelines","text":"full stack deployed publicly available:","code":""},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"key-features","dir":"","previous_headings":"","what":"Key features","title":"Reproducible Survey Data Processing with Step Pipelines","text":"Steps: lazy transformation pipeline (step_compute, step_recode, step_rename, step_remove, step_join) executed via bake_steps(). Recipes: portable, versioned objects encapsulate harmonisation pipelines automatic documentation (doc()) validation (validate()). Workflows: estimation survey::svymean, svytotal, svyratio svyby integrated workflow(), returning data.table value, standard error coefficient variation. Rotating panels: support RotativePanelSurvey implantation follow-ups, PoolSurvey combined estimation. Replicate weights: bootstrap replicate configuration via add_replicate() robust variance survey::svrepdesign. Recipe registry: publish, search discover recipes workflows self-hosted REST API local JSON registry. Shiny app: interactive recipe workflow explorer explore_recipes(). Self-hosting: deploy full stack infrastructure Docker Compose Kubernetes. Publish indicators full traceability (indicator → workflow → recipe) keeping microdata private. See vignette(\"self-hosting\"). STATA transpiler: convert .files reproducible Recipe objects.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"works-with-any-household-survey","dir":"","previous_headings":"","what":"Works with any household survey","title":"Reproducible Survey Data Processing with Step Pipelines","text":"step pipeline workflow system survey-agnostic. verbs process Argentina’s EPH, Chile’s CASEN, Brazil’s PNAD-C, US CPS, Mexico’s ENIGH, DHS data 90+ countries. See vignette(\"international-surveys\") reproducible examples seven surveys.","code":"# Same pipeline, different surveys ─────────────────────────  # Argentina (eph) eph_svy <- Survey$new(   data = as.data.table(eph::get_microdata(2023, 3)),   edition = \"2023-T3\", type = \"eph\", psu = NULL,   engine = \"data.table\", weight = add_weight(quarterly = \"PONDERA\") )  # Chile (casen) casen_svy <- Survey$new(   data = as.data.table(casen::descargar_casen_github(2017)),   edition = \"2017\", type = \"casen\", psu = \"varunit\",   engine = \"data.table\", weight = add_weight(annual = \"expr\") )  # Both use the exact same verbs process <- function(svy) {   svy |>     step_recode(employed, labor_status == 1 ~ 1L, .default = 0L,                 comment = \"Binary employment indicator\") |>     bake_steps() }"},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Reproducible Survey Data Processing with Step Pipelines","text":"Development version GitHub:","code":"# install.packages(\"devtools\") devtools::install_github(\"metasurveyR/metasurvey\")"},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"quick-example","dir":"","previous_headings":"","what":"Quick example","title":"Reproducible Survey Data Processing with Step Pipelines","text":"","code":"library(metasurvey)  # Create a survey with sample data data(api, package = \"survey\")  svy <- Survey$new(   data    = apistrat,   edition = \"2000\",   type    = \"api\",   psu     = NULL,   engine  = \"data.table\",   weight  = add_weight(annual = \"pw\") )  # Lazy transformations svy <- step_compute(svy, growth = api00 - api99, comment = \"API growth\") svy <- step_recode(svy, school_level,   stype == \"E\" ~ \"Elementary\",   stype == \"M\" ~ \"Middle\",   stype == \"H\" ~ \"High\",   .default = NA_character_ ) svy <- bake_steps(svy)  # Estimation workflow(   list(svy),   survey::svymean(~growth, na.rm = TRUE),   estimation_type = \"annual\" )"},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"full-example-ech-panel-with-bootstrap-replicate-weights","dir":"","previous_headings":"","what":"Full example: ECH panel with bootstrap replicate weights","title":"Reproducible Survey Data Processing with Step Pipelines","text":"example uses rotating panel Uruguay’s Encuesta Continua de Hogares (ECH) bootstrap replicate weights. First, download example data: data downloaded: pipeline loads rotating panel bootstrap replicate weights, builds binary labour market indicators (EAP, WAP, employed, unemployed), estimates activity, employment unemployment rates quarter robust variance.","code":"download_example_ech <- function() {   zip_url <- \"https://informe-tfg.s3.us-east-2.amazonaws.com/example-data.zip\"   dest_zip <- \"example-data.zip\"   temp_dir <- tempfile(\"example-data\")   download.file(zip_url, destfile = dest_zip, mode = \"wb\")   dir.create(temp_dir)   unzip(dest_zip, exdir = temp_dir)   target_dir <- \"example-data\"   dir.create(target_dir, recursive = TRUE, showWarnings = FALSE)   file.rename(     list.files(file.path(temp_dir, \"example-data\"), full.names = TRUE),     file.path(target_dir, basename(list.files(file.path(temp_dir, \"example-data\"))))   )   unlink(dest_zip)   unlink(temp_dir, recursive = TRUE) } download_example_ech() library(metasurvey) library(magrittr)  path_dir <- file.path(\"example-data\", \"ech\", \"ech_2023\")  ech_2023 <- load_panel_survey(   path_implantation = file.path(path_dir, \"ECH_implantacion_2023.csv\"),   path_follow_up = file.path(path_dir, \"seguimiento\"),   svy_type = \"ECH_2023\",   svy_weight_implantation = add_weight(annual = \"W_ANO\"),   svy_weight_follow_up = add_weight(     monthly = add_replicate(       \"W\",       replicate_path = file.path(         path_dir,         c(           \"Pesos replicados Bootstrap mensuales enero_junio 2023\",           \"Pesos replicados Bootstrap mensuales julio_diciembre 2023\"         ),         c(           \"Pesos replicados mensuales enero_junio 2023\",           \"Pesos replicados mensuales Julio_diciembre 2023\"         )       ),       replicate_id = c(\"ID\" = \"ID\"),       replicate_pattern = \"wr[0-9]+\",       replicate_type = \"bootstrap\"     )   ) )  # Build labour market indicators ech_2023 <- ech_2023 %>%   step_recode(\"pea\", POBPCOAC %in% 2:5 ~ 1, .default = 0,               comment = \"EAP\", .level = \"follow_up\") %>%   step_recode(\"pet\", e27 >= 14 ~ 1, .default = 0,               comment = \"WAP\", .level = \"follow_up\") %>%   step_recode(\"po\", POBPCOAC == 2 ~ 1, .default = 0,               comment = \"Employed\", .level = \"follow_up\") %>%   step_recode(\"pd\", POBPCOAC %in% 3:5 ~ 1, .default = 0,               comment = \"Unemployed\", .level = \"follow_up\")  ech_2023_bake <- bake_steps(ech_2023)  # Quarterly rates: activity, employment and unemployment workflow_result <- workflow(   survey = extract_surveys(ech_2023_bake, quarterly = 1:4),   survey::svyratio(~pea, denominator = ~pet),   survey::svyratio(~po, denominator = ~pet),   survey::svyratio(~pd, denominator = ~pea),   estimation_type = \"quarterly:monthly\",   rho = 0.5,   R = 5 / 6 )  workflow_result"},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"stata-transpiler","dir":"","previous_headings":"","what":"STATA transpiler","title":"Reproducible Survey Data Processing with Step Pipelines","text":"Many research groups maintain decades STATA .files process household survey microdata. metasurvey transpiler converts scripts reproducible Recipe objects. Supported STATA patterns: gen/replace chains, recode, egen -groups, foreach/forvalues loops, mvencode, destring, rename, drop/keep, variable value labels, inrange/inlist expressions, variable ranges. See vignette(\"stata-transpiler\") full reference.","code":"library(metasurvey)  # Transpile a .do file to metasurvey steps result <- transpile_stata(\"demographics.do\") result$steps[1:3] #> [1] \"step_rename(svy, hh_id = \\\"id\\\", person_id = \\\"nper\\\")\" #> [2] \"step_compute(svy, weight_yr = pesoano)\" #> [3] \"step_compute(svy, sex = e26)\"  # Transpile an entire year directory into separate recipes recipes <- transpile_stata_module(   year_dir = \"do_files/2022\",   year = 2022,   user = \"research_team\",   output_dir = \"recipes/\" )  # Check coverage before migrating transpile_coverage(\"do_files/\")"},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Reproducible Survey Data Processing with Step Pipelines","text":"Getting started International survey compatibility Recipes Workflows estimation Complex designs Rotating panels Case study: ECH STATA transpiler ECH demographics recipe Interactive explorer API database Self-hosting guide","code":""},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Reproducible Survey Data Processing with Step Pipelines","text":"cite metasurvey publications use: Loprete M, da Silva N, Machado F (2025). metasurvey: Reproducible Survey Data Processing Step Pipelines. R package, https://github.com/metasurveyr/metasurvey.","code":"citation(\"metasurvey\")"},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Reproducible Survey Data Processing with Step Pipelines","text":"Please see CONTRIBUTING.md guidelines contribute metasurvey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Reproducible Survey Data Processing with Step Pipelines","text":"Please note metasurvey project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":null,"dir":"Reference","previous_headings":"","what":"PoolSurvey Class — PoolSurvey","title":"PoolSurvey Class — PoolSurvey","text":"class represents collection surveys grouped specific periods (e.g., monthly, quarterly, annual). provides methods access manipulate grouped surveys.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PoolSurvey Class — PoolSurvey","text":"object class PoolSurvey.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"PoolSurvey Class — PoolSurvey","text":"surveys list containing grouped surveys.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"PoolSurvey Class — PoolSurvey","text":"PoolSurvey$new() PoolSurvey$get_surveys() PoolSurvey$print() PoolSurvey$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"PoolSurvey Class — PoolSurvey","text":"Initializes new instance PoolSurvey class.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PoolSurvey Class — PoolSurvey","text":"","code":"PoolSurvey$new(surveys)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PoolSurvey Class — PoolSurvey","text":"surveys list containing grouped surveys.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"method-get-surveys-","dir":"Reference","previous_headings":"","what":"Method get_surveys()","title":"PoolSurvey Class — PoolSurvey","text":"Retrieves surveys specific period.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"PoolSurvey Class — PoolSurvey","text":"","code":"PoolSurvey$get_surveys(period = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"PoolSurvey Class — PoolSurvey","text":"period string specifying period retrieve (e.g., \"monthly\", \"quarterly\").","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"PoolSurvey Class — PoolSurvey","text":"list surveys specified period.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"PoolSurvey Class — PoolSurvey","text":"Prints metadata PoolSurvey object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"PoolSurvey Class — PoolSurvey","text":"","code":"PoolSurvey$print()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"PoolSurvey Class — PoolSurvey","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"PoolSurvey Class — PoolSurvey","text":"","code":"PoolSurvey$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"PoolSurvey Class — PoolSurvey","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/PoolSurvey.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PoolSurvey Class — PoolSurvey","text":"","code":"s1 <- Survey$new(   data = data.table::data.table(id = 1:3, w = 1),   edition = \"2023\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) s2 <- Survey$new(   data = data.table::data.table(id = 4:6, w = 1),   edition = \"2023\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) pool <- PoolSurvey$new(list(annual = list(\"group1\" = list(s1, s2))))"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Recipe R6 class — Recipe-class","title":"Recipe R6 class — Recipe-class","text":"Recipe R6 class Recipe R6 class","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Recipe R6 class — Recipe-class","text":"R6 class generator (R6ClassGenerator)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Recipe R6 class — Recipe-class","text":"object class Recipe.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Recipe R6 class — Recipe-class","text":"R6 class representing reproducible data transformation recipe surveys. encapsulates metadata, declared dependencies, list transformation steps applied Survey object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"methods","dir":"Reference","previous_headings":"","what":"Methods","title":"Recipe R6 class — Recipe-class","text":"$new(name, edition, survey_type, default_engine, depends_on, user, description, steps, id, doi, topic) Class constructor. $doc() Auto-generate documentation recipe steps. Returns list metadata, input_variables, output_variables, pipeline information. $validate(svy) Validate survey object required input variables.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"Recipe R6 class — Recipe-class","text":"name Descriptive name recipe (character). edition Target edition/period (character Date). survey_type Survey type (character), e.g., \"ech\", \"eaii\". default_engine Default evaluation engine (character). depends_on Vector/list dependencies declared steps. user Author/owner (character). description Recipe description (character). id Unique identifier (character/numeric). steps List step calls make workflow. doi DOI external identifier (character|NULL). bake Logical flag indicating whether applied. topic Recipe topic (character|NULL). step_objects List Step R6 objects (list|NULL), used documentation generation. categories List RecipeCategory objects classification. downloads Integer download/usage count. certification RecipeCertification object (default community). user_info RecipeUser object NULL. version Recipe version string. depends_on_recipes List recipe IDs must applied one. data_source List S3 bucket info (s3_bucket, s3_prefix, file_pattern, provider) NULL. labels List variable value labels (var_labels, val_labels) NULL.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"Recipe R6 class — Recipe-class","text":"Recipe$new() Recipe$increment_downloads() Recipe$certify() Recipe$add_category() Recipe$remove_category() Recipe$to_list() Recipe$doc() Recipe$validate() Recipe$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"Recipe R6 class — Recipe-class","text":"Create Recipe object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$new(   name,   edition,   survey_type,   default_engine,   depends_on,   user,   description,   steps,   id,   doi = NULL,   topic = NULL,   step_objects = NULL,   cached_doc = NULL,   categories = list(),   downloads = 0L,   certification = NULL,   user_info = NULL,   version = \"1.0.0\",   depends_on_recipes = list(),   data_source = NULL,   labels = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recipe R6 class — Recipe-class","text":"name Descriptive name recipe (character) edition Target edition/period (character Date) survey_type Survey type (character), e.g., \"ech\", \"eaii\" default_engine Default evaluation engine (character) depends_on Vector list declared dependencies user Author owner recipe (character) description Detailed description recipe (character) steps List step calls make workflow id Unique identifier (character numeric) doi DOI external identifier (character NULL) topic Recipe topic (character NULL) step_objects List Step R6 objects (optional, used doc generation) cached_doc Pre-computed documentation (optional, used loading JSON) categories List RecipeCategory objects (optional) downloads Integer download count (default 0) certification RecipeCertification object (optional, default community) user_info RecipeUser object (optional) version Recipe version string (default \"1.0.0\") depends_on_recipes List recipe IDs must applied one (optional) data_source List S3 bucket info (optional) labels List var_labels val_labels (optional)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-increment-downloads-","dir":"Reference","previous_headings":"","what":"Method increment_downloads()","title":"Recipe R6 class — Recipe-class","text":"Increment download counter","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$increment_downloads()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-certify-","dir":"Reference","previous_headings":"","what":"Method certify()","title":"Recipe R6 class — Recipe-class","text":"Certify recipe given level","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$certify(user, level)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recipe R6 class — Recipe-class","text":"user RecipeUser certifying level Character certification level (\"reviewed\" \"official\")","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-add-category-","dir":"Reference","previous_headings":"","what":"Method add_category()","title":"Recipe R6 class — Recipe-class","text":"Add category recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$add_category(category)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recipe R6 class — Recipe-class","text":"category RecipeCategory add","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-remove-category-","dir":"Reference","previous_headings":"","what":"Method remove_category()","title":"Recipe R6 class — Recipe-class","text":"Remove category name","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$remove_category(name)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recipe R6 class — Recipe-class","text":"name Character category name remove","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-to-list-","dir":"Reference","previous_headings":"","what":"Method to_list()","title":"Recipe R6 class — Recipe-class","text":"Serialize Recipe plain list suitable JSON/API publishing. Steps encoded character strings via deparse().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$to_list()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"Recipe R6 class — Recipe-class","text":"named list recipe fields.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-doc-","dir":"Reference","previous_headings":"","what":"Method doc()","title":"Recipe R6 class — Recipe-class","text":"Auto-generate documentation recipe steps","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$doc()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"Recipe R6 class — Recipe-class","text":"list metadata, input_variables, output_variables, pipeline information","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-validate-","dir":"Reference","previous_headings":"","what":"Method validate()","title":"Recipe R6 class — Recipe-class","text":"Validate survey required input variables","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$validate(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recipe R6 class — Recipe-class","text":"svy Survey object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"Recipe R6 class — Recipe-class","text":"TRUE valid, otherwise stops error listing missing variables","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"Recipe R6 class — Recipe-class","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"Recipe R6 class — Recipe-class","text":"","code":"Recipe$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recipe R6 class — Recipe-class","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Recipe-class.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Recipe R6 class — Recipe-class","text":"","code":"# Use the recipe() constructor: svy <- survey_empty(type = \"ech\", edition = \"2023\") r <- recipe(   name = \"Example\", user = \"Test\", svy = svy,   description = \"Example recipe\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":null,"dir":"Reference","previous_headings":"","what":"RecipeBackend — RecipeBackend","title":"RecipeBackend — RecipeBackend","text":"Backend-agnostic factory recipe storage retrieval. Supports \"local\" (JSON-backed RecipeRegistry) \"api\" (remote plumber API) backends.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"RecipeBackend — RecipeBackend","text":"type Character backend type (\"local\" \"api\").","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"RecipeBackend — RecipeBackend","text":"RecipeBackend$new() RecipeBackend$publish() RecipeBackend$search() RecipeBackend$get() RecipeBackend$increment_downloads() RecipeBackend$rank() RecipeBackend$filter() RecipeBackend$list_all() RecipeBackend$save() RecipeBackend$load() RecipeBackend$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"RecipeBackend — RecipeBackend","text":"Create new RecipeBackend","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$new(type, path = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeBackend — RecipeBackend","text":"type Character. \"local\" \"api\". path Character. File path local backend (optional).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-publish-","dir":"Reference","previous_headings":"","what":"Method publish()","title":"RecipeBackend — RecipeBackend","text":"Publish recipe backend","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$publish(recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeBackend — RecipeBackend","text":"recipe Recipe object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-search-","dir":"Reference","previous_headings":"","what":"Method search()","title":"RecipeBackend — RecipeBackend","text":"Search recipes","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$search(query)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeBackend — RecipeBackend","text":"query Character search string","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeBackend — RecipeBackend","text":"List matching Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-get-","dir":"Reference","previous_headings":"","what":"Method get()","title":"RecipeBackend — RecipeBackend","text":"Get recipe id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$get(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeBackend — RecipeBackend","text":"id Recipe id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeBackend — RecipeBackend","text":"Recipe object NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-increment-downloads-","dir":"Reference","previous_headings":"","what":"Method increment_downloads()","title":"RecipeBackend — RecipeBackend","text":"Increment download count recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$increment_downloads(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeBackend — RecipeBackend","text":"id Recipe id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-rank-","dir":"Reference","previous_headings":"","what":"Method rank()","title":"RecipeBackend — RecipeBackend","text":"Rank recipes downloads","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$rank(n = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeBackend — RecipeBackend","text":"n Integer max return","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeBackend — RecipeBackend","text":"List Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-filter-","dir":"Reference","previous_headings":"","what":"Method filter()","title":"RecipeBackend — RecipeBackend","text":"Filter recipes criteria","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$filter(   survey_type = NULL,   edition = NULL,   category = NULL,   certification_level = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeBackend — RecipeBackend","text":"survey_type Character NULL edition Character NULL category Character NULL certification_level Character NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeBackend — RecipeBackend","text":"List matching Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-list-all-","dir":"Reference","previous_headings":"","what":"Method list_all()","title":"RecipeBackend — RecipeBackend","text":"List recipes","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$list_all()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeBackend — RecipeBackend","text":"List Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-save-","dir":"Reference","previous_headings":"","what":"Method save()","title":"RecipeBackend — RecipeBackend","text":"Save local backend disk","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$save()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-load-","dir":"Reference","previous_headings":"","what":"Method load()","title":"RecipeBackend — RecipeBackend","text":"Load local backend disk","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$load()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"RecipeBackend — RecipeBackend","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeBackend — RecipeBackend","text":"","code":"RecipeBackend$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeBackend — RecipeBackend","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeBackend.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RecipeBackend — RecipeBackend","text":"","code":"if (FALSE) { # \\dontrun{ # Local backend (internal class, use set_backend() instead) backend <- RecipeBackend$new(\"local\", path = tempfile(fileext = \".json\")) backend$search(\"labor\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory-from_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Deserialize a RecipeCategory from a list — RecipeCategory-from_list","title":"Deserialize a RecipeCategory from a list — RecipeCategory-from_list","text":"Class method reconstruct RecipeCategory list representation.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory-from_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Deserialize a RecipeCategory from a list — RecipeCategory-from_list","text":"lst List name, description, parent fields, NULL.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory-from_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Deserialize a RecipeCategory from a list — RecipeCategory-from_list","text":"RecipeCategory object NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":null,"dir":"Reference","previous_headings":"","what":"RecipeCategory — RecipeCategory","title":"RecipeCategory — RecipeCategory","text":"Standardized taxonomy classifying recipes domain. Supports hierarchical categories parent-child relationships.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RecipeCategory — RecipeCategory","text":"object class RecipeCategory.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"methods","dir":"Reference","previous_headings":"","what":"Methods","title":"RecipeCategory — RecipeCategory","text":"$new(name, description, parent) Constructor creating new category $is_subcategory_of(ancestor_name) Check category subcategory another $get_path() Get full hierarchical path $equals() Check equality name $to_list() Serialize list JSON $print(...) Print category information $from_list(lst) Class method reconstruct list (see details)","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"RecipeCategory — RecipeCategory","text":"name Character. Category identifier. description Character. Human-readable description. parent RecipeCategory NULL. Parent category hierarchy.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"RecipeCategory — RecipeCategory","text":"RecipeCategory$new() RecipeCategory$is_subcategory_of() RecipeCategory$get_path() RecipeCategory$equals() RecipeCategory$to_list() RecipeCategory$print() RecipeCategory$from_list() RecipeCategory$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"RecipeCategory — RecipeCategory","text":"Create new RecipeCategory","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCategory — RecipeCategory","text":"","code":"RecipeCategory$new(name, description, parent = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCategory — RecipeCategory","text":"name Character. Category identifier (non-empty string). description Character. Description category. parent RecipeCategory NULL. Parent category.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"method-is-subcategory-of-","dir":"Reference","previous_headings":"","what":"Method is_subcategory_of()","title":"RecipeCategory — RecipeCategory","text":"Check category subcategory another","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCategory — RecipeCategory","text":"","code":"RecipeCategory$is_subcategory_of(ancestor_name)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCategory — RecipeCategory","text":"ancestor_name Character. Name potential ancestor category.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeCategory — RecipeCategory","text":"Logical","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"method-get-path-","dir":"Reference","previous_headings":"","what":"Method get_path()","title":"RecipeCategory — RecipeCategory","text":"Get full hierarchical path","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCategory — RecipeCategory","text":"","code":"RecipeCategory$get_path()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeCategory — RecipeCategory","text":"Character string slash-separated path","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"method-equals-","dir":"Reference","previous_headings":"","what":"Method equals()","title":"RecipeCategory — RecipeCategory","text":"Check equality name","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCategory — RecipeCategory","text":"","code":"RecipeCategory$equals(other)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCategory — RecipeCategory","text":"RecipeCategory compare .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeCategory — RecipeCategory","text":"Logical","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"method-to-list-","dir":"Reference","previous_headings":"","what":"Method to_list()","title":"RecipeCategory — RecipeCategory","text":"Serialize list JSON","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCategory — RecipeCategory","text":"","code":"RecipeCategory$to_list()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeCategory — RecipeCategory","text":"List representation","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"RecipeCategory — RecipeCategory","text":"Print category","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCategory — RecipeCategory","text":"","code":"RecipeCategory$print(...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCategory — RecipeCategory","text":"... Additional arguments (used)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"method-from-list-","dir":"Reference","previous_headings":"","what":"Method from_list()","title":"RecipeCategory — RecipeCategory","text":"Deserialize RecipeCategory list","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCategory — RecipeCategory","text":"","code":"RecipeCategory$from_list(lst)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCategory — RecipeCategory","text":"lst List name, description, parent fields, NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeCategory — RecipeCategory","text":"RecipeCategory object NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"RecipeCategory — RecipeCategory","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCategory — RecipeCategory","text":"","code":"RecipeCategory$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCategory — RecipeCategory","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCategory.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RecipeCategory — RecipeCategory","text":"","code":"# Use recipe_category() for the public API: cat <- recipe_category(   \"economics\", \"Economic indicators\" ) sub <- recipe_category(   \"labor_market\", \"Labor market\",   parent = \"economics\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":null,"dir":"Reference","previous_headings":"","what":"RecipeCertification — RecipeCertification","title":"RecipeCertification — RecipeCertification","text":"Quality certification recipes three tiers: community (default), reviewed (peer-reviewed institutional member), official (certified institution).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RecipeCertification — RecipeCertification","text":"object class RecipeCertification.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"RecipeCertification — RecipeCertification","text":"level Character. Certification level. certified_by RecipeUser NULL. certifying user. certified_at POSIXct. Timestamp certification. notes Character NULL. Additional notes.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"RecipeCertification — RecipeCertification","text":"RecipeCertification$new() RecipeCertification$numeric_level() RecipeCertification$is_at_least() RecipeCertification$to_list() RecipeCertification$print() RecipeCertification$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"RecipeCertification — RecipeCertification","text":"Create new RecipeCertification","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCertification — RecipeCertification","text":"","code":"RecipeCertification$new(   level,   certified_by = NULL,   notes = NULL,   certified_at = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCertification — RecipeCertification","text":"level Character. One \"community\", \"reviewed\", \"official\". certified_by RecipeUser NULL. Required reviewed/official. notes Character NULL. Additional notes. certified_at POSIXct NULL. Auto-set NULL.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"method-numeric-level-","dir":"Reference","previous_headings":"","what":"Method numeric_level()","title":"RecipeCertification — RecipeCertification","text":"Get numeric level ordering (1=community, 2=reviewed, 3=official)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCertification — RecipeCertification","text":"","code":"RecipeCertification$numeric_level()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeCertification — RecipeCertification","text":"Integer","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"method-is-at-least-","dir":"Reference","previous_headings":"","what":"Method is_at_least()","title":"RecipeCertification — RecipeCertification","text":"Check certification least given level","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCertification — RecipeCertification","text":"","code":"RecipeCertification$is_at_least(level)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCertification — RecipeCertification","text":"level Character. Level compare .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeCertification — RecipeCertification","text":"Logical","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"method-to-list-","dir":"Reference","previous_headings":"","what":"Method to_list()","title":"RecipeCertification — RecipeCertification","text":"Serialize list JSON","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCertification — RecipeCertification","text":"","code":"RecipeCertification$to_list()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeCertification — RecipeCertification","text":"List representation","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"RecipeCertification — RecipeCertification","text":"Print certification badge","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCertification — RecipeCertification","text":"","code":"RecipeCertification$print(...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCertification — RecipeCertification","text":"... Additional arguments (used)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"RecipeCertification — RecipeCertification","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeCertification — RecipeCertification","text":"","code":"RecipeCertification$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeCertification — RecipeCertification","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeCertification.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RecipeCertification — RecipeCertification","text":"","code":"# Use recipe_certification() for the public API: cert <- recipe_certification() inst <- recipe_user(\"IECON\", type = \"institution\") official <- recipe_certification(\"official\", certified_by = inst)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":null,"dir":"Reference","previous_headings":"","what":"RecipeRegistry — RecipeRegistry","title":"RecipeRegistry — RecipeRegistry","text":"Local JSON-backed catalog recipe discovery, ranking, filtering.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"RecipeRegistry — RecipeRegistry","text":"RecipeRegistry$new() RecipeRegistry$register() RecipeRegistry$unregister() RecipeRegistry$search() RecipeRegistry$filter() RecipeRegistry$rank_by_downloads() RecipeRegistry$rank_by_certification() RecipeRegistry$get() RecipeRegistry$list_all() RecipeRegistry$save() RecipeRegistry$load() RecipeRegistry$list_by_user() RecipeRegistry$list_by_institution() RecipeRegistry$stats() RecipeRegistry$print() RecipeRegistry$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"RecipeRegistry — RecipeRegistry","text":"Create new empty RecipeRegistry","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$new()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-register-","dir":"Reference","previous_headings":"","what":"Method register()","title":"RecipeRegistry — RecipeRegistry","text":"Register recipe catalog","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$register(recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"recipe Recipe object register","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-unregister-","dir":"Reference","previous_headings":"","what":"Method unregister()","title":"RecipeRegistry — RecipeRegistry","text":"Remove recipe catalog id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$unregister(recipe_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"recipe_id Recipe id remove","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-search-","dir":"Reference","previous_headings":"","what":"Method search()","title":"RecipeRegistry — RecipeRegistry","text":"Search recipes name description (case-insensitive)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$search(query)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"query Character search query","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"List matching Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-filter-","dir":"Reference","previous_headings":"","what":"Method filter()","title":"RecipeRegistry — RecipeRegistry","text":"Filter recipes criteria","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$filter(   survey_type = NULL,   edition = NULL,   category = NULL,   certification_level = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"survey_type Character survey type NULL edition Character edition NULL category Character category name NULL certification_level Character certification level NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"List matching Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-rank-by-downloads-","dir":"Reference","previous_headings":"","what":"Method rank_by_downloads()","title":"RecipeRegistry — RecipeRegistry","text":"Rank recipes download count (descending)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$rank_by_downloads(n = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"n Integer max number return, NULL ","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"List Recipe objects sorted downloads","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-rank-by-certification-","dir":"Reference","previous_headings":"","what":"Method rank_by_certification()","title":"RecipeRegistry — RecipeRegistry","text":"Rank recipes certification level downloads","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$rank_by_certification(n = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"n Integer max number return, NULL ","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"List Recipe objects sorted cert level downloads","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-get-","dir":"Reference","previous_headings":"","what":"Method get()","title":"RecipeRegistry — RecipeRegistry","text":"Get single recipe id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$get(recipe_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"recipe_id Recipe id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"Recipe object NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-list-all-","dir":"Reference","previous_headings":"","what":"Method list_all()","title":"RecipeRegistry — RecipeRegistry","text":"List registered recipes","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$list_all()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"List Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-save-","dir":"Reference","previous_headings":"","what":"Method save()","title":"RecipeRegistry — RecipeRegistry","text":"Save registry catalog JSON file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$save(path)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"path Character file path","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-load-","dir":"Reference","previous_headings":"","what":"Method load()","title":"RecipeRegistry — RecipeRegistry","text":"Load registry catalog JSON file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$load(path)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"path Character file path","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-list-by-user-","dir":"Reference","previous_headings":"","what":"Method list_by_user()","title":"RecipeRegistry — RecipeRegistry","text":"List recipes author user name","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$list_by_user(user_name)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"user_name Character user name","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"List matching Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-list-by-institution-","dir":"Reference","previous_headings":"","what":"Method list_by_institution()","title":"RecipeRegistry — RecipeRegistry","text":"List recipes institution (including members)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$list_by_institution(institution_name)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-10","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"institution_name Character institution name","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns-7","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"List matching Recipe objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-stats-","dir":"Reference","previous_headings":"","what":"Method stats()","title":"RecipeRegistry — RecipeRegistry","text":"Get registry statistics","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$stats()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"returns-8","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeRegistry — RecipeRegistry","text":"List total, by_category, by_certification counts","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"RecipeRegistry — RecipeRegistry","text":"Print registry summary","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-14","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$print(...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-11","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"... Additional arguments (used)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"RecipeRegistry — RecipeRegistry","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"usage-15","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeRegistry — RecipeRegistry","text":"","code":"RecipeRegistry$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"arguments-12","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeRegistry — RecipeRegistry","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeRegistry.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RecipeRegistry — RecipeRegistry","text":"","code":"# Use the tidy API instead: # set_backend(\"local\", path = \"recipes.json\") # publish_recipe(my_recipe) # search_recipes(\"labor\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":null,"dir":"Reference","previous_headings":"","what":"RecipeUser — RecipeUser","title":"RecipeUser — RecipeUser","text":"User identity recipe ecosystem. Supports three account types: individual, institutional_member, institution.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RecipeUser — RecipeUser","text":"object class RecipeUser.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"RecipeUser — RecipeUser","text":"name Character. User institution name. email Character NULL. Email address. user_type Character. One \"individual\", \"institutional_member\", \"institution\". affiliation Character NULL. Organizational affiliation. institution RecipeUser NULL. Parent institution (institutional_member). url Character NULL. Institution URL. verified Logical. Whether account verified. review_status Character. One \"approved\", \"pending\", \"rejected\".","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"RecipeUser — RecipeUser","text":"RecipeUser$new() RecipeUser$trust_level() RecipeUser$can_certify() RecipeUser$to_list() RecipeUser$print() RecipeUser$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"RecipeUser — RecipeUser","text":"Create new RecipeUser","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeUser — RecipeUser","text":"","code":"RecipeUser$new(   name,   user_type,   email = NULL,   affiliation = NULL,   institution = NULL,   url = NULL,   verified = FALSE,   review_status = \"approved\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeUser — RecipeUser","text":"name Character. User institution name. user_type Character. One \"individual\", \"institutional_member\", \"institution\". email Character NULL. Email address. affiliation Character NULL. Organizational affiliation. institution RecipeUser NULL. Parent institution institutional_member. url Character NULL. Institution URL. verified Logical. Whether account verified. review_status Character. \"approved\", \"pending\", \"rejected\".","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"method-trust-level-","dir":"Reference","previous_headings":"","what":"Method trust_level()","title":"RecipeUser — RecipeUser","text":"Get trust level (1=individual, 2=member, 3=institution)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeUser — RecipeUser","text":"","code":"RecipeUser$trust_level()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeUser — RecipeUser","text":"Integer trust level","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"method-can-certify-","dir":"Reference","previous_headings":"","what":"Method can_certify()","title":"RecipeUser — RecipeUser","text":"Check user can certify given level","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeUser — RecipeUser","text":"","code":"RecipeUser$can_certify(level)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeUser — RecipeUser","text":"level Character. Certification level (\"reviewed\" \"official\").","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeUser — RecipeUser","text":"Logical","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"method-to-list-","dir":"Reference","previous_headings":"","what":"Method to_list()","title":"RecipeUser — RecipeUser","text":"Serialize list JSON","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeUser — RecipeUser","text":"","code":"RecipeUser$to_list()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeUser — RecipeUser","text":"List representation","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"RecipeUser — RecipeUser","text":"Print user card","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeUser — RecipeUser","text":"","code":"RecipeUser$print(...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeUser — RecipeUser","text":"... Additional arguments (used)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"RecipeUser — RecipeUser","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeUser — RecipeUser","text":"","code":"RecipeUser$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeUser — RecipeUser","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeUser.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RecipeUser — RecipeUser","text":"","code":"# Use recipe_user() for the public API: user <- recipe_user(\"Juan Perez\", email = \"juan@example.com\") inst <- recipe_user(\"IECON\", type = \"institution\") member <- recipe_user(   \"Maria\",   type = \"institutional_member\",   institution = inst )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":null,"dir":"Reference","previous_headings":"","what":"RecipeWorkflow R6 class — RecipeWorkflow-class","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"RecipeWorkflow R6 class RecipeWorkflow R6 class","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"R6 class generator (R6ClassGenerator)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"object class RecipeWorkflow.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"R6 class representing publishable workflow captures statistical estimations applied survey data. Workflows reference recipes use document estimation calls made.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"methods","dir":"Reference","previous_headings":"","what":"Methods","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"$new(...) Class constructor. $doc() Generate documentation workflow. $to_list() Serialize plain list JSON export. $increment_downloads() Increment download counter. $add_category(category) Add category. $certify(user, level) Certify workflow.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"id Unique identifier (character). name Descriptive name (character). description Workflow description (character). user Author/owner (character). user_info RecipeUser object NULL. survey_type Survey type (character). edition Survey edition (character). estimation_type Character vector estimation types used. recipe_ids Character vector recipe IDs referenced. calls List deparsed call strings. call_metadata List lists type, formula, , description fields. categories List RecipeCategory objects. downloads Integer download count. certification RecipeCertification object. version Version string. doi DOI external identifier (character|NULL). created_at Creation timestamp (character). weight_spec Named list weight configuration per periodicity (list|NULL).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"RecipeWorkflow$new() RecipeWorkflow$doc() RecipeWorkflow$to_list() RecipeWorkflow$increment_downloads() RecipeWorkflow$certify() RecipeWorkflow$add_category() RecipeWorkflow$remove_category() RecipeWorkflow$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"Create RecipeWorkflow object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"RecipeWorkflow$new(   id = NULL,   name,   description = \"\",   user = \"Unknown\",   user_info = NULL,   survey_type = \"Unknown\",   edition = \"Unknown\",   estimation_type = character(0),   recipe_ids = character(0),   calls = list(),   call_metadata = list(),   categories = list(),   downloads = 0L,   certification = NULL,   version = \"1.0.0\",   doi = NULL,   created_at = NULL,   weight_spec = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"id Unique identifier name Descriptive name description Workflow description user Author name user_info RecipeUser object NULL survey_type Survey type edition Survey edition estimation_type Character vector estimation types recipe_ids Character vector recipe IDs calls List deparsed call strings call_metadata List call metadata lists categories List RecipeCategory objects downloads Integer download count certification RecipeCertification NULL version Version string doi DOI NULL created_at Timestamp string NULL (auto-generated) weight_spec Named list weight configuration per periodicity","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"method-doc-","dir":"Reference","previous_headings":"","what":"Method doc()","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"Generate documentation workflow","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"RecipeWorkflow$doc()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"List meta, recipe_ids, estimations, estimation_types","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"method-to-list-","dir":"Reference","previous_headings":"","what":"Method to_list()","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"Serialize plain list JSON export","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"RecipeWorkflow$to_list()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"list suitable jsonlite::write_json","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"method-increment-downloads-","dir":"Reference","previous_headings":"","what":"Method increment_downloads()","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"Increment download counter","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"RecipeWorkflow$increment_downloads()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"method-certify-","dir":"Reference","previous_headings":"","what":"Method certify()","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"Certify workflow given level","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"RecipeWorkflow$certify(user, level)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"user RecipeUser certifying level Character certification level","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"method-add-category-","dir":"Reference","previous_headings":"","what":"Method add_category()","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"Add category workflow","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"RecipeWorkflow$add_category(category)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"category RecipeCategory add","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"method-remove-category-","dir":"Reference","previous_headings":"","what":"Method remove_category()","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"Remove category name","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"RecipeWorkflow$remove_category(name)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"name Character category name remove","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"RecipeWorkflow$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RecipeWorkflow-class.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RecipeWorkflow R6 class — RecipeWorkflow-class","text":"","code":"wf <- RecipeWorkflow$new(   name = \"Labor workflow\", description = \"Unemployment rate\",   user = \"test\", survey_type = \"ech\", edition = \"2023\",   estimation_type = \"annual\", recipe_ids = \"r_001\",   calls = list(\"svymean(~desocupado, na.rm = TRUE)\") )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":null,"dir":"Reference","previous_headings":"","what":"RotativePanelSurvey Class — RotativePanelSurvey","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"class represents rotative panel survey, includes implantation follow-surveys. provides methods access manipulate survey data, steps, recipes, workflows, designs.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"object class RotativePanelSurvey.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"implantation survey object representing implantation survey. follow_up list survey objects representing follow-surveys. type string indicating type survey. default_engine string specifying default engine used processing. steps list steps applied survey. recipes list recipes associated survey. workflows list workflows associated survey. design design object survey. periodicity list containing periodicity implantation follow-surveys.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"RotativePanelSurvey$new() RotativePanelSurvey$get_implantation() RotativePanelSurvey$get_follow_up() RotativePanelSurvey$get_type() RotativePanelSurvey$get_default_engine() RotativePanelSurvey$get_steps() RotativePanelSurvey$get_recipes() RotativePanelSurvey$get_workflows() RotativePanelSurvey$get_design() RotativePanelSurvey$print() RotativePanelSurvey$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Initializes new instance RotativePanelSurvey class.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$new(   implantation,   follow_up,   type,   default_engine,   steps,   recipes,   workflows,   design )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"implantation survey object representing implantation survey. follow_up list survey objects representing follow-surveys. type string indicating type survey. default_engine string specifying default engine used processing. steps list steps applied survey. recipes list recipes associated survey. workflows list workflows associated survey. design design object survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-get-implantation-","dir":"Reference","previous_headings":"","what":"Method get_implantation()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Retrieves implantation survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$get_implantation()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"survey object representing implantation survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-get-follow-up-","dir":"Reference","previous_headings":"","what":"Method get_follow_up()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Retrieves follow-surveys.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$get_follow_up(   index = length(self$follow_up),   monthly = NULL,   quarterly = NULL,   semiannual = NULL,   annual = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"index integer specifying index follow-survey retrieve. monthly vector integers specifying monthly intervals. quarterly vector integers specifying quarterly intervals. semiannual vector integers specifying semiannual intervals. annual vector integers specifying annual intervals.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"list follow-surveys matching specified criteria.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-get-type-","dir":"Reference","previous_headings":"","what":"Method get_type()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Retrieves type survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$get_type()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"string indicating type survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-get-default-engine-","dir":"Reference","previous_headings":"","what":"Method get_default_engine()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Retrieves default engine used processing.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$get_default_engine()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"string specifying default engine.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-get-steps-","dir":"Reference","previous_headings":"","what":"Method get_steps()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Retrieves steps applied survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$get_steps()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"list containing steps implantation follow-surveys.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-get-recipes-","dir":"Reference","previous_headings":"","what":"Method get_recipes()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Retrieves recipes associated survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$get_recipes()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"list recipes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-get-workflows-","dir":"Reference","previous_headings":"","what":"Method get_workflows()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Retrieves workflows associated survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$get_workflows()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"list workflows.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-get-design-","dir":"Reference","previous_headings":"","what":"Method get_design()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Retrieves design object survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$get_design()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"returns-7","dir":"Reference","previous_headings":"","what":"Returns","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"design object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"Prints metadata RotativePanelSurvey object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$print()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"RotativePanelSurvey$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/RotativePanelSurvey.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RotativePanelSurvey Class — RotativePanelSurvey","text":"","code":"impl <- Survey$new(   data = data.table::data.table(id = 1:5, w = 1),   edition = \"2023\", type = \"ech\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) fu1 <- Survey$new(   data = data.table::data.table(id = 1:5, w = 1),   edition = \"2023_01\", type = \"ech\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) panel <- RotativePanelSurvey$new(   implantation = impl, follow_up = list(fu1),   type = \"ech\", default_engine = \"data.table\",   steps = list(), recipes = list(), workflows = list(), design = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":null,"dir":"Reference","previous_headings":"","what":"Step Class Represents a step in a survey workflow. — Step","title":"Step Class Represents a step in a survey workflow. — Step","text":"Step class used define manage individual steps survey workflow. step can include operations recoding variables, computing new variables, validating dependencies.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Step Class Represents a step in a survey workflow. — Step","text":"Step class part survey workflow system designed encapsulate information operations required single step workflow. Steps can chained together form complete workflow.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"Step Class Represents a step in a survey workflow. — Step","text":"name name step. edition edition survey associated step. survey_type type survey associated step. type type operation performed step (e.g., \"compute\", \"recode\"). new_var name new variable created step, applicable. exprs list expressions defining step's operations. call function call associated step. svy_before Deprecated. Always NULL prevent memory retention chains. Kept backwards compatibility. default_engine default engine used processing step. depends_on list variables step depends . comment Comments notes step. bake logical value indicating whether step executed.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"Step Class Represents a step in a survey workflow. — Step","text":"Step$new() Step$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"Step Class Represents a step in a survey workflow. — Step","text":"Create new Step object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Step Class Represents a step in a survey workflow. — Step","text":"","code":"Step$new(   name,   edition,   survey_type,   type,   new_var,   exprs,   call,   svy_before,   default_engine,   depends_on,   comment = NULL,   bake = !lazy_default(),   comments = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Step Class Represents a step in a survey workflow. — Step","text":"name name step. edition edition survey associated step. survey_type type survey associated step. type type operation performed step (e.g., \"compute\" \"recode\"). new_var name new variable created step, applicable. exprs list expressions defining step's operations. call function call associated step. svy_before Deprecated. Ignored (always set NULL) prevent memory retention chains. default_engine default engine used processing step. depends_on list variables step depends . comment Comments notes step. bake logical value indicating whether step executed. comments Use comment instead.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"Step Class Represents a step in a survey workflow. — Step","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"Step Class Represents a step in a survey workflow. — Step","text":"","code":"Step$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"Step Class Represents a step in a survey workflow. — Step","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Step.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Step Class Represents a step in a survey workflow. — Step","text":"","code":"# Step objects are created internally by step_compute(), step_recode(), etc. # Use the tidy API: dt <- data.table::data.table(id = 1:3, age = c(25, 30, 45), w = 1) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"test\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy <- step_compute(svy, age2 = age * 2) get_steps(svy) #> $`step_1 Compute: age2` #> <Step> #>   Public: #>     bake: FALSE #>     call: call #>     clone: function (deep = FALSE)  #>     comment: Compute step #>     default_engine: data.table #>     depends_on: age #>     edition: 2023 #>     exprs: call #>     initialize: function (name, edition, survey_type, type, new_var, exprs, call,  #>     name: step_1 Compute: age2 #>     new_var: age2 #>     survey_type: test #>     svy_before: NULL #>     type: compute #>"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":null,"dir":"Reference","previous_headings":"","what":"Survey R6 class — Survey","title":"Survey R6 class — Survey","text":"Survey R6 class Survey R6 class","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Survey R6 class — Survey","text":"R6 class generator (R6ClassGenerator)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Survey R6 class — Survey","text":"R6 class generator Survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Survey R6 class — Survey","text":"R6 class encapsulates survey data, metadata (type, edition, periodicity), sampling design (simple/replicate), steps/recipes/workflows, utilities manage . copies data; reuses design objects metadata. Much faster clone(deep=TRUE) design objects shared.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"main-methods","dir":"Reference","previous_headings":"","what":"Main methods","title":"Survey R6 class — Survey","text":"$new(data, edition, type, psu, strata, engine, weight, design = NULL, steps = NULL, recipes = list()) Constructor. $set_data(data) Set data. $set_edition(edition) Set edition. $set_type(type) Set type. $set_weight(weight) Set weight specification. $print() Print summarized metadata. $add_step(step) Add step invalidate design. $add_recipe(recipe) Add recipe (validates type dependencies). $add_workflow(workflow) Add workflow. $bake() Apply recipes return updated Survey. $ensure_design() Lazily initialize sampling design. $update_design() Update design variables current data. $shallow_clone() Efficient copy (shares design, copies data).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"Survey R6 class — Survey","text":"data Survey data (data.frame/data.table). edition Reference edition period. type Survey type, e.g., \"ech\" (character). periodicity Periodicity detected validate_time_pattern. default_engine Default engine (character). weight List weight specifications per estimation type. steps List steps applied survey. recipes List Recipe objects associated. workflows List workflows. design List survey design objects (survey/surveyrep). psu Primary Sampling Unit specification (formula character). strata Stratification variable name (character NULL). design_initialized Logical flag lazy design initialization. provenance Data lineage metadata (see provenance()).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"active-bindings","dir":"Reference","previous_headings":"","what":"Active bindings","title":"Survey R6 class — Survey","text":"design_active Deprecated. Use ensure_design() instead.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"Survey R6 class — Survey","text":"Survey$new() Survey$get_data() Survey$get_edition() Survey$get_type() Survey$set_data() Survey$set_edition() Survey$set_type() Survey$set_weight() Survey$print() Survey$add_step() Survey$add_recipe() Survey$add_workflow() Survey$bake() Survey$head() Survey$str() Survey$set_design() Survey$ensure_design() Survey$update_design() Survey$shallow_clone() Survey$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"Survey R6 class — Survey","text":"Create Survey object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$new(   data,   edition,   type,   psu = NULL,   strata = NULL,   engine,   weight,   design = NULL,   steps = NULL,   recipes = list() )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"data Survey data edition Edition period type Survey type (character) psu PSU variable formula (optional) strata Stratification variable name (optional) engine Default engine weight Weight specification(s) per estimation type design Pre-built design (optional) steps Initial steps list (optional) recipes List Recipe (optional)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-get-data-","dir":"Reference","previous_headings":"","what":"Method get_data()","title":"Survey R6 class — Survey","text":"Return underlying data","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$get_data()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-get-edition-","dir":"Reference","previous_headings":"","what":"Method get_edition()","title":"Survey R6 class — Survey","text":"Return survey edition/period","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$get_edition()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-get-type-","dir":"Reference","previous_headings":"","what":"Method get_type()","title":"Survey R6 class — Survey","text":"Return survey type identifier","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$get_type()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-set-data-","dir":"Reference","previous_headings":"","what":"Method set_data()","title":"Survey R6 class — Survey","text":"Set underlying data","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$set_data(data)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"data New survey data","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-set-edition-","dir":"Reference","previous_headings":"","what":"Method set_edition()","title":"Survey R6 class — Survey","text":"Set survey edition/period","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$set_edition(edition)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"edition New edition period","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-set-type-","dir":"Reference","previous_headings":"","what":"Method set_type()","title":"Survey R6 class — Survey","text":"Set survey type","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$set_type(type)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"type New type identifier","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-set-weight-","dir":"Reference","previous_headings":"","what":"Method set_weight()","title":"Survey R6 class — Survey","text":"Set weight specification(s) per estimation type","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$set_weight(weight)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"weight Weight specification list character","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"Survey R6 class — Survey","text":"Print summarized metadata console","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$print()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-add-step-","dir":"Reference","previous_headings":"","what":"Method add_step()","title":"Survey R6 class — Survey","text":"Add step invalidate design","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$add_step(step)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"step Step object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-add-recipe-","dir":"Reference","previous_headings":"","what":"Method add_recipe()","title":"Survey R6 class — Survey","text":"Add recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$add_recipe(recipe, bake = lazy_default())"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"recipe Recipe object bake Whether bake lazily (internal flag)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-add-workflow-","dir":"Reference","previous_headings":"","what":"Method add_workflow()","title":"Survey R6 class — Survey","text":"Add workflow survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$add_workflow(workflow)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"workflow Workflow object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-bake-","dir":"Reference","previous_headings":"","what":"Method bake()","title":"Survey R6 class — Survey","text":"Apply recipes return updated Survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$bake()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-head-","dir":"Reference","previous_headings":"","what":"Method head()","title":"Survey R6 class — Survey","text":"Return head underlying data","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$head()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-str-","dir":"Reference","previous_headings":"","what":"Method str()","title":"Survey R6 class — Survey","text":"Display structure underlying data","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-14","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$str()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-set-design-","dir":"Reference","previous_headings":"","what":"Method set_design()","title":"Survey R6 class — Survey","text":"Set survey design object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-15","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$set_design(design)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"design Survey design object list","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-ensure-design-","dir":"Reference","previous_headings":"","what":"Method ensure_design()","title":"Survey R6 class — Survey","text":"Ensure survey design initialized (lazy initialization)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-16","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$ensure_design()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"Survey R6 class — Survey","text":"Invisibly returns self","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-update-design-","dir":"Reference","previous_headings":"","what":"Method update_design()","title":"Survey R6 class — Survey","text":"Update design variables using current data weight","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-17","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$update_design()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-shallow-clone-","dir":"Reference","previous_headings":"","what":"Method shallow_clone()","title":"Survey R6 class — Survey","text":"Create shallow copy Survey (optimized performance)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-18","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$shallow_clone()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"Survey R6 class — Survey","text":"New Survey object copied data shared design","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"Survey R6 class — Survey","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"usage-19","dir":"Reference","previous_headings":"","what":"Usage","title":"Survey R6 class — Survey","text":"","code":"Survey$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"Survey R6 class — Survey","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/Survey.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Survey R6 class — Survey","text":"","code":"dt <- data.table::data.table(id = 1:5, x = rnorm(5), w = rep(1, 5)) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"test\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy #> Type: TEST #> Edition: 2023 #> Periodicity: Annual #> Engine: data.table #> Design:  #>   Design: Not initialized (lazy initialization - will be created when needed) #>  #> Steps: None #> Recipes: None"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":null,"dir":"Reference","previous_headings":"","what":"WorkflowBackend — WorkflowBackend","title":"WorkflowBackend — WorkflowBackend","text":"Backend-agnostic factory workflow storage retrieval. Supports \"local\" (JSON-backed WorkflowRegistry) \"api\" (remote plumber API) backends.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"WorkflowBackend — WorkflowBackend","text":"type Character backend type (\"local\" \"api\").","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"WorkflowBackend — WorkflowBackend","text":"WorkflowBackend$new() WorkflowBackend$publish() WorkflowBackend$search() WorkflowBackend$get() WorkflowBackend$increment_downloads() WorkflowBackend$find_by_recipe() WorkflowBackend$rank() WorkflowBackend$filter() WorkflowBackend$list_all() WorkflowBackend$save() WorkflowBackend$load() WorkflowBackend$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"WorkflowBackend — WorkflowBackend","text":"Create new WorkflowBackend","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$new(type, path = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"type Character. \"local\" \"api\". path Character. File path local backend (optional).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-publish-","dir":"Reference","previous_headings":"","what":"Method publish()","title":"WorkflowBackend — WorkflowBackend","text":"Publish workflow backend","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$publish(wf)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"wf RecipeWorkflow object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-search-","dir":"Reference","previous_headings":"","what":"Method search()","title":"WorkflowBackend — WorkflowBackend","text":"Search workflows","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$search(query)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"query Character search string","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowBackend — WorkflowBackend","text":"List matching RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-get-","dir":"Reference","previous_headings":"","what":"Method get()","title":"WorkflowBackend — WorkflowBackend","text":"Get workflow id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$get(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"id Workflow id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowBackend — WorkflowBackend","text":"RecipeWorkflow object NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-increment-downloads-","dir":"Reference","previous_headings":"","what":"Method increment_downloads()","title":"WorkflowBackend — WorkflowBackend","text":"Increment download count workflow","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$increment_downloads(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"id Workflow id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-find-by-recipe-","dir":"Reference","previous_headings":"","what":"Method find_by_recipe()","title":"WorkflowBackend — WorkflowBackend","text":"Find workflows reference specific recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$find_by_recipe(recipe_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"recipe_id Character recipe ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowBackend — WorkflowBackend","text":"List RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-rank-","dir":"Reference","previous_headings":"","what":"Method rank()","title":"WorkflowBackend — WorkflowBackend","text":"Rank workflows downloads","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$rank(n = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"n Integer max return","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowBackend — WorkflowBackend","text":"List RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-filter-","dir":"Reference","previous_headings":"","what":"Method filter()","title":"WorkflowBackend — WorkflowBackend","text":"Filter workflows criteria","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$filter(   survey_type = NULL,   edition = NULL,   recipe_id = NULL,   certification_level = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"survey_type Character NULL edition Character NULL recipe_id Character NULL certification_level Character NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowBackend — WorkflowBackend","text":"List matching RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-list-all-","dir":"Reference","previous_headings":"","what":"Method list_all()","title":"WorkflowBackend — WorkflowBackend","text":"List workflows","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$list_all()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowBackend — WorkflowBackend","text":"List RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-save-","dir":"Reference","previous_headings":"","what":"Method save()","title":"WorkflowBackend — WorkflowBackend","text":"Save local backend disk","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$save()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-load-","dir":"Reference","previous_headings":"","what":"Method load()","title":"WorkflowBackend — WorkflowBackend","text":"Load local backend disk","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$load()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"WorkflowBackend — WorkflowBackend","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowBackend — WorkflowBackend","text":"","code":"WorkflowBackend$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowBackend — WorkflowBackend","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowBackend.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"WorkflowBackend — WorkflowBackend","text":"","code":"if (FALSE) { # \\dontrun{ # Local backend (internal class, use set_workflow_backend() instead) backend <- WorkflowBackend$new(\"local\", path = tempfile(fileext = \".json\")) backend$search(\"labor\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":null,"dir":"Reference","previous_headings":"","what":"WorkflowRegistry — WorkflowRegistry","title":"WorkflowRegistry — WorkflowRegistry","text":"Local JSON-backed catalog workflow discovery, ranking, filtering.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"WorkflowRegistry — WorkflowRegistry","text":"WorkflowRegistry$new() WorkflowRegistry$register() WorkflowRegistry$unregister() WorkflowRegistry$search() WorkflowRegistry$filter() WorkflowRegistry$find_by_recipe() WorkflowRegistry$rank_by_downloads() WorkflowRegistry$get() WorkflowRegistry$list_all() WorkflowRegistry$save() WorkflowRegistry$load() WorkflowRegistry$stats() WorkflowRegistry$print() WorkflowRegistry$clone()","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"WorkflowRegistry — WorkflowRegistry","text":"Create new empty WorkflowRegistry","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$new()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-register-","dir":"Reference","previous_headings":"","what":"Method register()","title":"WorkflowRegistry — WorkflowRegistry","text":"Register workflow catalog","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$register(wf)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"wf RecipeWorkflow object register","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-unregister-","dir":"Reference","previous_headings":"","what":"Method unregister()","title":"WorkflowRegistry — WorkflowRegistry","text":"Remove workflow catalog id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$unregister(workflow_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"workflow_id Workflow id remove","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-search-","dir":"Reference","previous_headings":"","what":"Method search()","title":"WorkflowRegistry — WorkflowRegistry","text":"Search workflows name description (case-insensitive)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$search(query)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"query Character search query","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowRegistry — WorkflowRegistry","text":"List matching RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-filter-","dir":"Reference","previous_headings":"","what":"Method filter()","title":"WorkflowRegistry — WorkflowRegistry","text":"Filter workflows criteria","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$filter(   survey_type = NULL,   edition = NULL,   recipe_id = NULL,   certification_level = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"survey_type Character survey type NULL edition Character edition NULL recipe_id Character recipe ID NULL (find workflows using recipe) certification_level Character certification level NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowRegistry — WorkflowRegistry","text":"List matching RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-find-by-recipe-","dir":"Reference","previous_headings":"","what":"Method find_by_recipe()","title":"WorkflowRegistry — WorkflowRegistry","text":"Find workflows reference specific recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$find_by_recipe(recipe_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"recipe_id Character recipe ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowRegistry — WorkflowRegistry","text":"List RecipeWorkflow objects referencing recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-rank-by-downloads-","dir":"Reference","previous_headings":"","what":"Method rank_by_downloads()","title":"WorkflowRegistry — WorkflowRegistry","text":"Rank workflows download count (descending)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$rank_by_downloads(n = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"n Integer max number return, NULL ","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowRegistry — WorkflowRegistry","text":"List RecipeWorkflow objects sorted downloads","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-get-","dir":"Reference","previous_headings":"","what":"Method get()","title":"WorkflowRegistry — WorkflowRegistry","text":"Get single workflow id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$get(workflow_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"workflow_id Workflow id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowRegistry — WorkflowRegistry","text":"RecipeWorkflow object NULL","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-list-all-","dir":"Reference","previous_headings":"","what":"Method list_all()","title":"WorkflowRegistry — WorkflowRegistry","text":"List registered workflows","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$list_all()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowRegistry — WorkflowRegistry","text":"List RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-save-","dir":"Reference","previous_headings":"","what":"Method save()","title":"WorkflowRegistry — WorkflowRegistry","text":"Save registry catalog JSON file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$save(path)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"path Character file path","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-load-","dir":"Reference","previous_headings":"","what":"Method load()","title":"WorkflowRegistry — WorkflowRegistry","text":"Load registry catalog JSON file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$load(path)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"path Character file path","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-stats-","dir":"Reference","previous_headings":"","what":"Method stats()","title":"WorkflowRegistry — WorkflowRegistry","text":"Get registry statistics","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$stats()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"WorkflowRegistry — WorkflowRegistry","text":"List total, by_survey_type, by_certification counts","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"WorkflowRegistry — WorkflowRegistry","text":"Print registry summary","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$print(...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"... Additional arguments (used)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"WorkflowRegistry — WorkflowRegistry","text":"objects class cloneable method.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"WorkflowRegistry$clone(deep = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"arguments-10","dir":"Reference","previous_headings":"","what":"Arguments","title":"WorkflowRegistry — WorkflowRegistry","text":"deep Whether make deep clone.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/WorkflowRegistry.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"WorkflowRegistry — WorkflowRegistry","text":"","code":"# Use the tidy API instead: # set_workflow_backend(\"local\", path = \"workflows.json\") # publish_workflow(my_workflow) # search_workflows(\"labor\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_category.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a category to a recipe — add_category","title":"Add a category to a recipe — add_category","text":"Pipe-friendly function add category Recipe object. Accepts either category name (string) RecipeCategory object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_category.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a category to a recipe — add_category","text":"","code":"add_category(recipe, category, description = \"\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_category.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a category to a recipe — add_category","text":"recipe Recipe object. category Character category name RecipeCategory object. description Character. Description category (used category string). Defaults empty.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_category.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a category to a recipe — add_category","text":"modified Recipe object (invisibly piping).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_category.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add a category to a recipe — add_category","text":"","code":"r <- recipe(   name = \"Example\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Example recipe\" ) r <- r |>   add_category(\"labor_market\", \"Labor market indicators\") |>   add_category(\"income\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a recipe to a Survey — add_recipe","title":"Add a recipe to a Survey — add_recipe","text":"Tidy wrapper svy$add_recipe(recipe).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a recipe to a Survey — add_recipe","text":"","code":"add_recipe(svy, recipe, bake = lazy_default())"},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a recipe to a Survey — add_recipe","text":"svy Survey object recipe Recipe object bake Logical; whether bake immediately (default: lazy_default())","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a recipe to a Survey — add_recipe","text":"Survey object (invisibly), modified place","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add a recipe to a Survey — add_recipe","text":"","code":"svy <- survey_empty(type = \"ech\", edition = \"2023\") r <- recipe(   name = \"Example\", user = \"test\",   svy = svy, description = \"Example\" ) svy <- add_recipe(svy, r)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_replicate.html","id":null,"dir":"Reference","previous_headings":"","what":"Configure replicate weights for variance estimation — add_replicate","title":"Configure replicate weights for variance estimation — add_replicate","text":"function configures replicate weights (bootstrap, jackknife, etc.) allow estimation variance complex statistics surveys complex sampling designs. essential obtaining correct standard errors population estimates.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_replicate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Configure replicate weights for variance estimation — add_replicate","text":"","code":"add_replicate(   weight,   replicate_pattern,   replicate_path = NULL,   replicate_id = NULL,   replicate_type )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_replicate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Configure replicate weights for variance estimation — add_replicate","text":"weight String name main weight variable survey (e.g., \"pesoano\", \"pesomes\") replicate_pattern String regex pattern identify replicate weight columns. Examples: \"wr\\d+\" columns wr1, wr2, etc. replicate_path Path file containing replicate weights. NULL, assumes main dataset replicate_id Named vector specifying join main dataset replicate file. Format: c(\"main_var\" = \"replicate_var\") replicate_type Type replication used. Options: \"bootstrap\", \"jackknife\", \"BRR\" (Balanced Repeated Replication)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_replicate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Configure replicate weights for variance estimation — add_replicate","text":"List replicate configuration used sampling design variance estimation","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_replicate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Configure replicate weights for variance estimation — add_replicate","text":"Replicate weights essential : Correctly estimating variance complex designs Calculating appropriate confidence intervals Obtaining reliable coefficients variation Performing valid statistical tests regex pattern must exactly match replicate weight column names file. example, columns named \"wr001\", \"wr002\", etc., use pattern \"wr\\\\d+\". function typically used within add_weight() complex weight configurations.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_replicate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Configure replicate weights for variance estimation — add_replicate","text":"","code":"# Basic configuration with external file annual_replicates <- add_replicate(   weight = \"pesoano\",   replicate_pattern = \"wr\\\\d+\",   replicate_path = \"bootstrap_weights_2023.xlsx\",   replicate_id = c(\"ID_HOGAR\" = \"ID\"),   replicate_type = \"bootstrap\" )  # With replicates in same dataset integrated_replicates <- add_replicate(   weight = \"main_weight\",   replicate_pattern = \"rep_\\\\d{3}\",   replicate_type = \"jackknife\" )  # Use within add_weight weight_config <- add_weight(   annual = add_replicate(     weight = \"pesoano\",     replicate_pattern = \"wr\\\\d+\",     replicate_path = \"bootstrap_annual.xlsx\",     replicate_id = c(\"numero\" = \"ID_HOGAR\"),     replicate_type = \"bootstrap\"   ),   monthly = \"pesomes\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_weight.html","id":null,"dir":"Reference","previous_headings":"","what":"Configure weights by periodicity for Survey objects — add_weight","title":"Configure weights by periodicity for Survey objects — add_weight","text":"function creates weight structure allows specifying different weight variables according estimation periodicity. essential proper functioning workflows multiple temporal estimation types.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_weight.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Configure weights by periodicity for Survey objects — add_weight","text":"","code":"add_weight(monthly = NULL, annual = NULL, quarterly = NULL, biannual = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_weight.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Configure weights by periodicity for Survey objects — add_weight","text":"monthly String monthly weight variable name, replicate list created add_replicate monthly weights annual String annual weight variable name, replicate list annual weights quarterly String quarterly weight variable name, replicate list quarterly weights biannual String biannual weight variable name, replicate list biannual weights","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_weight.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Configure weights by periodicity for Survey objects — add_weight","text":"Named list weight configuration periodicity, used load_survey workflow automatically select appropriate weight","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_weight.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Configure weights by periodicity for Survey objects — add_weight","text":"function fundamental surveys require different weights according temporal estimation type. example, Uruguay's ECH specific weights monthly, quarterly, annual estimations. parameter can : simple string weight variable name replicate structure created add_replicate() bootstrap jackknife estimations Weights automatically selected workflow() according specified estimation_type parameter.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/add_weight.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Configure weights by periodicity for Survey objects — add_weight","text":"","code":"# Basic configuration with simple weight variables ech_weights <- add_weight(   monthly = \"pesomes\",   quarterly = \"pesotri\",   annual = \"pesoano\" )  # With bootstrap replicates for variance estimation weights_with_replicates <- add_weight(   monthly = add_replicate(     weight = \"pesomes\",     replicate_pattern = \"wr\\\\d+\",     replicate_path = \"monthly_replicate_weights.xlsx\",     replicate_id = c(\"ID_HOGAR\" = \"ID\"),     replicate_type = \"bootstrap\"   ),   annual = \"pesoano\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_catalog_search.html","id":null,"dir":"Reference","previous_headings":"","what":"Search ANDA5 catalog — anda_catalog_search","title":"Search ANDA5 catalog — anda_catalog_search","text":"Queries ANDA5 REST API list available survey datasets.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_catalog_search.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search ANDA5 catalog — anda_catalog_search","text":"","code":"anda_catalog_search(   keyword = \"ECH\",   base_url = \"https://www4.ine.gub.uy/Anda5\",   limit = 50 )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_catalog_search.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Search ANDA5 catalog — anda_catalog_search","text":"keyword Character search term (e.g., \"ECH\") base_url Character base URL ANDA5 instance limit Integer max results return","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_catalog_search.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search ANDA5 catalog — anda_catalog_search","text":"data.frame columns: id, title, year_start, year_end","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_download_microdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Download ECH microdata from ANDA5 — anda_download_microdata","title":"Download ECH microdata from ANDA5 — anda_download_microdata","text":"Downloads microdata files given ECH edition INE Uruguay's ANDA5 catalog. Automatically accepts terms use, parses available resources, downloads appropriate file.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_download_microdata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download ECH microdata from ANDA5 — anda_download_microdata","text":"","code":"anda_download_microdata(   edition,   resource = \"implantation\",   dest_dir = tempdir(),   base_url = \"https://www4.ine.gub.uy/Anda5\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_download_microdata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download ECH microdata from ANDA5 — anda_download_microdata","text":"edition Character year (e.g., \"2023\") resource Character type resource download. One : \"implantation\" (default) Main implantation file. editions < 2022, downloads main microdata file. \"monthly\" Monthly follow-files (editions >= 2022 ). Returns character vector paths, one per month. \"bootstrap_annual\" Annual bootstrap replicate weights. \"bootstrap_monthly\" Monthly bootstrap replicate weights. \"bootstrap_quarterly\" Quarterly bootstrap replicate weights. \"bootstrap_semestral\" Semestral bootstrap replicate weights. \"poverty\" Poverty line microdata (Microdatos_LP). dest_dir Character directory save files. Defaults temporary directory. base_url Character base URL ANDA5 instance","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_download_microdata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download ECH microdata from ANDA5 — anda_download_microdata","text":"Character path (vector paths monthly) downloaded file(s), ready pass load_survey() data.table::fread().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_download_microdata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download ECH microdata from ANDA5 — anda_download_microdata","text":"editions >= 2022, ANDA provides separate files implantation, monthly follow-ups, bootstrap replicate weights. Use resource parameter select file download.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_download_microdata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download ECH microdata from ANDA5 — anda_download_microdata","text":"","code":"if (FALSE) { # \\dontrun{ path <- anda_download_microdata(\"2023\", resource = \"implantation\") svy <- load_survey(path, svy_type = \"ech\", svy_edition = \"2023\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_fetch_ddi.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch DDI XML from ANDA5 catalog — anda_fetch_ddi","title":"Fetch DDI XML from ANDA5 catalog — anda_fetch_ddi","text":"Downloads DDI (Data Documentation Initiative) XML file given catalog entry INE Uruguay's ANDA5 catalog.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_fetch_ddi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch DDI XML from ANDA5 catalog — anda_fetch_ddi","text":"","code":"anda_fetch_ddi(   catalog_id,   base_url = \"https://www4.ine.gub.uy/Anda5\",   dest_file = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_fetch_ddi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch DDI XML from ANDA5 catalog — anda_fetch_ddi","text":"catalog_id Integer catalog ID (e.g., 767 ECH 2024) base_url Character base URL ANDA5 instance dest_file Character path save XML file. NULL, uses temporary file.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_fetch_ddi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch DDI XML from ANDA5 catalog — anda_fetch_ddi","text":"Character path downloaded DDI XML file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_list_editions.html","id":null,"dir":"Reference","previous_headings":"","what":"List available ECH editions in ANDA5 — anda_list_editions","title":"List available ECH editions in ANDA5 — anda_list_editions","text":"Returns known ECH editions available INE Uruguay's ANDA5 catalog.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_list_editions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List available ECH editions in ANDA5 — anda_list_editions","text":"","code":"anda_list_editions()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_list_editions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List available ECH editions in ANDA5 — anda_list_editions","text":"data.frame columns: edition, catalog_id","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_parse_variables.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse variables from a DDI XML file — anda_parse_variables","title":"Parse variables from a DDI XML file — anda_parse_variables","text":"Reads DDI Codebook XML file extracts variable-level metadata: name, label, type (discrete/continuous), value labels.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_parse_variables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse variables from a DDI XML file — anda_parse_variables","text":"","code":"anda_parse_variables(ddi_xml_path)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_parse_variables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse variables from a DDI XML file — anda_parse_variables","text":"ddi_xml_path Character path DDI XML file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_parse_variables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse variables from a DDI XML file — anda_parse_variables","text":"list variable metadata, : name, label, type, value_labels (named list NULL), description","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variable_detail.html","id":null,"dir":"Reference","previous_headings":"","what":"Get detailed metadata for a single ANDA variable — anda_variable_detail","title":"Get detailed metadata for a single ANDA variable — anda_variable_detail","text":"Get detailed metadata single ANDA variable","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variable_detail.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get detailed metadata for a single ANDA variable — anda_variable_detail","text":"","code":"anda_variable_detail(survey_type = \"ech\", var_name)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variable_detail.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get detailed metadata for a single ANDA variable — anda_variable_detail","text":"survey_type Character survey type (default \"ech\") var_name Character variable name","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variable_detail.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get detailed metadata for a single ANDA variable — anda_variable_detail","text":"list : name, label, type, value_labels, description. NULL found.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variables.html","id":null,"dir":"Reference","previous_headings":"","what":"Query ANDA variable metadata from the API — anda_variables","title":"Query ANDA variable metadata from the API — anda_variables","text":"Fetches variable metadata (labels, types, value labels) metasurvey API's ANDA endpoint.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Query ANDA variable metadata from the API — anda_variables","text":"","code":"anda_variables(survey_type = \"ech\", var_names = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Query ANDA variable metadata from the API — anda_variables","text":"survey_type Character survey type (default \"ech\") var_names Character vector variable names look . NULL, returns variables survey type.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Query ANDA variable metadata from the API — anda_variables","text":"data.frame columns: name, label, type","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/anda_variables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Query ANDA variable metadata from the API — anda_variables","text":"","code":"if (FALSE) { # \\dontrun{ anda_variables(\"ech\", c(\"pobpcoac\", \"e27\")) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_client.html","id":null,"dir":"Reference","previous_headings":"","what":"API Client for metasurvey — api_client","title":"API Client for metasurvey — api_client","text":"HTTP client metasurvey REST API (plumber). metasurvey API server deployed separately (Docker, Cloud Run, etc.). Users R package interact client functions.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_client.html","id":"setup","dir":"Reference","previous_headings":"","what":"Setup","title":"API Client for metasurvey — api_client","text":"","code":"# 1. Point to the deployed API configure_api(url = \"https://metasurvey-api.example.com\")  # 2. Register or login api_register(\"Ana Garcia\", \"ana@example.com\", \"password123\") api_login(\"ana@example.com\", \"password123\")  # 3. Use the API api_list_recipes(survey_type = \"ech\") api_publish_recipe(my_recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a comment to a recipe — api_comment_recipe","title":"Add a comment to a recipe — api_comment_recipe","text":"Post text comment recipe. Requires authentication.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a comment to a recipe — api_comment_recipe","text":"","code":"api_comment_recipe(id, text)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a comment to a recipe — api_comment_recipe","text":"id Recipe ID text Comment text (max 2000 characters)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a comment to a recipe — api_comment_recipe","text":"Invisibly, API response.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add a comment to a recipe — api_comment_recipe","text":"","code":"if (FALSE) { # \\dontrun{ api_comment_recipe(\"r_1739654400_742\", \"Great recipe!\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Add a comment to a workflow — api_comment_workflow","title":"Add a comment to a workflow — api_comment_workflow","text":"Post text comment workflow. Requires authentication.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add a comment to a workflow — api_comment_workflow","text":"","code":"api_comment_workflow(id, text)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add a comment to a workflow — api_comment_workflow","text":"id Workflow ID text Comment text (max 2000 characters)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add a comment to a workflow — api_comment_workflow","text":"Invisibly, API response.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_comment_workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add a comment to a workflow — api_comment_workflow","text":"","code":"if (FALSE) { # \\dontrun{ api_comment_workflow(\"w_1739654400_123\", \"Very useful workflow!\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_delete_comment.html","id":null,"dir":"Reference","previous_headings":"","what":"Delete a comment — api_delete_comment","title":"Delete a comment — api_delete_comment","text":"Delete comment ID. comment author can delete . Requires authentication.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_delete_comment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delete a comment — api_delete_comment","text":"","code":"api_delete_comment(comment_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_delete_comment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delete a comment — api_delete_comment","text":"comment_id Comment ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_delete_comment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Delete a comment — api_delete_comment","text":"Invisibly, API response.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_delete_comment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Delete a comment — api_delete_comment","text":"","code":"if (FALSE) { # \\dontrun{ api_delete_comment(\"c_abc123\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_download_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Increment recipe download counter — api_download_recipe","title":"Increment recipe download counter — api_download_recipe","text":"Increment recipe download counter","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_download_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Increment recipe download counter — api_download_recipe","text":"","code":"api_download_recipe(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_download_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Increment recipe download counter — api_download_recipe","text":"id Recipe ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_download_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Increment workflow download counter — api_download_workflow","title":"Increment workflow download counter — api_download_workflow","text":"Increment workflow download counter","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_download_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Increment workflow download counter — api_download_workflow","text":"","code":"api_download_workflow(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_download_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Increment workflow download counter — api_download_workflow","text":"id Workflow ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_anda_variables.html","id":null,"dir":"Reference","previous_headings":"","what":"Get ANDA variable metadata from the API — api_get_anda_variables","title":"Get ANDA variable metadata from the API — api_get_anda_variables","text":"Get ANDA variable metadata API","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_anda_variables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get ANDA variable metadata from the API — api_get_anda_variables","text":"","code":"api_get_anda_variables(survey_type = \"ech\", var_names = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_anda_variables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get ANDA variable metadata from the API — api_get_anda_variables","text":"survey_type Character survey type (default \"ech\") var_names Character vector variable names. NULL, returns .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_anda_variables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get ANDA variable metadata from the API — api_get_anda_variables","text":"list variable metadata objects","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_anda_variables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get ANDA variable metadata from the API — api_get_anda_variables","text":"","code":"if (FALSE) { # \\dontrun{ api_get_anda_variables(\"ech\", c(\"pobpcoac\", \"e27\")) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Get recipe(s) by ID — api_get_recipe","title":"Get recipe(s) by ID — api_get_recipe","text":"Get recipe(s) ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get recipe(s) by ID — api_get_recipe","text":"","code":"api_get_recipe(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get recipe(s) by ID — api_get_recipe","text":"id Character vector recipe ID(s). length > 1, returns list.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get recipe(s) by ID — api_get_recipe","text":"single Recipe object (NULL) length(id) == 1. list Recipe objects length(id) > 1 (NULLs dropped).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get recipe(s) by ID — api_get_recipe","text":"","code":"if (FALSE) { # \\dontrun{ api_get_recipe(\"r_1739654400_742\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_comments.html","id":null,"dir":"Reference","previous_headings":"","what":"Get comments for a recipe — api_get_recipe_comments","title":"Get comments for a recipe — api_get_recipe_comments","text":"List comments recipe, sorted creation date.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_comments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get comments for a recipe — api_get_recipe_comments","text":"","code":"api_get_recipe_comments(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_comments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get comments for a recipe — api_get_recipe_comments","text":"id Recipe ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_comments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get comments for a recipe — api_get_recipe_comments","text":"List comment objects.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_comments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get comments for a recipe — api_get_recipe_comments","text":"","code":"if (FALSE) { # \\dontrun{ api_get_recipe_comments(\"r_1739654400_742\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_dependents.html","id":null,"dir":"Reference","previous_headings":"","what":"Get recipes that depend on a recipe — api_get_recipe_dependents","title":"Get recipes that depend on a recipe — api_get_recipe_dependents","text":"Find recipes whose depends_on_recipes field references given recipe ID (backlinks).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_dependents.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get recipes that depend on a recipe — api_get_recipe_dependents","text":"","code":"api_get_recipe_dependents(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_dependents.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get recipes that depend on a recipe — api_get_recipe_dependents","text":"id Recipe ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_dependents.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get recipes that depend on a recipe — api_get_recipe_dependents","text":"List recipe summaries (id, name, user).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_dependents.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get recipes that depend on a recipe — api_get_recipe_dependents","text":"","code":"if (FALSE) { # \\dontrun{ api_get_recipe_dependents(\"r_1739654400_742\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_stars.html","id":null,"dir":"Reference","previous_headings":"","what":"Get star summary for a recipe — api_get_recipe_stars","title":"Get star summary for a recipe — api_get_recipe_stars","text":"Returns average rating, count, current user's rating (authenticated).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_stars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get star summary for a recipe — api_get_recipe_stars","text":"","code":"api_get_recipe_stars(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_stars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get star summary for a recipe — api_get_recipe_stars","text":"id Recipe ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_stars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get star summary for a recipe — api_get_recipe_stars","text":"List average, count, optionally user_value.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_recipe_stars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get star summary for a recipe — api_get_recipe_stars","text":"","code":"if (FALSE) { # \\dontrun{ api_get_recipe_stars(\"r_1739654400_742\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a single workflow by ID — api_get_workflow","title":"Get a single workflow by ID — api_get_workflow","text":"Get single workflow ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a single workflow by ID — api_get_workflow","text":"","code":"api_get_workflow(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a single workflow by ID — api_get_workflow","text":"id Workflow ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a single workflow by ID — api_get_workflow","text":"RecipeWorkflow object NULL","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a single workflow by ID — api_get_workflow","text":"","code":"if (FALSE) { # \\dontrun{ api_get_workflow(\"w_1739654400_123\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_comments.html","id":null,"dir":"Reference","previous_headings":"","what":"Get comments for a workflow — api_get_workflow_comments","title":"Get comments for a workflow — api_get_workflow_comments","text":"List comments workflow, sorted creation date.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_comments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get comments for a workflow — api_get_workflow_comments","text":"","code":"api_get_workflow_comments(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_comments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get comments for a workflow — api_get_workflow_comments","text":"id Workflow ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_comments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get comments for a workflow — api_get_workflow_comments","text":"List comment objects.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_comments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get comments for a workflow — api_get_workflow_comments","text":"","code":"if (FALSE) { # \\dontrun{ api_get_workflow_comments(\"w_1739654400_123\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_stars.html","id":null,"dir":"Reference","previous_headings":"","what":"Get star summary for a workflow — api_get_workflow_stars","title":"Get star summary for a workflow — api_get_workflow_stars","text":"Returns average rating, count, current user's rating (authenticated).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_stars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get star summary for a workflow — api_get_workflow_stars","text":"","code":"api_get_workflow_stars(id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_stars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get star summary for a workflow — api_get_workflow_stars","text":"id Workflow ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_stars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get star summary for a workflow — api_get_workflow_stars","text":"List average, count, optionally user_value.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_get_workflow_stars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get star summary for a workflow — api_get_workflow_stars","text":"","code":"if (FALSE) { # \\dontrun{ api_get_workflow_stars(\"w_1739654400_123\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"List recipes from API — api_list_recipes","title":"List recipes from API — api_list_recipes","text":"Fetch recipes optional search filters.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List recipes from API — api_list_recipes","text":"","code":"api_list_recipes(   search = NULL,   survey_type = NULL,   topic = NULL,   certification = NULL,   user = NULL,   limit = 50,   offset = 0 )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_recipes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List recipes from API — api_list_recipes","text":"search Text search (matches name/description) survey_type Filter survey type (e.g., \"ech\") topic Filter topic certification Filter certification level user Filter author email limit Maximum results (default 50) offset Skip first N results (default 0)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List recipes from API — api_list_recipes","text":"List Recipe objects","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List recipes from API — api_list_recipes","text":"","code":"if (FALSE) { # \\dontrun{ configure_api(\"https://metasurvey-api.example.com\") recipes <- api_list_recipes(survey_type = \"ech\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_workflows.html","id":null,"dir":"Reference","previous_headings":"","what":"List workflows from API — api_list_workflows","title":"List workflows from API — api_list_workflows","text":"Fetch workflows optional search filters.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_workflows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List workflows from API — api_list_workflows","text":"","code":"api_list_workflows(   search = NULL,   survey_type = NULL,   recipe_id = NULL,   user = NULL,   limit = 50,   offset = 0 )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_workflows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List workflows from API — api_list_workflows","text":"search Text search survey_type Filter survey type recipe_id Filter workflows reference recipe user Filter author email limit Maximum results offset Skip first N results","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_workflows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List workflows from API — api_list_workflows","text":"List RecipeWorkflow objects","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_list_workflows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List workflows from API — api_list_workflows","text":"","code":"if (FALSE) { # \\dontrun{ api_list_workflows(survey_type = \"ech\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_login.html","id":null,"dir":"Reference","previous_headings":"","what":"Login — api_login","title":"Login — api_login","text":"Authenticate metasurvey API. success JWT token stored automatically.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_login.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Login — api_login","text":"","code":"api_login(email, password)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_login.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Login — api_login","text":"email Email address password Password","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_login.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Login — api_login","text":"Invisibly, API response.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_login.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Login — api_login","text":"","code":"if (FALSE) { # \\dontrun{ api_login(\"ana@example.com\", \"s3cret\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_logout.html","id":null,"dir":"Reference","previous_headings":"","what":"Logout — api_logout","title":"Logout — api_logout","text":"Clear stored API token memory environment.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_logout.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logout — api_logout","text":"","code":"api_logout()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_logout.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logout — api_logout","text":"Invisibly, NULL.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_logout.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logout — api_logout","text":"","code":"# \\donttest{ api_logout() #> Logged out. # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_me.html","id":null,"dir":"Reference","previous_headings":"","what":"Get current user profile — api_me","title":"Get current user profile — api_me","text":"Returns profile info currently authenticated user.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_me.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get current user profile — api_me","text":"","code":"api_me()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_me.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get current user profile — api_me","text":"List user fields (name, email, user_type, etc.)","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_me.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get current user profile — api_me","text":"","code":"if (FALSE) { # \\dontrun{ api_me() } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Publish a recipe — api_publish_recipe","title":"Publish a recipe — api_publish_recipe","text":"Publish Recipe object API. Requires authentication (call api_login() first).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Publish a recipe — api_publish_recipe","text":"","code":"api_publish_recipe(recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Publish a recipe — api_publish_recipe","text":"recipe Recipe object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Publish a recipe — api_publish_recipe","text":"Invisibly, API response assigned ID.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Publish a recipe — api_publish_recipe","text":"","code":"if (FALSE) { # \\dontrun{ api_publish_recipe(my_recipe) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Publish a workflow — api_publish_workflow","title":"Publish a workflow — api_publish_workflow","text":"Publish RecipeWorkflow object API. Requires authentication.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Publish a workflow — api_publish_workflow","text":"","code":"api_publish_workflow(workflow)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Publish a workflow — api_publish_workflow","text":"workflow RecipeWorkflow object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Publish a workflow — api_publish_workflow","text":"Invisibly, API response.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_publish_workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Publish a workflow — api_publish_workflow","text":"","code":"if (FALSE) { # \\dontrun{ api_publish_workflow(my_workflow) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_refresh_token.html","id":null,"dir":"Reference","previous_headings":"","what":"Refresh JWT token — api_refresh_token","title":"Refresh JWT token — api_refresh_token","text":"Request new JWT token using current (still valid) token. new token stored automatically. called internally api_request() current token close expiry (within 5 minutes).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_refresh_token.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Refresh JWT token — api_refresh_token","text":"","code":"api_refresh_token()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_refresh_token.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Refresh JWT token — api_refresh_token","text":"new token string (invisibly), NULL refresh fails.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_refresh_token.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Refresh JWT token — api_refresh_token","text":"","code":"if (FALSE) { # \\dontrun{ api_refresh_token() } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_register.html","id":null,"dir":"Reference","previous_headings":"","what":"Register a new user — api_register","title":"Register a new user — api_register","text":"Create account metasurvey API. success JWT token stored automatically via options(metasurvey.api_token).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_register.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Register a new user — api_register","text":"","code":"api_register(   name,   email,   password,   user_type = \"individual\",   institution = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_register.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Register a new user — api_register","text":"name Display name email Email address password Password user_type One \"individual\", \"institutional_member\", \"institution\" institution Institution name (required \"institutional_member\")","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_register.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Register a new user — api_register","text":"Invisibly, API response (list ok, token, user).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_register.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Register a new user — api_register","text":"","code":"if (FALSE) { # \\dontrun{ configure_api(\"https://metasurvey-api.example.com\") api_register(\"Ana Garcia\", \"ana@example.com\", \"s3cret\") } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Rate a recipe — api_star_recipe","title":"Rate a recipe — api_star_recipe","text":"Give star rating (1-5) recipe. Requires authentication. user can one rating per recipe (upserts subsequent calls).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rate a recipe — api_star_recipe","text":"","code":"api_star_recipe(id, value)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rate a recipe — api_star_recipe","text":"id Recipe ID value Integer rating 1 5","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rate a recipe — api_star_recipe","text":"Invisibly, API response.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rate a recipe — api_star_recipe","text":"","code":"if (FALSE) { # \\dontrun{ api_star_recipe(\"r_1739654400_742\", 5) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Rate a workflow — api_star_workflow","title":"Rate a workflow — api_star_workflow","text":"Give star rating (1-5) workflow. Requires authentication.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rate a workflow — api_star_workflow","text":"","code":"api_star_workflow(id, value)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rate a workflow — api_star_workflow","text":"id Workflow ID value Integer rating 1 5","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rate a workflow — api_star_workflow","text":"Invisibly, API response.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_star_workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rate a workflow — api_star_workflow","text":"","code":"if (FALSE) { # \\dontrun{ api_star_workflow(\"w_1739654400_123\", 4) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_track_download.html","id":null,"dir":"Reference","previous_headings":"","what":"Increment download counter (generic) — api_track_download","title":"Increment download counter (generic) — api_track_download","text":"Increment download counter (generic)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_track_download.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Increment download counter (generic) — api_track_download","text":"","code":"api_track_download(type, id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/api_track_download.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Increment download counter (generic) — api_track_download","text":"type \"recipe\" \"workflow\" id Object ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"Bake recipes — bake_recipes","title":"Bake recipes — bake_recipes","text":"Bake recipes","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bake recipes — bake_recipes","text":"","code":"bake_recipes(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_recipes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bake recipes — bake_recipes","text":"svy Survey object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bake recipes — bake_recipes","text":"Survey object recipes applied","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bake recipes — bake_recipes","text":"","code":"# \\donttest{ dt <- data.table::data.table(id = 1:20, x = rnorm(20), w = runif(20, 0.5, 2)) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"demo\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) r <- recipe(   name = \"Demo\", user = \"test\", svy = svy,   description = \"Demo recipe\" ) svy <- add_recipe(svy, r) processed <- bake_recipes(svy) # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_steps.html","id":null,"dir":"Reference","previous_headings":"","what":"Execute all pending steps — bake_steps","title":"Execute all pending steps — bake_steps","text":"Iterates pending (lazy) steps attached Survey RotativePanelSurvey executes sequentially, mutating underlying data.table. step validated execution (checks required variables exist).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_steps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Execute all pending steps — bake_steps","text":"","code":"bake_steps(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_steps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Execute all pending steps — bake_steps","text":"svy Survey RotativePanelSurvey object pending steps","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_steps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Execute all pending steps — bake_steps","text":"object steps materialized data step marked bake = TRUE.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_steps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Execute all pending steps — bake_steps","text":"Steps executed order added. step's expressions can reference variables created previous steps. RotativePanelSurvey objects, steps applied implantation follow-surveys.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/bake_steps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Execute all pending steps — bake_steps","text":"","code":"dt <- data.table::data.table(id = 1:5, age = c(15, 30, 45, 50, 70), w = 1) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"test\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy <- step_compute(svy, age2 = age * 2) svy <- bake_steps(svy) get_data(svy) #>       id   age     w  age2 #>    <int> <num> <num> <num> #> 1:     1    15     1    30 #> 2:     2    30     1    60 #> 3:     3    45     1    90 #> 4:     4    50     1   100 #> 5:     5    70     1   140"},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Display survey design information — cat_design","title":"Display survey design information — cat_design","text":"Pretty-prints sampling design configuration estimation type Survey object, showing PSU, strata, weights, design elements color-coded, readable format.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Display survey design information — cat_design","text":"","code":"cat_design(self)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Display survey design information — cat_design","text":"self Survey object containing design information","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Display survey design information — cat_design","text":"Invisibly returns NULL; called side effect printing design info","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Display survey design information — cat_design","text":"function displays design information including: Primary Sampling Units (PSU/clusters) Stratification variables Weight variables estimation type Finite Population Correction (FPC) used Calibration formulas applied Overall design type classification Output color-coded better readability supporting terminals.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Display survey design information — cat_design","text":"","code":"# \\donttest{ dt <- data.table::data.table(id = 1:20, x = rnorm(20), w = runif(20, 0.5, 2)) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"demo\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) cat_design(svy) #> [1] \"\\n  Design: Not initialized (lazy initialization - will be created when needed)\\n\" # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design_type.html","id":null,"dir":"Reference","previous_headings":"","what":"cat_design_type — cat_design_type","title":"cat_design_type — cat_design_type","text":"Cast design type survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cat_design_type — cat_design_type","text":"","code":"cat_design_type(self, design_name)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cat_design_type — cat_design_type","text":"self Object class Survey design_name Name design","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cat_design_type — cat_design_type","text":"Character string describing design type, \"None\".","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_design_type.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"cat_design_type — cat_design_type","text":"","code":"# \\donttest{ dt <- data.table::data.table(id = 1:20, x = rnorm(20), w = runif(20, 0.5, 2)) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"demo\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) svy$ensure_design() cat_design_type(svy, \"annual\") #>  #> * Package: survey #> * Variance estimation: Ultimate cluster # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_estimation.default.html","id":null,"dir":"Reference","previous_headings":"","what":"cat_estimation_default — cat_estimation.default","title":"cat_estimation_default — cat_estimation.default","text":"cat_estimation_default","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_estimation.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cat_estimation_default — cat_estimation.default","text":"","code":"cat_estimation.default(estimation, call)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_estimation.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cat_estimation_default — cat_estimation.default","text":"estimation Estimation call Call","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"cat_recipes — cat_recipes","title":"cat_recipes — cat_recipes","text":"Cast recipes survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cat_recipes — cat_recipes","text":"","code":"cat_recipes(self)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_recipes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cat_recipes — cat_recipes","text":"self Object class Survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cat_recipes — cat_recipes","text":"Character string listing recipe names, \"None\".","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/cat_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"cat_recipes — cat_recipes","text":"","code":"if (FALSE) { # \\dontrun{ svy <- survey_empty(type = \"demo\", edition = \"2023\") cat_recipes(svy) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/certify_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Certify a recipe — certify_recipe","title":"Certify a recipe — certify_recipe","text":"Pipe-friendly function certify Recipe given quality level.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/certify_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Certify a recipe — certify_recipe","text":"","code":"certify_recipe(recipe, user, level)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/certify_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Certify a recipe — certify_recipe","text":"recipe Recipe object. user RecipeUser certifying. level Character. Certification level: \"reviewed\" \"official\".","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/certify_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Certify a recipe — certify_recipe","text":"modified Recipe object.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/certify_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Certify a recipe — certify_recipe","text":"","code":"r <- recipe(   name = \"Example\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Example recipe\" ) inst <- recipe_user(\"IECON\", type = \"institution\") r <- r |> certify_recipe(inst, \"official\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/collect_loop_body.html","id":null,"dir":"Reference","previous_headings":"","what":"Collect lines inside a loop body until closing brace — collect_loop_body","title":"Collect lines inside a loop body until closing brace — collect_loop_body","text":"Collect lines inside loop body closing brace","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/collect_loop_body.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collect lines inside a loop body until closing brace — collect_loop_body","text":"","code":"collect_loop_body(lines, start_idx)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/collect_loop_body.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collect lines inside a loop body until closing brace — collect_loop_body","text":"lines source lines start_idx Index line opening brace","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/collect_loop_body.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collect lines inside a loop body until closing brace — collect_loop_body","text":"List body (character vector) end_idx","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/configure_api.html","id":null,"dir":"Reference","previous_headings":"","what":"Configure metasurvey API — configure_api","title":"Configure metasurvey API — configure_api","text":"Set API base URL optionally load stored credentials. URL can also set via METASURVEY_API_URL environment variable, token via METASURVEY_TOKEN.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/configure_api.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Configure metasurvey API — configure_api","text":"","code":"configure_api(url)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/configure_api.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Configure metasurvey API — configure_api","text":"url API base URL (e.g., \"https://metasurvey-api.example.com\")","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/configure_api.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Configure metasurvey API — configure_api","text":"Invisibly, previous URL (restoring).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/configure_api.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Configure metasurvey API — configure_api","text":"","code":"# \\donttest{ configure_api(url = \"https://metasurvey-api.example.com\") #> API configured: https://metasurvey-api.example.com # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/default_categories.html","id":null,"dir":"Reference","previous_headings":"","what":"Default recipe categories — default_categories","title":"Default recipe categories — default_categories","text":"Returns list standard built-categories recipe classification.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/default_categories.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default recipe categories — default_categories","text":"","code":"default_categories()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/default_categories.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default recipe categories — default_categories","text":"List RecipeCategory objects","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/default_categories.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default recipe categories — default_categories","text":"","code":"cats <- default_categories() vapply(cats, function(c) c$name, character(1)) #> [1] \"labor_market\" \"income\"       \"education\"    \"health\"       \"demographics\" #> [6] \"housing\""},{"path":"https://metasurveyr.github.io/metasurvey/reference/default_engine.html","id":null,"dir":"Reference","previous_headings":"","what":"Set default engine — default_engine","title":"Set default engine — default_engine","text":"Sets default engine loading surveys. engine already configured, keeps ; otherwise, sets \"data.table\" default engine.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/default_engine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set default engine — default_engine","text":"","code":"default_engine(.engine = \"data.table\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/default_engine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set default engine — default_engine","text":".engine Character vector name default engine. default, \"data.table\" used.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_extract_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract downloaded ANDA file (handles ZIP, RAR, CSV, SAV) — .anda_extract_file","title":"Extract downloaded ANDA file (handles ZIP, RAR, CSV, SAV) — .anda_extract_file","text":"Extract downloaded ANDA file (handles ZIP, RAR, CSV, SAV)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_extract_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract downloaded ANDA file (handles ZIP, RAR, CSV, SAV) — .anda_extract_file","text":"","code":".anda_extract_file(raw_path, dest_dir, label)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_extract_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract downloaded ANDA file (handles ZIP, RAR, CSV, SAV) — .anda_extract_file","text":"raw_path Path raw downloaded file dest_dir Destination directory label Label naming extracted files","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_extract_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract downloaded ANDA file (handles ZIP, RAR, CSV, SAV) — .anda_extract_file","text":"Path extracted data file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_find_data_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Find the main data file in an extracted directory — .anda_find_data_file","title":"Find the main data file in an extracted directory — .anda_find_data_file","text":"Find main data file extracted directory","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_find_data_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find the main data file in an extracted directory — .anda_find_data_file","text":"","code":".anda_find_data_file(dir, label)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_find_data_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find the main data file in an extracted directory — .anda_find_data_file","text":"dir Character path extracted directory label Character label error messages","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_find_data_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find the main data file in an extracted directory — .anda_find_data_file","text":"Character path data file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_parse_resources.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse ANDA download page for resource titles and IDs — .anda_parse_resources","title":"Parse ANDA download page for resource titles and IDs — .anda_parse_resources","text":"Parse ANDA download page resource titles IDs","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_parse_resources.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse ANDA download page for resource titles and IDs — .anda_parse_resources","text":"","code":".anda_parse_resources(html, catalog_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_parse_resources.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse ANDA download page for resource titles and IDs — .anda_parse_resources","text":"html Character HTML content catalog_id Integer catalog ID","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_parse_resources.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse ANDA download page for resource titles and IDs — .anda_parse_resources","text":"data.frame columns: id, title","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_select_resource.html","id":null,"dir":"Reference","previous_headings":"","what":"Select resources matching the requested type — .anda_select_resource","title":"Select resources matching the requested type — .anda_select_resource","text":"Select resources matching requested type","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_select_resource.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select resources matching the requested type — .anda_select_resource","text":"","code":".anda_select_resource(resources, resource, edition)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_select_resource.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select resources matching the requested type — .anda_select_resource","text":"resources data.frame .anda_parse_resources resource Character resource type edition Character edition year","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/dot-anda_select_resource.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select resources matching the requested type — .anda_select_resource","text":"data.frame subset matching resources","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/evaluate_cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate estimation with Coefficient of Variation — evaluate_cv","title":"Evaluate estimation with Coefficient of Variation — evaluate_cv","text":"Evaluate estimation Coefficient Variation","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/evaluate_cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate estimation with Coefficient of Variation — evaluate_cv","text":"","code":"evaluate_cv(cv)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/evaluate_cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate estimation with Coefficient of Variation — evaluate_cv","text":"cv Numeric coefficient variation value.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/evaluate_cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate estimation with Coefficient of Variation — evaluate_cv","text":"Character string quality category (e.g. \"Excellent\", \"Good\").","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/evaluate_cv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate estimation with Coefficient of Variation — evaluate_cv","text":"","code":"evaluate_cv(3) # \"Excellent\" #> [1] \"Excellent\" evaluate_cv(12) # \"Good\" #> [1] \"Good\" evaluate_cv(30) # \"Use with caution\" #> [1] \"Use with caution\""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_loop_body.html","id":null,"dir":"Reference","previous_headings":"","what":"Substitute loop variable in body lines — expand_loop_body","title":"Substitute loop variable in body lines — expand_loop_body","text":"Substitute loop variable body lines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_loop_body.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Substitute loop variable in body lines — expand_loop_body","text":"","code":"expand_loop_body(loopvar, values, body)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_loop_body.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Substitute loop variable in body lines — expand_loop_body","text":"loopvar Loop variable name values Character vector values body Character vector body lines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_loop_body.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Substitute loop variable in body lines — expand_loop_body","text":"Character vector expanded lines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_numlist.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand a numlist specification into numeric values — expand_numlist","title":"Expand a numlist specification into numeric values — expand_numlist","text":"Expand numlist specification numeric values","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_numlist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand a numlist specification into numeric values — expand_numlist","text":"","code":"expand_numlist(spec)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_numlist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand a numlist specification into numeric values — expand_numlist","text":"spec Numlist string like \"1/14\" \"81/89\"","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_numlist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand a numlist specification into numeric values — expand_numlist","text":"Character vector values","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_stata_loops.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand STATA foreach and forvalues loops — expand_stata_loops","title":"Expand STATA foreach and forvalues loops — expand_stata_loops","text":"Detects foreach/forvalues blocks unrolls substituting loop variables body lines.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_stata_loops.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand STATA foreach and forvalues loops — expand_stata_loops","text":"","code":"expand_stata_loops(lines)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_stata_loops.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand STATA foreach and forvalues loops — expand_stata_loops","text":"lines Character vector source lines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_stata_loops.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand STATA foreach and forvalues loops — expand_stata_loops","text":"Character vector loops expanded","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_var_range.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand a STATA variable range to individual variable names — expand_var_range","title":"Expand a STATA variable range to individual variable names — expand_var_range","text":"STATA allows variable ranges like suma1-suma4 means suma1 suma2 suma3 suma4. function detects expands ranges incrementing trailing numeric suffix.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_var_range.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand a STATA variable range to individual variable names — expand_var_range","text":"","code":"expand_var_range(spec)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_var_range.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand a STATA variable range to individual variable names — expand_var_range","text":"spec Variable specification (may contain ranges -)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/expand_var_range.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand a STATA variable range to individual variable names — expand_var_range","text":"Character vector individual variable names","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/explore_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"Launch the Recipe Explorer Shiny App — explore_recipes","title":"Launch the Recipe Explorer Shiny App — explore_recipes","text":"Opens interactive web application explore, search, browse metasurvey recipes visual documentation cards. Supports user registration login via MongoDB Atlas.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/explore_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Launch the Recipe Explorer Shiny App — explore_recipes","text":"","code":"explore_recipes(port = NULL, host = \"127.0.0.1\", launch.browser = TRUE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/explore_recipes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Launch the Recipe Explorer Shiny App — explore_recipes","text":"port Integer port number, NULL automatic. host Character. host listen . Defaults \"127.0.0.1\" local use. Set \"0.0.0.0\" server deployments (Railway, etc.). launch.browser Logical. Open app browser?","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/explore_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Launch the Recipe Explorer Shiny App — explore_recipes","text":"NULL (called side effect launching app).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/explore_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Launch the Recipe Explorer Shiny App — explore_recipes","text":"","code":"if (FALSE) { # \\dontrun{ # Local / RStudio viewer explore_recipes()  # Server deployment (Railway, Docker, etc.) explore_recipes(host = \"0.0.0.0\", port = 3838, launch.browser = FALSE) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_surveys.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract surveys by periodicity from a rotating panel — extract_surveys","title":"Extract surveys by periodicity from a rotating panel — extract_surveys","text":"Extracts subsets surveys RotativePanelSurvey object based temporal criteria. Allows obtaining surveys different types analysis (monthly, quarterly, annual) respecting rotating panel's temporal structure.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_surveys.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract surveys by periodicity from a rotating panel — extract_surveys","text":"","code":"extract_surveys(   RotativePanelSurvey,   index = NULL,   monthly = NULL,   annual = NULL,   quarterly = NULL,   biannual = NULL,   use.parallel = FALSE )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_surveys.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract surveys by periodicity from a rotating panel — extract_surveys","text":"RotativePanelSurvey RotativePanelSurvey object containing rotating panel surveys organized temporally index Integer vector specifying survey indices extract. single value, returns survey; vector, returns list monthly Integer vector specifying months extract monthly analysis (1-12) annual Integer vector specifying years extract annual analysis quarterly Integer vector specifying quarters extract quarterly analysis (1-4) biannual Integer vector specifying semesters extract biannual analysis (1-2) use.parallel Logical indicating whether use parallel processing intensive operations. Default FALSE","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_surveys.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract surveys by periodicity from a rotating panel — extract_surveys","text":"list Survey objects matching specified criteria, single Survey object single index specified","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_surveys.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract surveys by periodicity from a rotating panel — extract_surveys","text":"function essential working rotating panels : Enables periodicity-based analysis: Extract data different types temporal estimations Preserves temporal structure: Respects temporal relationships different panel waves Optimizes memory: loads surveys needed analysis Facilitates comparisons: Extract specific periods comparative analysis Supports parallelization: operations large data volumes Extraction criteria interpreted according survey frequency: monthly ECH: monthly=c(1,3,6) extracts January, March June annual analysis: annual=1 typically extracts first available year quarterly analysis: quarterly=c(1,4) extracts Q1 Q4 criteria specified, function returns implantation survey warning.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_surveys.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract surveys by periodicity from a rotating panel — extract_surveys","text":"","code":"if (FALSE) { # \\dontrun{ # Load rotating panel panel_ech <- load_panel_survey(   path = \"ech_panel_2023.dta\",   svy_type = \"ech_panel\",   svy_edition = \"2023\" )  # Extract specific monthly surveys ech_q1 <- extract_surveys(   panel_ech,   monthly = c(1, 2, 3) # January, February, March )  # Extract by index ech_first <- extract_surveys(panel_ech, index = 1) ech_several <- extract_surveys(panel_ech, index = c(1, 3, 6))  # Quarterly analysis ech_Q1_Q4 <- extract_surveys(   panel_ech,   quarterly = c(1, 4) )  # Annual analysis (typically all surveys for the year) ech_annual <- extract_surveys(   panel_ech,   annual = 1 )  # With parallel processing for large volumes ech_full <- extract_surveys(   panel_ech,   monthly = 1:12,   use.parallel = TRUE )  # Use in workflow results <- workflow(   survey = extract_surveys(panel_ech, quarterly = c(1, 2)),   svymean(~unemployed, na.rm = TRUE),   estimation_type = \"quarterly\" ) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_time_pattern.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract time pattern — extract_time_pattern","title":"Extract time pattern — extract_time_pattern","text":"Extract time pattern","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_time_pattern.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract time pattern — extract_time_pattern","text":"","code":"extract_time_pattern(svy_edition)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_time_pattern.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract time pattern — extract_time_pattern","text":"svy_edition Survey edition string (e.g. \"2023\", \"2023-06\", \"2023_Q1\").","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_time_pattern.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract time pattern — extract_time_pattern","text":"List components: periodicity, year, month (applicable).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/extract_time_pattern.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract time pattern — extract_time_pattern","text":"","code":"# Annual edition extract_time_pattern(\"2023\") #> $year #> [1] 2023 #>  #> $periodicity #> [1] \"Annual\" #>   # Monthly edition extract_time_pattern(\"2023-06\") #> $year #> [1] 2023 #>  #> $month #> [1] 6 #>  #> $periodicity #> [1] \"Monthly\" #>"},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter recipes by criteria — filter_recipes","title":"Filter recipes by criteria — filter_recipes","text":"Filter recipes active backend survey type, edition, category, certification level.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter recipes by criteria — filter_recipes","text":"","code":"filter_recipes(   survey_type = NULL,   edition = NULL,   category = NULL,   certification_level = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_recipes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter recipes by criteria — filter_recipes","text":"survey_type Character survey type NULL. edition Character edition NULL. category Character category name NULL. certification_level Character certification level NULL.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter recipes by criteria — filter_recipes","text":"List matching Recipe objects.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter recipes by criteria — filter_recipes","text":"","code":"set_backend(\"local\", path = tempfile(fileext = \".json\")) ech_recipes <- filter_recipes(survey_type = \"ech\") length(ech_recipes) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_workflows.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter workflows by criteria — filter_workflows","title":"Filter workflows by criteria — filter_workflows","text":"Filter workflows active backend survey type, edition, recipe ID, certification level.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_workflows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter workflows by criteria — filter_workflows","text":"","code":"filter_workflows(   survey_type = NULL,   edition = NULL,   recipe_id = NULL,   certification_level = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_workflows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter workflows by criteria — filter_workflows","text":"survey_type Character survey type NULL (default NULL). edition Character edition NULL (default NULL). recipe_id Character recipe ID NULL (default NULL). Find workflows using recipe. certification_level Character certification level NULL (default NULL).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_workflows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter workflows by criteria — filter_workflows","text":"List matching RecipeWorkflow objects.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/filter_workflows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter workflows by criteria — filter_workflows","text":"","code":"set_workflow_backend(\"local\", path = tempfile(fileext = \".json\")) ech_wf <- filter_workflows(survey_type = \"ech\") length(ech_wf) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/reference/find_workflows_for_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Find workflows that use a specific recipe — find_workflows_for_recipe","title":"Find workflows that use a specific recipe — find_workflows_for_recipe","text":"Cross-reference query: find workflows reference given recipe ID.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/find_workflows_for_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find workflows that use a specific recipe — find_workflows_for_recipe","text":"","code":"find_workflows_for_recipe(recipe_id)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/find_workflows_for_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find workflows that use a specific recipe — find_workflows_for_recipe","text":"recipe_id Character recipe ID search .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/find_workflows_for_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find workflows that use a specific recipe — find_workflows_for_recipe","text":"List RecipeWorkflow objects reference recipe.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/find_workflows_for_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find workflows that use a specific recipe — find_workflows_for_recipe","text":"","code":"set_workflow_backend(\"local\", path = tempfile(fileext = \".json\")) wfs <- find_workflows_for_recipe(\"recipe_001\") length(wfs) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_backend.html","id":null,"dir":"Reference","previous_headings":"","what":"Get recipe backend — get_backend","title":"Get recipe backend — get_backend","text":"Returns currently configured recipe backend. Defaults \"api\" configured.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_backend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get recipe backend — get_backend","text":"","code":"get_backend()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_backend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get recipe backend — get_backend","text":"RecipeBackend object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_backend.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get recipe backend — get_backend","text":"","code":"set_backend(\"local\", path = tempfile(fileext = \".json\")) backend <- get_backend() backend #> <RecipeBackend> #>   Public: #>     clone: function (deep = FALSE)  #>     filter: function (survey_type = NULL, edition = NULL, category = NULL,  #>     get: function (id)  #>     increment_downloads: function (id)  #>     initialize: function (type, path = NULL)  #>     list_all: function ()  #>     load: function ()  #>     publish: function (recipe)  #>     rank: function (n = NULL)  #>     save: function ()  #>     search: function (query)  #>     type: local #>   Private: #>     .path: /tmp/RtmpvnGcvG/file1e252f20a2e6.json #>     .registry: RecipeRegistry, R6"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_data.html","id":null,"dir":"Reference","previous_headings":"","what":"get_data — get_data","title":"get_data — get_data","text":"Get data survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_data — get_data","text":"","code":"get_data(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_data — get_data","text":"svy Survey object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_data — get_data","text":"data.table (data.frame) containing survey microdata.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"get_data — get_data","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) head(get_data(svy)) #>       id   age     w #>    <int> <num> <num> #> 1:     1    25     1 #> 2:     2    30     1 #> 3:     3    45     1 #> 4:     4    50     1 #> 5:     5    60     1"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_engine.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the current survey data engine — get_engine","title":"Get the current survey data engine — get_engine","text":"Retrieves currently configured engine loading surveys system options environment variables.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_engine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the current survey data engine — get_engine","text":"","code":"get_engine()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_engine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the current survey data engine — get_engine","text":"Character vector name configured engine.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_engine.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the current survey data engine — get_engine","text":"","code":"get_engine() #> [1] \"data.table\""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_follow_up.html","id":null,"dir":"Reference","previous_headings":"","what":"Get follow-up surveys from a rotating panel — get_follow_up","title":"Get follow-up surveys from a rotating panel — get_follow_up","text":"Extracts one follow-surveys (waves implantation) RotativePanelSurvey object. Follow-surveys represent subsequent data collections essential longitudinal temporal change analysis.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_follow_up.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get follow-up surveys from a rotating panel — get_follow_up","text":"","code":"get_follow_up(   RotativePanelSurvey,   index = seq_along(RotativePanelSurvey$follow_up) )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_follow_up.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get follow-up surveys from a rotating panel — get_follow_up","text":"RotativePanelSurvey RotativePanelSurvey object extract follow-surveys index Integer vector specifying follow-surveys extract. Defaults available (1:length(follow_up)). Can single index vector indices","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_follow_up.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get follow-up surveys from a rotating panel — get_follow_up","text":"list Survey objects corresponding specified follow-surveys. single index specified, returns list one element","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_follow_up.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get follow-up surveys from a rotating panel — get_follow_up","text":"Follow-surveys fundamental rotating panels : Enable longitudinal analysis: Track units time Capture temporal changes: Evolution economic, social, demographic variables Maintain representativeness: wave preserves population representativeness controlled rotation Optimize resources: Reuse information previous waves reduce collection costs Facilitate comparisons: Consistent temporal structure trend analysis rotating panels like ECH: follow-wave covers specific period (monthly/quarterly) Units rotate gradually maintaining temporal overlap Indices correspond chronological collection order follow-maintains methodological consistency implantation","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_follow_up.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get follow-up surveys from a rotating panel — get_follow_up","text":"","code":"impl <- Survey$new(   data = data.table::data.table(id = 1:5, w = 1),   edition = \"2023\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) fu1 <- Survey$new(   data = data.table::data.table(id = 1:5, w = 1),   edition = \"2023_01\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) fu2 <- Survey$new(   data = data.table::data.table(id = 1:5, w = 1),   edition = \"2023_02\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) panel <- RotativePanelSurvey$new(   implantation = impl, follow_up = list(fu1, fu2),   type = \"test\", default_engine = \"data.table\",   steps = list(), recipes = list(), workflows = list(), design = NULL ) get_follow_up(panel, index = 1) #> [[1]] #> Type: TEST #> Edition: 2023-01 #> Periodicity: Monthly #> Engine: data.table #> Design:  #>   Design: Not initialized (lazy initialization - will be created when needed) #>  #> Steps: None #> Recipes: None  #>  get_follow_up(panel) #> [[1]] #> Type: TEST #> Edition: 2023-01 #> Periodicity: Monthly #> Engine: data.table #> Design:  #>   Design: Not initialized (lazy initialization - will be created when needed) #>  #> Steps: None #> Recipes: None  #>  #> [[2]] #> Type: TEST #> Edition: 2023-02 #> Periodicity: Monthly #> Engine: data.table #> Design:  #>   Design: Not initialized (lazy initialization - will be created when needed) #>  #> Steps: None #> Recipes: None  #>"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_implantation.html","id":null,"dir":"Reference","previous_headings":"","what":"Get implantation survey from a rotating panel — get_implantation","title":"Get implantation survey from a rotating panel — get_implantation","text":"Extracts implantation (baseline) survey RotativePanelSurvey object. implantation survey represents first data collection wave essential establishing baseline structural characteristics panel.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_implantation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get implantation survey from a rotating panel — get_implantation","text":"","code":"get_implantation(RotativePanelSurvey)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_implantation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get implantation survey from a rotating panel — get_implantation","text":"RotativePanelSurvey RotativePanelSurvey object extract implantation survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_implantation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get implantation survey from a rotating panel — get_implantation","text":"Survey object containing implantation survey metadata, data, design configuration","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_implantation.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get implantation survey from a rotating panel — get_implantation","text":"implantation survey special rotating panel : Establishes baseline: Defines initial characteristics panel units Contains full sample: Includes units participate different panel waves Defines temporal structure: Establishes rotation follow-patterns Configures metadata: Contains information periodicity, key variables, stratification Serves tracking reference: Basis unit tracking subsequent waves function essential analysis requiring: Temporal comparisons baseline Analysis complete panel structure Configuration longitudinal models Evaluation sampling design quality","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_implantation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get implantation survey from a rotating panel — get_implantation","text":"","code":"impl <- Survey$new(   data = data.table::data.table(id = 1:5, w = 1),   edition = \"2023\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) fu <- Survey$new(   data = data.table::data.table(id = 1:5, w = 1),   edition = \"2023_01\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) panel <- RotativePanelSurvey$new(   implantation = impl, follow_up = list(fu),   type = \"test\", default_engine = \"data.table\",   steps = list(), recipes = list(), workflows = list(), design = NULL ) get_implantation(panel) #> Type: TEST #> Edition: 2023 #> Periodicity: Annual #> Engine: data.table #> Design:  #>   Design: Not initialized (lazy initialization - will be created when needed) #>  #> Steps: None #> Recipes: None"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"get_metadata — get_metadata","title":"get_metadata — get_metadata","text":"Get metadata survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_metadata — get_metadata","text":"","code":"get_metadata(self)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_metadata — get_metadata","text":"self Object class Survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_metadata — get_metadata","text":"NULL (called side effect: prints metadata console).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"get_metadata — get_metadata","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) get_metadata(svy) #> Type: ECH #> Edition: 2023 #> Periodicity: Annual #> Engine: data.table #> Design:  #>   Design: Not initialized (lazy initialization - will be created when needed) #>  #> Steps: None #> Recipes: None"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Get recipe from repository or API — get_recipe","title":"Get recipe from repository or API — get_recipe","text":"function retrieves data transformation recipes metasurvey repository API, based specific criteria survey type, edition, topic. primary way access predefined community-validated recipes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get recipe from repository or API — get_recipe","text":"","code":"get_recipe(   svy_type = NULL,   svy_edition = NULL,   topic = NULL,   allowMultiple = TRUE )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get recipe from repository or API — get_recipe","text":"svy_type String specifying survey type. Examples: \"ech\", \"eaii\", \"eai\", \"eph\" svy_edition String specifying survey edition. Supported formats: \"YYYY\", \"YYYYMM\", \"YYYY-YYYY\" topic String specifying recipe topic. Examples: \"labor_market\", \"poverty\", \"income\", \"demographics\" allowMultiple Logical indicating whether multiple recipes allowed. FALSE multiple matches exist, returns recent one","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get recipe from repository or API — get_recipe","text":"Recipe object list Recipe objects according specified criteria value allowMultiple","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_recipe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get recipe from repository or API — get_recipe","text":"function essential : Accessing official recipes: Get validated maintained recipes specialized teams Reproducibility: Ensure different users apply standard transformations Automation: Integrate recipes automatic pipelines Collaboration: Share methodologies teams organizations Versioning: Access different recipe versions according edition function queries metasurvey API retrieve recipes. Internet connection required. API unavailable need work offline: Working Offline: call get_recipe() - work directly steps Set options(metasurvey.skip_recipes = TRUE) disable API calls Load recipes local files using read_recipe() Create custom recipes recipe() Search criteria combined operator, specified criteria must match recipe returned.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get recipe from repository or API — get_recipe","text":"","code":"if (FALSE) { # \\dontrun{ # Get specific recipe for ECH 2023 ech_recipe <- get_recipe(   svy_type = \"ech\",   svy_edition = \"2023\" )  # Recipe for specific topic labor_recipe <- get_recipe(   svy_type = \"ech\",   svy_edition = \"2023\",   topic = \"labor_market\" )  # Allow multiple recipes available_recipes <- get_recipe(   svy_type = \"eaii\",   svy_edition = \"2019-2021\",   allowMultiple = TRUE )  # Use recipe in load_survey ech_with_recipe <- load_survey(   path = \"ech_2023.dta\",   svy_type = \"ech\",   svy_edition = \"2023\",   recipes = get_recipe(\"ech\", \"2023\"),   bake = TRUE )  # Working offline - don't use recipes ech_offline <- load_survey(   path = \"ech_2023.dta\",   svy_type = \"ech\",   svy_edition = \"2023\",   svy_weight = add_weight(annual = \"PESOANO\") )  # Disable recipe API globally options(metasurvey.skip_recipes = TRUE) # Now get_recipe() will return NULL with a warning  # For year ranges panel_recipe <- get_recipe(   svy_type = \"ech_panel\",   svy_edition = \"2020-2023\" ) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_steps.html","id":null,"dir":"Reference","previous_headings":"","what":"get_steps — get_steps","title":"get_steps — get_steps","text":"Get steps survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_steps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get_steps — get_steps","text":"","code":"get_steps(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_steps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get_steps — get_steps","text":"svy Survey object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_steps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get_steps — get_steps","text":"List Step objects","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_steps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"get_steps — get_steps","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy <- step_compute(svy, age2 = age * 2) get_steps(svy) # list of Step objects #> $`step_1 Compute: age2` #> <Step> #>   Public: #>     bake: FALSE #>     call: call #>     clone: function (deep = FALSE)  #>     comment: Compute step #>     default_engine: data.table #>     depends_on: age #>     edition: 2023 #>     exprs: call #>     initialize: function (name, edition, survey_type, type, new_var, exprs, call,  #>     name: step_1 Compute: age2 #>     new_var: age2 #>     survey_type: ech #>     svy_before: NULL #>     type: compute #>"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_workflow_backend.html","id":null,"dir":"Reference","previous_headings":"","what":"Get workflow backend — get_workflow_backend","title":"Get workflow backend — get_workflow_backend","text":"Returns currently configured workflow backend. Defaults \"local\" configured.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_workflow_backend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get workflow backend — get_workflow_backend","text":"","code":"get_workflow_backend()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_workflow_backend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get workflow backend — get_workflow_backend","text":"WorkflowBackend object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/get_workflow_backend.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get workflow backend — get_workflow_backend","text":"","code":"backend <- get_workflow_backend()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/group_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Group dates — group_dates","title":"Group dates — group_dates","text":"Group dates","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/group_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group dates — group_dates","text":"","code":"group_dates(dates, type = c(\"monthly\", \"quarterly\", \"biannual\"))"},{"path":"https://metasurveyr.github.io/metasurvey/reference/group_dates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group dates — group_dates","text":"dates Vector Date objects. type Grouping type: \"monthly\", \"quarterly\", \"biannual\".","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/group_dates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Group dates — group_dates","text":"Integer vector group indices (e.g. 1-12 monthly, 1-4 quarterly).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/group_dates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Group dates — group_dates","text":"","code":"dates <- as.Date(c(   \"2023-01-15\", \"2023-04-20\",   \"2023-07-10\", \"2023-11-05\" )) group_dates(dates, \"quarterly\") #> 2023-01-15 2023-04-20 2023-07-10 2023-11-05  #>          1          2          3          4  group_dates(dates, \"biannual\") #> 2023-01-15 2023-04-20 2023-07-10 2023-11-05  #>          1          1          2          2"},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_design.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if survey has a design — has_design","title":"Check if survey has a design — has_design","text":"Check survey design","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_design.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if survey has a design — has_design","text":"","code":"has_design(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_design.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if survey has a design — has_design","text":"svy Survey object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_design.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if survey has a design — has_design","text":"Logical.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_design.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if survey has a design — has_design","text":"","code":"svy <- survey_empty(type = \"test\", edition = \"2023\") has_design(svy) # FALSE #> [1] FALSE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if survey has recipes — has_recipes","title":"Check if survey has recipes — has_recipes","text":"Check survey recipes","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if survey has recipes — has_recipes","text":"","code":"has_recipes(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_recipes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if survey has recipes — has_recipes","text":"svy Survey RotativePanelSurvey object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if survey has recipes — has_recipes","text":"Logical.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if survey has recipes — has_recipes","text":"","code":"svy <- survey_empty(type = \"test\", edition = \"2023\") has_recipes(svy) # FALSE #> [1] FALSE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_steps.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if survey has steps — has_steps","title":"Check if survey has steps — has_steps","text":"Check survey steps","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_steps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if survey has steps — has_steps","text":"","code":"has_steps(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_steps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if survey has steps — has_steps","text":"svy Survey RotativePanelSurvey object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_steps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if survey has steps — has_steps","text":"Logical.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/has_steps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if survey has steps — has_steps","text":"","code":"svy <- survey_empty(type = \"test\", edition = \"2023\") has_steps(svy) # FALSE #> [1] FALSE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_baked.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if all steps are baked — is_baked","title":"Check if all steps are baked — is_baked","text":"Returns TRUE every step attached survey executed (bake == TRUE), steps.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_baked.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if all steps are baked — is_baked","text":"","code":"is_baked(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_baked.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if all steps are baked — is_baked","text":"svy Survey RotativePanelSurvey object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_baked.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if all steps are baked — is_baked","text":"Logical.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_baked.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check if all steps are baked — is_baked","text":"","code":"svy <- survey_empty(type = \"test\", edition = \"2023\") is_baked(svy) # TRUE (no steps) #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_constant_rhs.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect if a STATA replace RHS is a constant value — is_constant_rhs","title":"Detect if a STATA replace RHS is a constant value — is_constant_rhs","text":"Returns TRUE expression simple numeric constant, string literal, negative number. Used decide step_recode (constants) step_compute (expressions).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_constant_rhs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect if a STATA replace RHS is a constant value — is_constant_rhs","text":"","code":"is_constant_rhs(expr)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_constant_rhs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect if a STATA replace RHS is a constant value — is_constant_rhs","text":"expr STATA expression string","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/is_constant_rhs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect if a STATA replace RHS is a constant value — is_constant_rhs","text":"Logical","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/join_broken_expressions.html","id":null,"dir":"Reference","previous_headings":"","what":"Join broken expression lines after block comment removal — join_broken_expressions","title":"Join broken expression lines after block comment removal — join_broken_expressions","text":"removing /* */ block comments, expressions can split across lines. function re-joins lines previous line ends operator open paren, next line starts operator close paren.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/join_broken_expressions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Join broken expression lines after block comment removal — join_broken_expressions","text":"","code":"join_broken_expressions(lines)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/join_broken_expressions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Join broken expression lines after block comment removal — join_broken_expressions","text":"lines Character vector source lines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/join_broken_expressions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Join broken expression lines after block comment removal — join_broken_expressions","text":"Character vector broken expressions re-joined","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/join_continuation_lines.html","id":null,"dir":"Reference","previous_headings":"","what":"Join STATA continuation lines — join_continuation_lines","title":"Join STATA continuation lines — join_continuation_lines","text":"STATA uses /// line continuation. function joins continued lines single commands.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/join_continuation_lines.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Join STATA continuation lines — join_continuation_lines","text":"","code":"join_continuation_lines(lines)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/join_continuation_lines.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Join STATA continuation lines — join_continuation_lines","text":"lines Character vector source lines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/join_continuation_lines.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Join STATA continuation lines — join_continuation_lines","text":"Character vector continuations joined","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/lazy_default.html","id":null,"dir":"Reference","previous_headings":"","what":"Lazy processing — lazy_default","title":"Lazy processing — lazy_default","text":"Lazy processing","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/lazy_default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lazy processing — lazy_default","text":"","code":"lazy_default()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/lazy_default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Lazy processing — lazy_default","text":"Logical indicating current lazy processing setting.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/lazy_default.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Lazy processing — lazy_default","text":"","code":"# Check current lazy processing default lazy_default() #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/list_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"List all recipes — list_recipes","title":"List all recipes — list_recipes","text":"List recipes active backend.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/list_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List all recipes — list_recipes","text":"","code":"list_recipes()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/list_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List all recipes — list_recipes","text":"List Recipe objects.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/list_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List all recipes — list_recipes","text":"","code":"set_backend(\"local\", path = tempfile(fileext = \".json\")) all <- list_recipes() length(all) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/reference/list_workflows.html","id":null,"dir":"Reference","previous_headings":"","what":"List all workflows — list_workflows","title":"List all workflows — list_workflows","text":"List workflows active workflow backend.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/list_workflows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List all workflows — list_workflows","text":"","code":"list_workflows()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/list_workflows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List all workflows — list_workflows","text":"List RecipeWorkflow objects.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/list_workflows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List all workflows — list_workflows","text":"","code":"set_workflow_backend(\"local\", path = tempfile(fileext = \".json\")) all <- list_workflows() length(all) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_panel_survey.html","id":null,"dir":"Reference","previous_headings":"","what":"Read panel survey files from different formats and create a RotativePanelSurvey object — load_panel_survey","title":"Read panel survey files from different formats and create a RotativePanelSurvey object — load_panel_survey","text":"Read panel survey files different formats create RotativePanelSurvey object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_panel_survey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read panel survey files from different formats and create a RotativePanelSurvey object — load_panel_survey","text":"","code":"load_panel_survey(   path_implantation,   path_follow_up,   svy_type,   svy_weight_implantation,   svy_weight_follow_up,   svy_strata = NULL,   ... )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_panel_survey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read panel survey files from different formats and create a RotativePanelSurvey object — load_panel_survey","text":"path_implantation Survey implantation path, file can different formats, csv, xtsx, dta, sav rds path_follow_up Path needed files survey valid files also can character vector path files. svy_type String survey type, supported types; \"ech\" (Encuensta Continua de Hogares, Uruguay), \"eph\" (Encuesta Permanente de Hogares, Argentina), \"eai\" (Encuesta de Actividades de Innovacion, Uruguay) svy_weight_implantation List survey implantation weights information specifing periodicity name weight variable. Recomended use helper function add_weight(). svy_weight_follow_up List survey follow_up weights information specifing periodicity name weight variable. Recomended use helper function add_weight(). svy_strata Stratification variable name (character NULL). Passed Survey$new(strata = ...). ... arguments passed load_panel_survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_panel_survey.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read panel survey files from different formats and create a RotativePanelSurvey object — load_panel_survey","text":"RotativePanelSurvey object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_panel_survey.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read panel survey files from different formats and create a RotativePanelSurvey object — load_panel_survey","text":"","code":"if (FALSE) { # \\dontrun{ # example code path_dir <- here::here(\"example-data\", \"ech\", \"ech_2023\") ech_2023 <- load_panel_survey(   path_implantation = file.path(     path_dir,     \"ECH_implantacion_2023.csv\"   ),   path_follow_up = file.path(     path_dir,     \"seguimiento\"   ),   svy_type = \"ECH_2023\",   svy_weight_implantation = add_weight(     annual = \"W_ANO\"   ),   svy_weight_follow_up = add_weight(     monthly = add_replicate(       \"W\",       replicate_path = file.path(         path_dir,         c(           \"Pesos replicados Bootstrap mensuales enero_junio 2023\",           \"Pesos replicados Bootstrap mensuales julio_diciembre 2023\"         ),         c(           \"Pesos replicados mensuales enero_junio 2023\",           \"Pesos replicados mensuales Julio_diciembre 2023\"         )       ),       replicate_id = c(\"ID\" = \"ID\"),       replicate_pattern = \"wr[0-9]+\",       replicate_type = \"bootstrap\"     )   ) ) } # } if (FALSE) { # \\dontrun{ # Example of loading a panel survey panel_survey <- load_panel_survey(   path_implantation = \"path/to/implantation.csv\",   path_follow_up = \"path/to/follow_up\",   svy_type = \"ech\",   svy_weight_implantation = add_weight(annual = \"w_ano\"),   svy_weight_follow_up = add_weight(monthly = \"w_monthly\") ) print(panel_survey) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey.html","id":null,"dir":"Reference","previous_headings":"","what":"Load survey from file and create Survey object — load_survey","title":"Load survey from file and create Survey object — load_survey","text":"function reads survey files multiple formats creates Survey object necessary metadata subsequent analysis. Supports various survey types specific configurations one.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load survey from file and create Survey object — load_survey","text":"","code":"load_survey(   path = NULL,   svy_type = NULL,   svy_edition = NULL,   svy_weight = NULL,   svy_psu = NULL,   svy_strata = NULL,   ...,   bake = FALSE,   recipes = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load survey from file and create Survey object — load_survey","text":"path Path survey file. Supports multiple formats: csv, xlsx, dta (Stata), sav (SPSS), rds (R). NULL, survey arguments must specified create empty object svy_type Survey type string. Supported types: \"ech\": Encuesta Continua de Hogares (Uruguay) \"eph\": Encuesta Permanente de Hogares (Argentina) \"eai\": Encuesta de Actividades de Innovación (Uruguay) \"eaii\": Encuesta de Actividades de Innovación e +D (Uruguay) svy_edition Survey edition string. Supports different temporal patterns: \"YYYY\": Year (e.g., \"2023\") \"YYYYMM\" \"MMYYYY\": Year-month (e.g., \"202301\" \"012023\") \"YYYY-YYYY\": Year range (e.g., \"2020-2022\") svy_weight List weight information specifying periodicity weight variable name. Use helper function add_weight svy_psu Primary sampling unit (PSU) variable string svy_strata Stratification variable name string (optional). Used survey::svydesign() stratified sampling designs. ... Additional arguments passed specific reading functions bake Logical indicating whether recipes processed automatically loading data. Defaults FALSE recipes Recipe object obtained get_recipe. bake=TRUE, recipes applied automatically","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load survey from file and create Survey object — load_survey","text":"Survey object structure: data: Survey data metadata: Information type, edition, weights steps: History applied transformations recipes: Available recipes design: Sample design information","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load survey from file and create Survey object — load_survey","text":"function automatically detects file format uses appropriate reader. survey type, applies specific configurations standard variables, data types, validations. bake=TRUE specified, recipes applied immediately loading data, creating analysis-ready object. path provided, empty Survey object created can used build step pipelines without initial data.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load survey from file and create Survey object — load_survey","text":"","code":"if (FALSE) { # \\dontrun{ # Load ECH 2023 with recipes ech_2023 <- load_survey(   path = \"data/ech_2023.csv\",   svy_type = \"ech\",   svy_edition = \"2023\",   svy_weight = add_weight(annual = \"pesoano\"),   recipes = get_recipe(\"ech\", \"2023\"),   bake = TRUE )  # Load monthly survey ech_january <- load_survey(   path = \"data/ech_202301.dta\",   svy_type = \"ech\",   svy_edition = \"202301\",   svy_weight = add_weight(monthly = \"pesomes\") )  # Create empty object for pipeline pipeline <- load_survey(   svy_type = \"ech\",   svy_edition = \"2023\" ) %>%   step_compute(new_var = operation)  # With included example data ech_example <- load_survey(   path = load_survey_example(\"ech\", \"ech_2022\"),   svy_type = \"ech\",   svy_edition = \"2022\",   svy_weight = add_weight(annual = \"pesoano\") ) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey_example.html","id":null,"dir":"Reference","previous_headings":"","what":"Load survey example data — load_survey_example","title":"Load survey example data — load_survey_example","text":"Downloads loads example survey data metasurvey data repository. function provides access sample datasets testing demonstration purposes, including ECH (Continuous Household Survey) survey types.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey_example.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load survey example data — load_survey_example","text":"","code":"load_survey_example(svy_type, svy_edition)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey_example.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load survey example data — load_survey_example","text":"svy_type Character string specifying survey type (e.g., \"ech\") svy_edition Character string specifying survey edition/year (e.g., \"2023\")","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey_example.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load survey example data — load_survey_example","text":"Character string path downloaded CSV file containing example survey data","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey_example.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load survey example data — load_survey_example","text":"function downloads example data official metasurvey data repository GitHub. data cached locally temporary file avoid repeated downloads session. Available survey types editions can found : https://github.com/metasurveyr/metasurvey_data","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/load_survey_example.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load survey example data — load_survey_example","text":"","code":"if (FALSE) { # \\dontrun{ # Load ECH 2023 example data ech_path <- load_survey_example(\"ech\", \"2023\")  # Use with load_survey ech_data <- load_survey(   path = load_survey_example(\"ech\", \"2023\"),   svy_type = \"ech\",   svy_edition = \"2023\" ) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/metasurvey-package.html","id":null,"dir":"Reference","previous_headings":"","what":"metasurvey: Survey Processing with Meta-Programming — metasurvey-package","title":"metasurvey: Survey Processing with Meta-Programming — metasurvey-package","text":"metasurvey package provides comprehensive framework processing complex survey data using meta-programming techniques. integrates seamlessly survey package adding powerful features reproducible survey analysis workflows.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/metasurvey-package.html","id":"key-features","dir":"Reference","previous_headings":"","what":"Key Features","title":"metasurvey: Survey Processing with Meta-Programming — metasurvey-package","text":"Survey Objects Classes: Survey: Basic survey object cross-sectional data RotativePanelSurvey: Panel survey implantation follow-PoolSurvey: Pool multiple surveys time series analysis Steps Workflows: step_compute: Create computed variables step_recode: Recode variables multiple conditions workflow: Execute estimation workflows variance adjustment Recipes Reproducibility: recipe: Create reusable recipe objects bake_recipes: Apply recipes survey data get_recipe: Retrieve recipes repository Data Loading Weights: load_survey: Load single survey data load_panel_survey: Load panel survey data add_weight: Add survey weights add_replicate: Add bootstrap/jackknife replicates Quality Assessment: evaluate_cv: Evaluate coefficient variation quality Built-variance estimation multiple engines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/metasurvey-package.html","id":"supported-survey-types","dir":"Reference","previous_headings":"","what":"Supported Survey Types","title":"metasurvey: Survey Processing with Meta-Programming — metasurvey-package","text":"package includes built-support several survey types: ECH: Encuesta Continua de Hogares (Uruguay) EAII: Encuesta de Actividad, Innovación e +D EAI: Encuesta de Actividades de Innovación Generic survey types flexible configuration","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/metasurvey-package.html","id":"workflow-example","dir":"Reference","previous_headings":"","what":"Workflow Example","title":"metasurvey: Survey Processing with Meta-Programming — metasurvey-package","text":"","code":"library(metasurvey) # Note: examples use base R pipe (|>) to avoid extra dependencies  # Load survey data survey_data <- load_survey(   data_path = \"path/to/data.csv\",   svy_edition = \"2023\",   svy_type = \"ech\",   svy_weight = add_weight(annual = \"weight_var\") )  # Add processing steps processed_survey <- survey_data |>   step_recode(\"employed\", status == 1 ~ 1, .default = 0) |>   step_compute(unemployment_rate = unemployed / labor_force)  # Apply steps and run workflow final_survey <- bake_steps(processed_survey)  results <- workflow(   survey = list(final_survey),   survey::svytotal(~employed),   survey::svymean(~unemployment_rate),   estimation_type = \"annual\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/metasurvey-package.html","id":"meta-programming-features","dir":"Reference","previous_headings":"","what":"Meta-Programming Features","title":"metasurvey: Survey Processing with Meta-Programming — metasurvey-package","text":"package leverages R's meta-programming capabilities : Generate survey code dynamically based metadata Create reusable workflows adapt different survey structures Validate harmonize variable definitions across time periods Automatically handle complex variance estimation procedures","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/metasurvey-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"metasurvey: Survey Processing with Meta-Programming — metasurvey-package","text":"Lumley, T. (2020). \"survey: analysis complex survey samples\". R package version 4.0.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/metasurvey-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"metasurvey: Survey Processing with Meta-Programming — metasurvey-package","text":"Mauro Loprete mauro.loprete@icloud.com, Natalia da Silva natalia.dasilva@fcea.edu.uy, Fabricio Machado fabricio.mch.slv@gmail.com","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_destring_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a STATA destring command — parse_destring_args","title":"Parse a STATA destring command — parse_destring_args","text":"Parse STATA destring command","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_destring_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a STATA destring command — parse_destring_args","text":"","code":"parse_destring_args(args, options = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_destring_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a STATA destring command — parse_destring_args","text":"args Arguments string \"destring\" options Options string","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_destring_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a STATA destring command — parse_destring_args","text":"List var_name, replace (logical), force (logical), gen_var","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_do_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a STATA .do file into structured commands — parse_do_file","title":"Parse a STATA .do file into structured commands — parse_do_file","text":"Reads .file returns list parsed command objects. Handles comment stripping, line continuation, loop expansion, command tokenization.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_do_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a STATA .do file into structured commands — parse_do_file","text":"","code":"parse_do_file(do_file, encoding = \"latin1\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_do_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a STATA .do file into structured commands — parse_do_file","text":"do_file Path STATA .file encoding File encoding (default \"latin1\" legacy STATA files)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_do_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a STATA .do file into structured commands — parse_do_file","text":"list StataCommand lists, fields: cmd, args, if_clause, options, raw_line, line_num, capture","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_do_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parse a STATA .do file into structured commands — parse_do_file","text":"","code":"# \\donttest{ tf <- tempfile(fileext = \".do\") writeLines(c(\"gen age2 = edad^2\", \"replace sexo = 1 if sexo == .\"), tf) cmds <- parse_do_file(tf) length(cmds) #> [1] 2 cmds[[1]]$cmd #> [1] \"gen\" # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_egen_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a STATA egen command — parse_egen_args","title":"Parse a STATA egen command — parse_egen_args","text":"Parse STATA egen command","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_egen_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a STATA egen command — parse_egen_args","text":"","code":"parse_egen_args(args, by_group = NULL, options = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_egen_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a STATA egen command — parse_egen_args","text":"args Arguments string \"egen\" by_group -group bysort prefix () option options Options string","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_egen_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a STATA egen command — parse_egen_args","text":"List var_name, func, func_arg, by_group","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_gen_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a STATA gen command into variable name and expression — parse_gen_args","title":"Parse a STATA gen command into variable name and expression — parse_gen_args","text":"Parse STATA gen command variable name expression","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_gen_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a STATA gen command into variable name and expression — parse_gen_args","text":"","code":"parse_gen_args(args)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_gen_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a STATA gen command into variable name and expression — parse_gen_args","text":"args arguments part gen command (\"gen\")","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_gen_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a STATA gen command into variable name and expression — parse_gen_args","text":"List var_name expr","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_mvencode_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a STATA mvencode command — parse_mvencode_args","title":"Parse a STATA mvencode command — parse_mvencode_args","text":"Parse STATA mvencode command","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_mvencode_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a STATA mvencode command — parse_mvencode_args","text":"","code":"parse_mvencode_args(args, options = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_mvencode_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a STATA mvencode command — parse_mvencode_args","text":"args Arguments string \"mvencode\" options Options string","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_mvencode_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a STATA mvencode command — parse_mvencode_args","text":"List var_names mv_value","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_recode_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a STATA recode command — parse_recode_args","title":"Parse a STATA recode command — parse_recode_args","text":"Handles patterns like: recode var (old=new) (old=new) recode var (old=new), gen(newvar) recode var .=0 recode var 23/38=22","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_recode_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a STATA recode command — parse_recode_args","text":"","code":"parse_recode_args(args, options = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_recode_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a STATA recode command — parse_recode_args","text":"args Arguments string \"recode\" options Options string (may contain gen())","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_recode_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a STATA recode command — parse_recode_args","text":"List var_name, gen_var (NULL), mappings list","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_replace_args.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a STATA replace command into variable name and expression — parse_replace_args","title":"Parse a STATA replace command into variable name and expression — parse_replace_args","text":"Parse STATA replace command variable name expression","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_replace_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a STATA replace command into variable name and expression — parse_replace_args","text":"","code":"parse_replace_args(args)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_replace_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a STATA replace command into variable name and expression — parse_replace_args","text":"args arguments part replace command","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_replace_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a STATA replace command into variable name and expression — parse_replace_args","text":"List var_name expr","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_command.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse a single STATA command line into structured data — parse_stata_command","title":"Parse a single STATA command line into structured data — parse_stata_command","text":"Parse single STATA command line structured data","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_command.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse a single STATA command line into structured data — parse_stata_command","text":"","code":"parse_stata_command(line, line_num = NA_integer_)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_command.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse a single STATA command line into structured data — parse_stata_command","text":"line single STATA command string line_num Original line number (error reporting)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_command.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse a single STATA command line into structured data — parse_stata_command","text":"list cmd, args, if_clause, options, raw_line, line_num, capture, NULL empty/skippable lines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_labels.html","id":null,"dir":"Reference","previous_headings":"","what":"Parse STATA label commands from source lines — parse_stata_labels","title":"Parse STATA label commands from source lines — parse_stata_labels","text":"Extracts variable labels, value label definitions, value label assignments label commands.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_labels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parse STATA label commands from source lines — parse_stata_labels","text":"","code":"parse_stata_labels(lines)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_labels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parse STATA label commands from source lines — parse_stata_labels","text":"lines Character vector source lines (already comment-stripped)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_labels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parse STATA label commands from source lines — parse_stata_labels","text":"list var_labels (named list) val_labels (named list named lists)","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/parse_stata_labels.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parse STATA label commands from source lines — parse_stata_labels","text":"","code":"# \\donttest{ lines <- c(   'label variable edad \"Age in years\"',   'label define sexo_lbl 1 \"Male\" 2 \"Female\"',   \"label values sexo sexo_lbl\" ) labels <- parse_stata_labels(lines) labels$var_labels #> $edad #> [1] \"Age in years\" #>  labels$val_labels #> $sexo #> $sexo$`1` #> [1] \"Male\" #>  #> $sexo$`2` #> [1] \"Female\" #>  #>  # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.Recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for Recipe objects — print.Recipe","title":"Print method for Recipe objects — print.Recipe","text":"Displays formatted recipe card showing metadata, required variables, pipeline steps, produced variables.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.Recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for Recipe objects — print.Recipe","text":"","code":"# S3 method for class 'Recipe' print(x, ...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.Recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for Recipe objects — print.Recipe","text":"x Recipe object ... Additional arguments (currently unused)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.Recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for Recipe objects — print.Recipe","text":"Invisibly returns Recipe object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.Recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print method for Recipe objects — print.Recipe","text":"","code":"rec <- Recipe$new(   id = \"r1\", name = \"Example\", user = \"tester\",   edition = \"2023\", survey_type = \"test\",   default_engine = \"data.table\", depends_on = list(),   description = \"Demo recipe\", steps = list() ) print(rec) #>  #> ── Recipe: Example ── #> Author:  tester #> Survey:  test / 2023 #> Version: 1.0.0 #> Description: Demo recipe #> Certification: community #>"},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.RecipeWorkflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for RecipeWorkflow objects — print.RecipeWorkflow","title":"Print method for RecipeWorkflow objects — print.RecipeWorkflow","text":"Print method RecipeWorkflow objects","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.RecipeWorkflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for RecipeWorkflow objects — print.RecipeWorkflow","text":"","code":"# S3 method for class 'RecipeWorkflow' print(x, ...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.RecipeWorkflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for RecipeWorkflow objects — print.RecipeWorkflow","text":"x RecipeWorkflow object ... Additional arguments (unused)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.RecipeWorkflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for RecipeWorkflow objects — print.RecipeWorkflow","text":"Invisibly returns object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.RecipeWorkflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print method for RecipeWorkflow objects — print.RecipeWorkflow","text":"","code":"wf <- RecipeWorkflow$new(   id = \"w1\", name = \"Example Workflow\", user = \"tester\",   edition = \"2023\", survey_type = \"test\",   recipe_ids = \"r1\",   calls = list(), description = \"Demo\" ) print(wf) #>  #> ── Workflow: Example Workflow ── #> Author:  tester #> Survey:  test / 2023 #> Version: 1.0.0 #> Description: Demo #> Certification: community #>  #> ── Uses Recipes (1) ── #>   r1 #>"},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.metasurvey_provenance.html","id":null,"dir":"Reference","previous_headings":"","what":"Print provenance information — print.metasurvey_provenance","title":"Print provenance information — print.metasurvey_provenance","text":"Print provenance information","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.metasurvey_provenance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print provenance information — print.metasurvey_provenance","text":"","code":"# S3 method for class 'metasurvey_provenance' print(x, ...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.metasurvey_provenance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print provenance information — print.metasurvey_provenance","text":"x metasurvey_provenance list. ... Additional arguments (unused).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.metasurvey_provenance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print provenance information — print.metasurvey_provenance","text":"Invisibly returns x.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.metasurvey_provenance_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Print provenance diff — print.metasurvey_provenance_diff","title":"Print provenance diff — print.metasurvey_provenance_diff","text":"Print provenance diff","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.metasurvey_provenance_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print provenance diff — print.metasurvey_provenance_diff","text":"","code":"# S3 method for class 'metasurvey_provenance_diff' print(x, ...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.metasurvey_provenance_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print provenance diff — print.metasurvey_provenance_diff","text":"x metasurvey_provenance_diff list. ... Additional arguments (unused).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/print.metasurvey_provenance_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print provenance diff — print.metasurvey_provenance_diff","text":"Invisibly returns x.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance.html","id":null,"dir":"Reference","previous_headings":"","what":"Get provenance from a survey or workflow result — provenance","title":"Get provenance from a survey or workflow result — provenance","text":"Returns provenance metadata recording full data lineage: source file, step history row counts, environment info.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get provenance from a survey or workflow result — provenance","text":"","code":"provenance(x, ...)  # S3 method for class 'Survey' provenance(x, ...)  # S3 method for class 'data.table' provenance(x, ...)  # Default S3 method provenance(x, ...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get provenance from a survey or workflow result — provenance","text":"x Survey object data.table workflow(). ... Additional arguments (unused).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get provenance from a survey or workflow result — provenance","text":"metasurvey_provenance list, NULL provenance available.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get provenance from a survey or workflow result — provenance","text":"","code":"svy <- Survey$new(   data = data.table::data.table(id = 1:10, age = 20:29, w = 1),   edition = \"2023\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) provenance(svy) #> ── Data Provenance ───────────────────────────────────────────────────────────── #> Loaded: 2026-02-17T15:32:09  #> Initial rows: 10  #>  #> Environment: #>   metasurvey: 0.0.21  #>   R: 4.5.2  #>   survey: 4.4.8"},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_diff.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two provenance objects — provenance_diff","title":"Compare two provenance objects — provenance_diff","text":"Shows differences two provenance records, useful comparing processing across survey editions.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_diff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two provenance objects — provenance_diff","text":"","code":"provenance_diff(prov1, prov2)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_diff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two provenance objects — provenance_diff","text":"prov1 First provenance list. prov2 Second provenance list.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_diff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two provenance objects — provenance_diff","text":"metasurvey_provenance_diff list detected differences.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_diff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare two provenance objects — provenance_diff","text":"","code":"svy1 <- Survey$new(   data = data.table::data.table(id = 1:5, w = rep(1, 5)),   edition = \"2023\", type = \"test\",   engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy2 <- Survey$new(   data = data.table::data.table(id = 1:5, w = rep(2, 5)),   edition = \"2024\", type = \"test\",   engine = \"data.table\", weight = add_weight(annual = \"w\") ) provenance_diff(provenance(svy1), provenance(svy2)) #> ── Provenance Diff ───────────────────────────────────────────────────────────── #> Steps: 0 -> 0"},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_to_json.html","id":null,"dir":"Reference","previous_headings":"","what":"Export provenance to JSON — provenance_to_json","title":"Export provenance to JSON — provenance_to_json","text":"Serializes provenance object JSON format, optionally writing file.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_to_json.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export provenance to JSON — provenance_to_json","text":"","code":"provenance_to_json(prov, path = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_to_json.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export provenance to JSON — provenance_to_json","text":"prov metasurvey_provenance list. path File path write JSON. NULL, returns JSON string.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_to_json.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export provenance to JSON — provenance_to_json","text":"JSON string (invisibly path provided).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/provenance_to_json.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Export provenance to JSON — provenance_to_json","text":"","code":"svy <- Survey$new(   data = data.table::data.table(id = 1:5, w = rep(1, 5)),   edition = \"2023\", type = \"test\",   engine = \"data.table\", weight = add_weight(annual = \"w\") ) prov <- provenance(svy) provenance_to_json(prov) #> { #>   \"source\": { #>     \"path\": null, #>     \"timestamp\": \"2026-02-17T15:32:09\", #>     \"initial_n\": 5, #>     \"hash\": null #>   }, #>   \"steps\": [], #>   \"environment\": { #>     \"metasurvey_version\": \"0.0.21\", #>     \"r_version\": \"4.5.2\", #>     \"survey_version\": \"4.4.8\" #>   } #> }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Publish Recipe — publish_recipe","title":"Publish Recipe — publish_recipe","text":"Publishes Recipe object active backend (local JSON registry remote API).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Publish Recipe — publish_recipe","text":"","code":"publish_recipe(recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Publish Recipe — publish_recipe","text":"recipe Recipe object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Publish Recipe — publish_recipe","text":"Recipe object (invisibly).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Publish Recipe — publish_recipe","text":"","code":"set_backend(\"local\", path = tempfile(fileext = \".json\")) r <- recipe(   name = \"Example\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Example recipe\" ) publish_recipe(r) length(list_recipes()) #> [1] 1"},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Publish a workflow to the active backend — publish_workflow","title":"Publish a workflow to the active backend — publish_workflow","text":"Publishes RecipeWorkflow configured workflow backend.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Publish a workflow to the active backend — publish_workflow","text":"","code":"publish_workflow(wf)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Publish a workflow to the active backend — publish_workflow","text":"wf RecipeWorkflow object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Publish a workflow to the active backend — publish_workflow","text":"NULL (called side effect).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/publish_workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Publish a workflow to the active backend — publish_workflow","text":"","code":"set_workflow_backend(\"local\", path = tempfile(fileext = \".json\")) wf <- RecipeWorkflow$new(   name = \"Example\", description = \"Test\",   survey_type = \"ech\", edition = \"2023\",   recipe_ids = \"r_001\", estimation_type = \"svymean\" ) publish_workflow(wf)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"Rank recipes by downloads — rank_recipes","title":"Rank recipes by downloads — rank_recipes","text":"Get top recipes ranked download count active backend.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rank recipes by downloads — rank_recipes","text":"","code":"rank_recipes(n = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_recipes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rank recipes by downloads — rank_recipes","text":"n Integer. Maximum number recipes return, NULL .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rank recipes by downloads — rank_recipes","text":"List Recipe objects sorted downloads (descending).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rank recipes by downloads — rank_recipes","text":"","code":"set_backend(\"local\", path = tempfile(fileext = \".json\")) top10 <- rank_recipes(n = 10)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_workflows.html","id":null,"dir":"Reference","previous_headings":"","what":"Rank workflows by downloads — rank_workflows","title":"Rank workflows by downloads — rank_workflows","text":"Get top workflows ranked download count.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_workflows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rank workflows by downloads — rank_workflows","text":"","code":"rank_workflows(n = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_workflows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rank workflows by downloads — rank_workflows","text":"n Integer NULL (default NULL). Maximum number return, NULL .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_workflows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rank workflows by downloads — rank_workflows","text":"List RecipeWorkflow objects sorted downloads.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/rank_workflows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rank workflows by downloads — rank_workflows","text":"","code":"set_workflow_backend(\"local\", path = tempfile(fileext = \".json\")) top5 <- rank_workflows(n = 5) length(top5) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Read Recipe — read_recipe","title":"Read Recipe — read_recipe","text":"Reads Recipe object JSON file.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read Recipe — read_recipe","text":"","code":"read_recipe(file)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read Recipe — read_recipe","text":"file character string specifying file path.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read Recipe — read_recipe","text":"Recipe object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_recipe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read Recipe — read_recipe","text":"function reads JSON file decodes Recipe object.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read Recipe — read_recipe","text":"","code":"r <- recipe(   name = \"Example\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Example recipe\" ) f <- tempfile(fileext = \".json\") save_recipe(r, f) #> The recipe has been saved in /tmp/RtmpvnGcvG/file1e259d39dd5.json r2 <- read_recipe(f) #> Warning: Failed to parse recipe steps: invalid length 0 argument. Using raw strings as fallback. r2 #>  #> ── Recipe: Example ── #> Author:  Test #> Survey:  ech / 2023 #> Version: 1.0.0 #> Topic:    #> DOI:      #> Description: Example recipe #> Certification: community #>"},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a RecipeWorkflow from a JSON file — read_workflow","title":"Read a RecipeWorkflow from a JSON file — read_workflow","text":"Read RecipeWorkflow JSON file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a RecipeWorkflow from a JSON file — read_workflow","text":"","code":"read_workflow(file)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a RecipeWorkflow from a JSON file — read_workflow","text":"file Character file path","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a RecipeWorkflow from a JSON file — read_workflow","text":"RecipeWorkflow object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/read_workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read a RecipeWorkflow from a JSON file — read_workflow","text":"","code":"wf <- RecipeWorkflow$new(   name = \"Example\", description = \"Test\",   survey_type = \"ech\", edition = \"2023\",   recipe_ids = \"r_001\", estimation_type = \"svymean\" ) f <- tempfile(fileext = \".json\") save_workflow(wf, f) #> Workflow saved to /tmp/RtmpvnGcvG/file1e253a8354ee.json wf2 <- read_workflow(f)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a survey data transformation recipe — recipe","title":"Create a survey data transformation recipe — recipe","text":"Creates Recipe object encapsulates sequence data transformations can applied surveys reproducible manner. Recipes allow documenting, sharing, reusing data processing workflows.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a survey data transformation recipe — recipe","text":"","code":"recipe(...)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a survey data transformation recipe — recipe","text":"... Required metadata optional steps. Required parameters: name: Descriptive name recipe user: User/author creating recipe svy: Base Survey object (use survey_empty() generic recipes) description: Detailed description recipe's purpose Optional parameters include data transformation steps.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a survey data transformation recipe — recipe","text":"Recipe object containing metadata, transformation steps, dependency information, default engine configuration.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create a survey data transformation recipe — recipe","text":"Recipes essential : Reproducibility: Ensure transformations applied consistently Documentation: Keep record transformations performed Collaboration: Share workflows users teams Versioning: Maintain different processing versions different editions Automation: Apply complex transformations automatically Steps included recipe can combination step_compute, step_recode, transformation steps. Recipes can saved save_recipe(), loaded read_recipe(), applied automatically bake_recipes().","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a survey data transformation recipe — recipe","text":"","code":"# Basic recipe without steps r <- recipe(   name = \"Basic ECH Indicators\",   user = \"Analyst\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Basic labor indicators for ECH 2023\" ) r #>  #> ── Recipe: Basic ECH Indicators ── #> Author:  Analyst #> Survey:  ech / 2023 #> Version: 1.0.0 #> Description: Basic labor indicators for ECH 2023 #> Certification: community #>   # \\donttest{ # Recipe with steps using local data dt <- data.table::data.table(   id = 1:50, age = sample(18:65, 50, TRUE),   income = runif(50, 1000, 5000), w = runif(50, 0.5, 2) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"demo\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) svy <- svy |>   step_compute(income_cat = ifelse(income > 3000, \"high\", \"low\")) |>   step_recode(age_group, age < 30 ~ \"young\", .default = \"adult\") r2 <- recipe(   name = \"Demo\", user = \"test\", svy = svy,   description = \"Demo recipe\", steps = get_steps(svy) ) r2 #>  #> ── Recipe: Demo ── #> Author:  test #> Survey:  demo / 2023 #> Version: 1.0.0 #> Description: Demo recipe #> Certification: community #>  #> ── Requires (2 variables) ── #>   income, age #>  #> ── Pipeline (2 steps) ── #>   1. [compute] -> income_cat  \"Compute step\" #>   2. [recode] -> age_group  \"Recode step\" #>  #> ── Produces (2 variables) ── #>   age_group [categorical], income_cat [numeric] #>  # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_category.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a recipe category — recipe_category","title":"Create a recipe category — recipe_category","text":"Creates RecipeCategory object classifying recipes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_category.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a recipe category — recipe_category","text":"","code":"recipe_category(name, description = \"\", parent = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_category.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a recipe category — recipe_category","text":"name Character. Category identifier (e.g. \"labor_market\"). description Character. Human-readable description. Defaults empty. parent RecipeCategory object character parent category name (default NULL). string provided, creates parent category name.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_category.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a recipe category — recipe_category","text":"RecipeCategory object.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_category.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a recipe category — recipe_category","text":"","code":"cat <- recipe_category(\"labor_market\", \"Labor market indicators\")  # With parent hierarchy sub <- recipe_category(   \"employment\", \"Employment stats\",   parent = \"labor_market\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_certification.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a recipe certification — recipe_certification","title":"Create a recipe certification — recipe_certification","text":"Creates RecipeCertification object. Typically use certify_recipe certify recipe pipeline instead.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_certification.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a recipe certification — recipe_certification","text":"","code":"recipe_certification(level = \"community\", certified_by = NULL, notes = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_certification.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a recipe certification — recipe_certification","text":"level Character. One \"community\" (default), \"reviewed\", \"official\". certified_by RecipeUser NULL (default NULL). Required reviewed/official. notes Character NULL (default NULL). Additional notes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_certification.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a recipe certification — recipe_certification","text":"RecipeCertification object.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_certification.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a recipe certification — recipe_certification","text":"","code":"# Default community certification cert <- recipe_certification()  # Official certification inst <- recipe_user(\"IECON\", type = \"institution\") cert <- recipe_certification(\"official\", certified_by = inst)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_to_json.html","id":null,"dir":"Reference","previous_headings":"","what":"recipe to json — recipe_to_json","title":"recipe to json — recipe_to_json","text":"recipe json","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_to_json.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"recipe to json — recipe_to_json","text":"","code":"recipe_to_json(recipe)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_to_json.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"recipe to json — recipe_to_json","text":"recipe Recipe object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_to_json.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"recipe to json — recipe_to_json","text":"JSON object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_user.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a recipe user — recipe_user","title":"Create a recipe user — recipe_user","text":"Creates RecipeUser object simple functional interface.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_user.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a recipe user — recipe_user","text":"","code":"recipe_user(   name,   type = \"individual\",   email = NULL,   affiliation = NULL,   institution = NULL,   url = NULL,   verified = FALSE )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_user.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a recipe user — recipe_user","text":"name Character. User institution name. type Character. One \"individual\" (default), \"institutional_member\", \"institution\". email Character NULL (default NULL). Email address. affiliation Character NULL (default NULL). Organizational affiliation. institution RecipeUser object character institution name. Required \"institutional_member\" type. string provided, creates institution user name automatically. url Character NULL (default NULL). Institution URL. verified Logical (default FALSE). Whether account verified.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_user.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a recipe user — recipe_user","text":"RecipeUser object.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/recipe_user.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a recipe user — recipe_user","text":"","code":"# Individual user user <- recipe_user(\"Juan Perez\", email = \"juan@example.com\")  # Institution inst <- recipe_user(   \"Instituto de Economia\",   type = \"institution\", verified = TRUE )  # Member linked to institution member <- recipe_user(   \"Maria\",   type = \"institutional_member\",   institution = inst )  # Member with institution name shortcut member2 <- recipe_user(   \"Pedro\",   type = \"institutional_member\",   institution = \"IECON\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/remove_category.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove a category from a recipe — remove_category","title":"Remove a category from a recipe — remove_category","text":"Pipe-friendly function remove category Recipe name.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/remove_category.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove a category from a recipe — remove_category","text":"","code":"remove_category(recipe, name)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/remove_category.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove a category from a recipe — remove_category","text":"recipe Recipe object. name Character. Category name remove.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/remove_category.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove a category from a recipe — remove_category","text":"modified Recipe object.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/remove_category.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove a category from a recipe — remove_category","text":"","code":"r <- recipe(   name = \"Example\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Example recipe\" ) r <- r |>   add_category(\"labor_market\") |>   remove_category(\"labor_market\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/reproduce_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Reproduce a workflow from its published specification — reproduce_workflow","title":"Reproduce a workflow from its published specification — reproduce_workflow","text":"Given RecipeWorkflow (typically fetched registry), downloads data, resolves weight configuration, fetches referenced recipes, returns Survey object ready workflow() estimation.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/reproduce_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reproduce a workflow from its published specification — reproduce_workflow","text":"","code":"reproduce_workflow(wf, data_path = NULL, dest_dir = tempdir())"},{"path":"https://metasurveyr.github.io/metasurvey/reference/reproduce_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reproduce a workflow from its published specification — reproduce_workflow","text":"wf RecipeWorkflow object data_path Character path survey microdata. NULL, attempts download ANDA ECH surveys. dest_dir Character directory downloaded files","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/reproduce_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reproduce a workflow from its published specification — reproduce_workflow","text":"Survey object recipes applied weight configuration set","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/reproduce_workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reproduce a workflow from its published specification — reproduce_workflow","text":"","code":"if (FALSE) { # \\dontrun{ wf <- api_get_workflow(\"w_123\") svy <- reproduce_workflow(wf) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/resolve_weight_spec.html","id":null,"dir":"Reference","previous_headings":"","what":"Resolve a portable weight specification to a usable weight configuration — resolve_weight_spec","title":"Resolve a portable weight specification to a usable weight configuration — resolve_weight_spec","text":"Converts portable weight_spec RecipeWorkflow back format expected load_survey() add_weight(). replicate weights ANDA sources, automatically downloads replicate file.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/resolve_weight_spec.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Resolve a portable weight specification to a usable weight configuration — resolve_weight_spec","text":"","code":"resolve_weight_spec(weight_spec, dest_dir = tempdir())"},{"path":"https://metasurveyr.github.io/metasurvey/reference/resolve_weight_spec.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Resolve a portable weight specification to a usable weight configuration — resolve_weight_spec","text":"weight_spec Named list RecipeWorkflow$weight_spec dest_dir Character directory downloaded files (default: tempdir())","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/resolve_weight_spec.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Resolve a portable weight specification to a usable weight configuration — resolve_weight_spec","text":"Named list compatible add_weight() output","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/resolve_weight_spec.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Resolve a portable weight specification to a usable weight configuration — resolve_weight_spec","text":"","code":"if (FALSE) { # \\dontrun{ wf <- api_get_workflow(\"w_123\") weight <- resolve_weight_spec(wf$weight_spec) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Save Recipe — save_recipe","title":"Save Recipe — save_recipe","text":"Saves Recipe object file JSON format.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save Recipe — save_recipe","text":"","code":"save_recipe(recipe, file)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save Recipe — save_recipe","text":"recipe Recipe object. file character string specifying file path.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save Recipe — save_recipe","text":"NULL.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_recipe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Save Recipe — save_recipe","text":"function encodes Recipe object writes JSON file.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save Recipe — save_recipe","text":"","code":"r <- recipe(   name = \"Example\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Example recipe\" ) f <- tempfile(fileext = \".json\") save_recipe(r, f) #> The recipe has been saved in /tmp/RtmpvnGcvG/file1e25304ac9ac.json"},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Save a RecipeWorkflow to a JSON file — save_workflow","title":"Save a RecipeWorkflow to a JSON file — save_workflow","text":"Save RecipeWorkflow JSON file","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save a RecipeWorkflow to a JSON file — save_workflow","text":"","code":"save_workflow(wf, file)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save a RecipeWorkflow to a JSON file — save_workflow","text":"wf RecipeWorkflow object file Character file path","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save a RecipeWorkflow to a JSON file — save_workflow","text":"NULL (called side-effect)","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/save_workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save a RecipeWorkflow to a JSON file — save_workflow","text":"","code":"wf <- RecipeWorkflow$new(   name = \"Example\", description = \"Test\",   survey_type = \"ech\", edition = \"2023\",   recipe_ids = \"r_001\", estimation_type = \"svymean\" ) f <- tempfile(fileext = \".json\") save_workflow(wf, f) #> Workflow saved to /tmp/RtmpvnGcvG/file1e252e258b9f.json"},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_recipes.html","id":null,"dir":"Reference","previous_headings":"","what":"Search recipes — search_recipes","title":"Search recipes — search_recipes","text":"Search recipes name description active backend.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_recipes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search recipes — search_recipes","text":"","code":"search_recipes(query)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_recipes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Search recipes — search_recipes","text":"query Character search string.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_recipes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search recipes — search_recipes","text":"List matching Recipe objects.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_recipes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Search recipes — search_recipes","text":"","code":"set_backend(\"local\", path = tempfile(fileext = \".json\")) r <- recipe(   name = \"Labor Market\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Labor market indicators\" ) publish_recipe(r) results <- search_recipes(\"labor\") length(results) #> [1] 1"},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_workflows.html","id":null,"dir":"Reference","previous_headings":"","what":"Search workflows — search_workflows","title":"Search workflows — search_workflows","text":"Search workflows name description active workflow backend.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_workflows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search workflows — search_workflows","text":"","code":"search_workflows(query)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_workflows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Search workflows — search_workflows","text":"query Character search string.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_workflows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search workflows — search_workflows","text":"List matching RecipeWorkflow objects.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/search_workflows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Search workflows — search_workflows","text":"","code":"set_workflow_backend(\"local\", path = tempfile(fileext = \".json\")) results <- search_workflows(\"labor market\") length(results) #> [1] 0"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_backend.html","id":null,"dir":"Reference","previous_headings":"","what":"Set recipe backend — set_backend","title":"Set recipe backend — set_backend","text":"Configure active recipe backend via options.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_backend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set recipe backend — set_backend","text":"","code":"set_backend(type, path = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_backend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set recipe backend — set_backend","text":"type Character. \"local\" \"api\" (also accepts \"mongo\" backward compat). path Character. File path local backend.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_backend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set recipe backend — set_backend","text":"Invisibly, RecipeBackend object created.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_backend.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set recipe backend — set_backend","text":"","code":"set_backend(\"local\", path = tempfile(fileext = \".json\"))"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Set data on a Survey — set_data","title":"Set data on a Survey — set_data","text":"Tidy wrapper svy$set_data(data).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set data on a Survey — set_data","text":"","code":"set_data(svy, data, .copy = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set data on a Survey — set_data","text":"svy Survey object data data.frame data.table survey microdata .copy Logical; TRUE, clone Survey modifying (default FALSE)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set data on a Survey — set_data","text":"Survey object (invisibly). .copy=TRUE, returns new clone.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set data on a Survey — set_data","text":"","code":"dt <- data.table::data.table(id = 1:5, x = rnorm(5), w = rep(1, 5)) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"test\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) new_dt <- data.table::data.table(id = 1:3, x = rnorm(3), w = rep(1, 3)) svy <- set_data(svy, new_dt)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_engine.html","id":null,"dir":"Reference","previous_headings":"","what":"Configure the survey data engine — set_engine","title":"Configure the survey data engine — set_engine","text":"Configures engine used loading surveys. Checks provided engine supported, sets default engine none specified, generates message indicating configured engine. engine supported, throws error.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_engine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Configure the survey data engine — set_engine","text":"","code":"set_engine(.engine = show_engines())"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_engine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Configure the survey data engine — set_engine","text":".engine Character vector name engine configure. default, engine returned show_engines() function used.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_engine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Configure the survey data engine — set_engine","text":"Invisibly, previous engine name (restoring).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_engine.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Configure the survey data engine — set_engine","text":"","code":"# \\donttest{ old <- set_engine(\"data.table\") #> Engine: data.table get_engine() #> [1] \"data.table\" # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_lazy_processing.html","id":null,"dir":"Reference","previous_headings":"","what":"Set lazy processing — set_lazy_processing","title":"Set lazy processing — set_lazy_processing","text":"Set lazy processing","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_lazy_processing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set lazy processing — set_lazy_processing","text":"","code":"set_lazy_processing(lazy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_lazy_processing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set lazy processing — set_lazy_processing","text":"lazy Logical. TRUE, steps deferred bake_steps() called.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_lazy_processing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set lazy processing — set_lazy_processing","text":"Invisibly, previous value.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_lazy_processing.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set lazy processing — set_lazy_processing","text":"","code":"old <- lazy_default() set_lazy_processing(FALSE) lazy_default() # now FALSE #> [1] FALSE set_lazy_processing(old) # restore"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_use_copy.html","id":null,"dir":"Reference","previous_headings":"","what":"Set data copy option — set_use_copy","title":"Set data copy option — set_use_copy","text":"Configures whether survey operations create copies data modify existing data place. setting affects memory usage performance across metasurvey package.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_use_copy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set data copy option — set_use_copy","text":"","code":"set_use_copy(use_copy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_use_copy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set data copy option — set_use_copy","text":"use_copy Logical value: TRUE create data copies (safer), FALSE modify data place (efficient)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_use_copy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set data copy option — set_use_copy","text":"Invisibly, previous value (restoring).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_use_copy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set data copy option — set_use_copy","text":"Setting use_copy affects subsequent survey operations: TRUE (default): Operations create data copies, preserving original data FALSE: Operations modify data place, reducing memory usage Use FALSE large datasets memory concern, ensure need original data operations.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_use_copy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set data copy option — set_use_copy","text":"","code":"# Set to use copies (default behavior) set_use_copy(TRUE) use_copy_default() #> [1] TRUE  # Set to modify in place for better performance set_use_copy(FALSE) use_copy_default() #> [1] FALSE  # Reset to default set_use_copy(TRUE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_user_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Set user info on a recipe — set_user_info","title":"Set user info on a recipe — set_user_info","text":"Pipe-friendly function assign RecipeUser Recipe.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_user_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set user info on a recipe — set_user_info","text":"","code":"set_user_info(recipe, user)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_user_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set user info on a recipe — set_user_info","text":"recipe Recipe object. user RecipeUser object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_user_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set user info on a recipe — set_user_info","text":"modified Recipe object.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_user_info.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set user info on a recipe — set_user_info","text":"","code":"r <- recipe(   name = \"Example\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Example recipe\" ) user <- recipe_user(\"Juan Perez\", email = \"juan@example.com\") r <- r |> set_user_info(user)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Set version on a recipe — set_version","title":"Set version on a recipe — set_version","text":"Pipe-friendly function set version string Recipe.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set version on a recipe — set_version","text":"","code":"set_version(recipe, version)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set version on a recipe — set_version","text":"recipe Recipe object. version Character version string (e.g. \"2.0.0\").","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set version on a recipe — set_version","text":"modified Recipe object.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set version on a recipe — set_version","text":"","code":"r <- recipe(   name = \"Example\", user = \"Test\",   svy = survey_empty(type = \"ech\", edition = \"2023\"),   description = \"Example recipe\" ) r <- r |> set_version(\"2.0.0\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_workflow_backend.html","id":null,"dir":"Reference","previous_headings":"","what":"Set workflow backend — set_workflow_backend","title":"Set workflow backend — set_workflow_backend","text":"Configure active workflow backend via options.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_workflow_backend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set workflow backend — set_workflow_backend","text":"","code":"set_workflow_backend(type, path = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_workflow_backend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set workflow backend — set_workflow_backend","text":"type Character. \"local\" \"api\" (also accepts \"mongo\" backward compat). path Character. File path local backend.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_workflow_backend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set workflow backend — set_workflow_backend","text":"Invisibly, WorkflowBackend object created.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/set_workflow_backend.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set workflow backend — set_workflow_backend","text":"","code":"set_workflow_backend(\"local\", path = tempfile(fileext = \".json\"))"},{"path":"https://metasurveyr.github.io/metasurvey/reference/show_engines.html","id":null,"dir":"Reference","previous_headings":"","what":"List available survey data engines — show_engines","title":"List available survey data engines — show_engines","text":"Returns character vector available engines can used loading surveys.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/show_engines.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List available survey data engines — show_engines","text":"","code":"show_engines()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/show_engines.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List available survey data engines — show_engines","text":"Character vector names available engines.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/show_engines.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List available survey data engines — show_engines","text":"","code":"show_engines() #> [1] \"data.table\" \"tidyverse\"  \"dplyr\""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_compute.html","id":null,"dir":"Reference","previous_headings":"","what":"Create computation steps for survey variables — step_compute","title":"Create computation steps for survey variables — step_compute","text":"function uses optimized expression evaluation automatic dependency detection error prevention. computations validated execution.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_compute.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create computation steps for survey variables — step_compute","text":"","code":"step_compute(   svy = NULL,   ...,   .by = NULL,   .copy = use_copy_default(),   comment = \"Compute step\",   .level = \"auto\",   use_copy = deprecated() )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_compute.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create computation steps for survey variables — step_compute","text":"svy Survey RotativePanelSurvey object. NULL, creates step can applied later using pipe operator (%>%) ... Computation expressions automatic optimization. Names assigned using new_var = expression .Vector variables group computations . system automatically validates variables exist execution .copy Logical indicating whether create copy object applying transformations. Defaults use_copy_default() comment Descriptive text step documentation traceability. Compatible Markdown syntax. Defaults \"Compute step\" .level RotativePanelSurvey objects (default \"auto\"), specifies level computations applied: \"implantation\", \"follow_up\", \"quarter\", \"month\", \"auto\" use_copy Use .copy instead.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_compute.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create computation steps for survey variables — step_compute","text":"type input object (Survey RotativePanelSurvey) new computed variables step added history","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_compute.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create computation steps for survey variables — step_compute","text":"Lazy evaluation (default): default, steps recorded executed bake_steps() called. allows building full pipeline materializing changes. Set options(metasurvey.lazy_processing = FALSE) apply steps immediately. Expression processing: Expressions evaluated using data.table's := operator. Variable dependencies detected automatically via .vars(). Missing variables caught execution. Grouped computations: Use .compute aggregated values (e.g., group means) automatically joined back data. RotativePanelSurvey objects, .level controls computations applied: \"auto\" (default): applies implantation follow-ups \"implantation\": household/dwelling level \"follow_up\": individual/person level ","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_compute.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create computation steps for survey variables — step_compute","text":"","code":"# Basic computation dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60), w = 1 ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"test\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy <- svy |> step_compute(age_squared = age^2, comment = \"Age squared\") svy <- bake_steps(svy) get_data(svy) #>       id   age     w age_squared #>    <int> <num> <num>       <num> #> 1:     1    25     1         625 #> 2:     2    30     1         900 #> 3:     3    45     1        2025 #> 4:     4    50     1        2500 #> 5:     5    60     1        3600  # \\donttest{ # ECH example: labor indicator # ech <- ech |> #   step_compute( #     unemployed = ifelse(POBPCOAC %in% 3:5, 1, 0), #     comment = \"Unemployment indicator\") # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter rows from survey data — step_filter","title":"Filter rows from survey data — step_filter","text":"Creates step filters (subsets) rows survey data based logical conditions. Multiple conditions combined .","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter rows from survey data — step_filter","text":"","code":"step_filter(   svy,   ...,   .by = NULL,   .copy = use_copy_default(),   comment = \"Filter step\",   .level = \"auto\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter rows from survey data — step_filter","text":"svy Survey RotativePanelSurvey object. ... Logical expressions evaluated data. must return logical vector. Multiple conditions combined . .Optional grouping variable(s) within-group filtering. .copy Whether operate copy (default: use_copy_default()). comment Descriptive text step (default \"Filter step\"). .level RotativePanelSurvey, level apply (default \"auto\"): \"implantation\", \"follow_up\", \"auto\" ().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_filter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter rows from survey data — step_filter","text":"survey object rows filtered step recorded.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_filter.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter rows from survey data — step_filter","text":"Lazy evaluation (default): Like steps, filter recorded executed bake_steps() called.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_filter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter rows from survey data — step_filter","text":"","code":"svy <- Survey$new(   data = data.table::data.table(     id = 1:10, age = c(15, 25, 35, 45, 55, 65, 75, 20, 30, 40), w = 1   ),   edition = \"2023\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy <- svy |> step_filter(age >= 18) |> bake_steps() nrow(get_data(svy)) #> [1] 9"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_join.html","id":null,"dir":"Reference","previous_headings":"","what":"Join external data into survey (step) — step_join","title":"Join external data into survey (step) — step_join","text":"Creates step joins additional data Survey RotativePanelSurvey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_join.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Join external data into survey (step) — step_join","text":"","code":"step_join(   svy,   x,   by = NULL,   type = c(\"left\", \"inner\", \"right\", \"full\"),   suffixes = c(\"\", \".y\"),   .copy = use_copy_default(),   comment = \"Join step\",   use_copy = deprecated(),   lazy = lazy_default(),   record = TRUE )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_join.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Join external data into survey (step) — step_join","text":"svy Survey RotativePanelSurvey object. NULL, returns step call x data.frame/data.table Survey join svy Character vector join keys. Named vector different names svy x (names keys svy, values keys x). NULL, tries infer common column names type Join type: \"left\" (default), \"inner\", \"right\", \"full\" suffixes Length-2 character vector suffixes conflicting columns svy x respectively. Defaults c(\"\", \".y\") .copy Whether operate copy (default: use_copy_default()) comment Optional description step (default \"Join step\"). use_copy Use .copy instead. lazy Internal. Whether delay execution (default lazy_default()). record Internal. Whether record step (default TRUE).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_join.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Join external data into survey (step) — step_join","text":"Modified survey object join recorded step (applied immediately baked). RotativePanelSurvey, join applied implantation every follow_up survey.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_join.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Join external data into survey (step) — step_join","text":"Lazy evaluation (default): default, steps recorded executed bake_steps() called. Supports left, inner, right, full joins. Allows named mapping (e.g., c(\"id\" = \"code\")) simple character vector. Conflicting column names resolved appending suffixes right-hand side columns.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_join.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Join external data into survey (step) — step_join","text":"","code":"# With data.frame s <- Survey$new(   data = data.table::data.table(id = 1:3, w = 1, a = c(\"x\", \"y\", \"z\")),   edition = \"2023\", type = \"ech\", psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) info <- data.frame(id = c(1, 2), b = c(10, 20)) s2 <- step_join(s, info, by = \"id\", type = \"left\") s2 <- bake_steps(s2)  # With another Survey s_right <- Survey$new(   data = data.table::data.table(id = c(2, 3), b = c(200, 300), w2 = 1),   edition = \"2023\", type = \"ech\", psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w2\") ) s3 <- step_join(s, s_right, by = c(\"id\" = \"id\"), type = \"inner\") s3 <- bake_steps(s3)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_recode.html","id":null,"dir":"Reference","previous_headings":"","what":"Create recoding steps for categorical variables — step_recode","title":"Create recoding steps for categorical variables — step_recode","text":"function uses optimized expression evaluation recoding conditions. conditional expressions validated optimized efficient execution.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_recode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create recoding steps for categorical variables — step_recode","text":"","code":"step_recode(   svy,   new_var,   ...,   .default = NA_character_,   .name_step = NULL,   ordered = FALSE,   .copy = use_copy_default(),   comment = \"Recode step\",   .to_factor = FALSE,   .level = \"auto\",   use_copy = deprecated() )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_recode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create recoding steps for categorical variables — step_recode","text":"svy Survey RotativePanelSurvey object. NULL, creates step can applied later using pipe operator (%>%) new_var Name new variable create (unquoted) ... Sequence two-sided formulas defining recoding rules. Left-hand side (LHS) conditional expression, right-hand side (RHS) defines replacement value. Format: condition ~ value .default Default value assigned condition met. Defaults NA_character_ .name_step Custom name step history. Now auto-generated variable name. Use comment user-facing documentation instead. ordered Logical indicating whether new variable ordered factor. Defaults FALSE .copy Logical indicating whether create copy object applying transformations. Defaults use_copy_default() comment Descriptive text step documentation traceability. Compatible Markdown syntax. Defaults \"Recode step\" .to_factor Logical indicating whether new variable converted factor. Defaults FALSE .level RotativePanelSurvey objects (default \"auto\"), specifies level recoding applied: \"implantation\", \"follow_up\", \"quarter\", \"month\", \"auto\" use_copy Use .copy instead.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_recode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create recoding steps for categorical variables — step_recode","text":"type input object (Survey RotativePanelSurvey) new recoded variable step added history","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_recode.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create recoding steps for categorical variables — step_recode","text":"Lazy evaluation (default): default, steps recorded executed bake_steps() called. allows building full pipeline materializing changes. Condition evaluation: Conditions two-sided formulas evaluated order. first matching condition determines assigned value. condition matches, .default used. Condition examples: Simple: variable == 1 ~ \"Yes\" Complex: age >= 18 & income > 12000 ~ \"High\" Vectorized: variable %% c(1,2,3) ~ \"Group \" Logical: !.na(education) ~ \"education\"","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_recode.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create recoding steps for categorical variables — step_recode","text":"","code":"# Basic recode: categorize ages dt <- data.table::data.table(   id = 1:6, age = c(10, 25, 45, 60, 70, 80), w = 1 ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"test\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) svy <- svy |>   step_recode(     age_group,     age < 18 ~ \"Under 18\",     age >= 18 & age < 65 ~ \"Working age\",     age >= 65 ~ \"Senior\",     .default = \"Unknown\"   ) svy <- bake_steps(svy) get_data(svy) #>       id   age     w   age_group #>    <int> <num> <num>      <char> #> 1:     1    10     1    Under 18 #> 2:     2    25     1 Working age #> 3:     3    45     1 Working age #> 4:     4    60     1 Working age #> 5:     5    70     1      Senior #> 6:     6    80     1      Senior  # \\donttest{ # ECH example: labor force status # ech <- ech |> #   step_recode(labor_status, #     POBPCOAC == 2 ~ \"Employed\", #     POBPCOAC %in% 3:5 ~ \"Unemployed\", #     .default = \"Missing\") # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_remove.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove variables from survey data (step) — step_remove","title":"Remove variables from survey data (step) — step_remove","text":"Creates step removes one variables survey data baked.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_remove.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove variables from survey data (step) — step_remove","text":"","code":"step_remove(   svy,   ...,   vars = NULL,   .copy = use_copy_default(),   comment = \"Remove variables\",   use_copy = deprecated(),   lazy = lazy_default(),   record = TRUE )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_remove.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove variables from survey data (step) — step_remove","text":"svy Survey RotativePanelSurvey object ... Unquoted variable names remove, character vector vars Character vector variable names remove. Alternative ... programmatic use. .copy Whether operate copy (default: use_copy_default()) comment Descriptive text step documentation traceability (default \"Remove variables\"). use_copy Use .copy instead. lazy Internal. Whether delay execution (default lazy_default()). record Internal. Whether record step (default TRUE).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_remove.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove variables from survey data (step) — step_remove","text":"Survey object specified variables removed (queued removal).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_remove.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Remove variables from survey data (step) — step_remove","text":"Lazy evaluation (default): default, steps recorded executed bake_steps() called. Variables can specified two ways: Unquoted names: step_remove(svy, age, income) Character vector: step_remove(svy, vars = c(\"age\", \"income\")) Variables exist data produce warning (error), allowing pipelines robust missing columns.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_remove.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove variables from survey data (step) — step_remove","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy2 <- step_remove(svy, age) svy2 <- bake_steps(svy2) \"age\" %in% names(get_data(svy2)) # FALSE #> [1] FALSE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_rename.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename variables in survey data (step) — step_rename","title":"Rename variables in survey data (step) — step_rename","text":"Creates step renames variables survey data baked.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_rename.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename variables in survey data (step) — step_rename","text":"","code":"step_rename(   svy,   ...,   mapping = NULL,   .copy = use_copy_default(),   comment = \"Rename variables\",   use_copy = deprecated(),   lazy = lazy_default(),   record = TRUE )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_rename.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename variables in survey data (step) — step_rename","text":"svy Survey RotativePanelSurvey object ... Pairs form new_name = old_name (unquoted). mapping named character vector form c(new_name = \"old_name\"). Alternative ... programmatic use. .copy Whether operate copy (default: use_copy_default()) comment Descriptive text step documentation traceability (default \"Rename variables\"). use_copy Use .copy instead. lazy Internal. Whether delay execution (default lazy_default()). record Internal. Whether record step (default TRUE).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_rename.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename variables in survey data (step) — step_rename","text":"Survey object specified variables renamed (queued renaming).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_rename.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rename variables in survey data (step) — step_rename","text":"Lazy evaluation (default): default, steps recorded executed bake_steps() called. Variables can renamed two ways: Unquoted pairs: step_rename(svy, new_name = old_name) Named character vector: step_rename(svy, mapping = c(new_name = \"old_name\")) Variables exist data cause error, unlike step_remove() issues warning.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_rename.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename variables in survey data (step) — step_rename","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) svy2 <- step_rename(svy, edad = age) svy2 <- bake_steps(svy2) \"edad\" %in% names(get_data(svy2)) # TRUE #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_validate.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate data during the step pipeline — step_validate","title":"Validate data during the step pipeline — step_validate","text":"Creates non-mutating step checks data invariants bake_steps called. check logical expression evaluated row-wise survey data. row fails check, pipeline stops (warns).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_validate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate data during the step pipeline — step_validate","text":"","code":"step_validate(   svy,   ...,   .action = c(\"stop\", \"warn\"),   .min_n = NULL,   .copy = use_copy_default(),   comment = \"Validate step\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_validate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate data during the step pipeline — step_validate","text":"svy Survey RotativePanelSurvey object ... Logical expressions evaluated data. must return logical vector one value per row. Named expressions use name error messages; unnamed expressions use deparsed code. Examples: income > 0, !.na(age), sex %% c(1, 2). .action check fails: \"stop\" (default) raises error, \"warn\" issues warning continues. .min_n Minimum number rows required. Checked row-level expressions. .copy Whether operate copy (default: use_copy_default()) comment Descriptive text step documentation traceability (default \"Validate step\").","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_validate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate data during the step pipeline — step_validate","text":"survey object validate step recorded (data mutation).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_validate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Validate data during the step pipeline — step_validate","text":"Lazy evaluation (default): Like steps, validation checks recorded executed bake_steps called. means step_validate can reference variables created preceding step_compute calls. validate step modify data way. inspects current state data.table raises error warning check fails.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/step_validate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate data during the step pipeline — step_validate","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   income = c(1000, 2000, 3000, 4000, 5000), w = 1 ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"test\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") )  # Validate that all ages are positive and income is not NA svy <- svy |>   step_validate(age > 0, !is.na(income), .min_n = 3) |>   bake_steps()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/steps_to_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a list of steps to a recipe — steps_to_recipe","title":"Convert a list of steps to a recipe — steps_to_recipe","text":"Convert list steps recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/steps_to_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a list of steps to a recipe — steps_to_recipe","text":"","code":"steps_to_recipe(   name,   user,   svy = survey_empty(type = \"eaii\", edition = \"2019-2021\"),   description,   steps,   doi = NULL,   topic = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/steps_to_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a list of steps to a recipe — steps_to_recipe","text":"name character string name recipe user character string user recipe svy Survey object description character string description recipe steps list steps recipe doi character string DOI recipe topic character string topic recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/steps_to_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a list of steps to a recipe — steps_to_recipe","text":"Recipe object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/steps_to_recipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a list of steps to a recipe — steps_to_recipe","text":"","code":"# \\donttest{ dt <- data.table::data.table(   id = 1:20, age = sample(18:65, 20, TRUE),   w = runif(20, 0.5, 2) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"demo\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) svy <- step_compute(svy, age2 = age^2) my_recipe <- steps_to_recipe(   name = \"age_vars\", user = \"analyst\",   svy = svy, description = \"Age-derived variables\",   steps = get_steps(svy) ) my_recipe #>  #> ── Recipe: age_vars ── #> Author:  analyst #> Survey:  demo / 2023 #> Version: 1.0.0 #> Description: Age-derived variables #> Certification: community #>  #> ── Requires (1 variables) ── #>   age #>  #> ── Pipeline (1 steps) ── #>   1. [compute] -> age2  \"Compute step\" #>  #> ── Produces (1 variables) ── #>   age2 [numeric] #>  # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/strip_stata_comments.html","id":null,"dir":"Reference","previous_headings":"","what":"Strip STATA comments from source lines — strip_stata_comments","title":"Strip STATA comments from source lines — strip_stata_comments","text":"Removes single-line comments (// * start) multi-line block comments (/* ... */).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/strip_stata_comments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Strip STATA comments from source lines — strip_stata_comments","text":"","code":"strip_stata_comments(lines)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/strip_stata_comments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Strip STATA comments from source lines — strip_stata_comments","text":"lines Character vector source lines","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/strip_stata_comments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Strip STATA comments from source lines — strip_stata_comments","text":"Character vector comments removed","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_empty.html","id":null,"dir":"Reference","previous_headings":"","what":"survey_empty — survey_empty","title":"survey_empty — survey_empty","text":"Create empty survey","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_empty.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"survey_empty — survey_empty","text":"","code":"survey_empty(   edition = NULL,   type = NULL,   weight = NULL,   engine = NULL,   psu = NULL,   strata = NULL )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_empty.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"survey_empty — survey_empty","text":"edition Edition survey type Type survey weight Weight survey engine Engine survey psu PSU variable formula (optional) strata Stratification variable name (optional)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_empty.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"survey_empty — survey_empty","text":"Survey object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_empty.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"survey_empty — survey_empty","text":"","code":"empty <- survey_empty(edition = \"2023\", type = \"test\") empty_typed <- survey_empty(edition = \"2023\", type = \"ech\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_data_frame.html","id":null,"dir":"Reference","previous_headings":"","what":"survey_to_data_frame — survey_to_data_frame","title":"survey_to_data_frame — survey_to_data_frame","text":"Convert survey data.frame","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_data_frame.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"survey_to_data_frame — survey_to_data_frame","text":"","code":"survey_to_data_frame(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_data_frame.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"survey_to_data_frame — survey_to_data_frame","text":"svy Survey object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_data_frame.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"survey_to_data_frame — survey_to_data_frame","text":"data.frame","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_data_frame.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"survey_to_data_frame — survey_to_data_frame","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) df <- survey_to_data_frame(svy) class(df) # \"data.frame\" #> [1] \"data.frame\""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_datatable.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert survey to data.table — survey_to_datatable","title":"Convert survey to data.table — survey_to_datatable","text":"Extracts survey microdata data.table.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_datatable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert survey to data.table — survey_to_datatable","text":"","code":"survey_to_datatable(svy)  survey_to_data.table(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_datatable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert survey to data.table — survey_to_datatable","text":"svy Survey object.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_datatable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert survey to data.table — survey_to_datatable","text":"data.table.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_datatable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert survey to data.table — survey_to_datatable","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) result <- survey_to_datatable(svy) data.table::is.data.table(result) # TRUE #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_tibble.html","id":null,"dir":"Reference","previous_headings":"","what":"survey_to_tibble — survey_to_tibble","title":"survey_to_tibble — survey_to_tibble","text":"Convert survey tibble","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_tibble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"survey_to_tibble — survey_to_tibble","text":"","code":"survey_to_tibble(svy)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_tibble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"survey_to_tibble — survey_to_tibble","text":"svy Survey object","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_tibble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"survey_to_tibble — survey_to_tibble","text":"tibble (tbl_df) containing survey data.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/survey_to_tibble.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"survey_to_tibble — survey_to_tibble","text":"","code":"dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\", weight = add_weight(annual = \"w\") ) tbl <- survey_to_tibble(svy) class(tbl) #> [1] \"tbl_df\"     \"tbl\"        \"data.frame\""},{"path":"https://metasurveyr.github.io/metasurvey/reference/translate_stata_expr.html","id":null,"dir":"Reference","previous_headings":"","what":"Translate a STATA expression to an R expression string — translate_stata_expr","title":"Translate a STATA expression to an R expression string — translate_stata_expr","text":"Converts STATA-specific syntax (inrange, inlist, missing values, etc.) equivalent R expressions suitable data.table evaluation.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/translate_stata_expr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Translate a STATA expression to an R expression string — translate_stata_expr","text":"","code":"translate_stata_expr(expr)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/translate_stata_expr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Translate a STATA expression to an R expression string — translate_stata_expr","text":"expr STATA expression string","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/translate_stata_expr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Translate a STATA expression to an R expression string — translate_stata_expr","text":"R expression string","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_coverage.html","id":null,"dir":"Reference","previous_headings":"","what":"Analyze transpilation coverage for STATA do-files — transpile_coverage","title":"Analyze transpilation coverage for STATA do-files — transpile_coverage","text":"Reports percentage commands .file (directory files) can automatically transpiled vs require manual review.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_coverage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analyze transpilation coverage for STATA do-files — transpile_coverage","text":"","code":"transpile_coverage(path, recursive = TRUE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_coverage.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analyze transpilation coverage for STATA do-files — transpile_coverage","text":"path Path .file directory .files recursive TRUE path directory, search subdirectories","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_coverage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analyze transpilation coverage for STATA do-files — transpile_coverage","text":"data.frame columns: file, total_commands, translated, skipped, manual_review, coverage_pct","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_coverage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Analyze transpilation coverage for STATA do-files — transpile_coverage","text":"","code":"# \\donttest{ tf <- tempfile(fileext = \".do\") writeLines(c(\"gen x = 1\", \"replace x = 2 if y == 3\", \"drop z\"), tf) transpile_coverage(tf) #>                  file                                path total_commands #> 1 file1e257b01fb47.do /tmp/RtmpvnGcvG/file1e257b01fb47.do              2 #> 2               TOTAL /tmp/RtmpvnGcvG/file1e257b01fb47.do              2 #>   translated skipped manual_review coverage_pct #> 1          2       0             0          100 #> 2          2       0             0          100 # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata.html","id":null,"dir":"Reference","previous_headings":"","what":"Transpile a STATA .do file to metasurvey steps — transpile_stata","title":"Transpile a STATA .do file to metasurvey steps — transpile_stata","text":"Parses STATA .file translates commands metasurvey step call strings suitable use Recipe objects.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transpile a STATA .do file to metasurvey steps — transpile_stata","text":"","code":"transpile_stata(do_file, survey_type = \"ech\", user = \"iecon\", strict = FALSE)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transpile a STATA .do file to metasurvey steps — transpile_stata","text":"do_file Path STATA .file survey_type Survey type (default \"ech\") user Author name recipe strict TRUE, stops untranslatable commands; FALSE, inserts MANUAL_REVIEW comments warnings","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transpile a STATA .do file to metasurvey steps — transpile_stata","text":"list : steps: character vector step call strings labels: list var_labels val_labels (label commands found) warnings: character vector MANUAL_REVIEW items stats: list command counts","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transpile a STATA .do file to metasurvey steps — transpile_stata","text":"","code":"# \\donttest{ tf <- tempfile(fileext = \".do\") writeLines(c(\"gen age2 = edad^2\", \"replace sexo = 1 if sexo == .\"), tf) result <- transpile_stata(tf) result$steps #> [1] \"step_compute(svy, age2 = edad^2, sexo = data.table::fifelse(is.na(sexo), 1, sexo))\" result$stats #> $translated #> [1] 2 #>  #> $skipped #> [1] 0 #>  #> $manual_review #> [1] 0 #>  # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata_module.html","id":null,"dir":"Reference","previous_headings":"","what":"Transpile and group do-files by thematic module — transpile_stata_module","title":"Transpile and group do-files by thematic module — transpile_stata_module","text":"Processes -files year directory groups thematic Recipe objects (demographics, income, etc.).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata_module.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transpile and group do-files by thematic module — transpile_stata_module","text":"","code":"transpile_stata_module(year_dir, year, user = \"iecon\", output_dir = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata_module.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transpile and group do-files by thematic module — transpile_stata_module","text":"year_dir Path year directory (e.g., \"do_files_iecon/2022\") year Year edition (character numeric) user Author name output_dir Directory write JSON recipes (NULL = file output)","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata_module.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transpile and group do-files by thematic module — transpile_stata_module","text":"named list Recipe objects, one per thematic module","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/transpile_stata_module.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transpile and group do-files by thematic module — transpile_stata_module","text":"","code":"if (FALSE) { # \\dontrun{ # Requires a directory of .do files organized by year recipes <- transpile_stata_module(\"do_files_iecon/2022\", year = 2022) names(recipes) } # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/use_copy_default.html","id":null,"dir":"Reference","previous_headings":"","what":"Get data copy option — use_copy_default","title":"Get data copy option — use_copy_default","text":"Retrieves current setting use_copy option, controls whether survey operations create copies data modify place.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/use_copy_default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get data copy option — use_copy_default","text":"","code":"use_copy_default()"},{"path":"https://metasurveyr.github.io/metasurvey/reference/use_copy_default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get data copy option — use_copy_default","text":"Logical value indicating whether use data copies (TRUE) modify data place (FALSE). Default TRUE.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/use_copy_default.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get data copy option — use_copy_default","text":"use_copy option affects memory usage performance: TRUE: Creates copies, safer uses memory FALSE: Modifies place, efficient requires caution","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/use_copy_default.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get data copy option — use_copy_default","text":"","code":"# Check current setting current_setting <- use_copy_default() print(current_setting) #> [1] TRUE"},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_recipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Check valid recipe — validate_recipe","title":"Check valid recipe — validate_recipe","text":"Check valid recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_recipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check valid recipe — validate_recipe","text":"","code":"validate_recipe(svy_type, svy_edition, recipe_svy_edition, recipe_svy_type)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_recipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check valid recipe — validate_recipe","text":"svy_type Type survey svy_edition Edition survey recipe_svy_edition Edition recipe recipe_svy_type Type recipe","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_recipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check valid recipe — validate_recipe","text":"Logical","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_time_pattern.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate time pattern — validate_time_pattern","title":"Validate time pattern — validate_time_pattern","text":"Validate time pattern","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_time_pattern.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate time pattern — validate_time_pattern","text":"","code":"validate_time_pattern(svy_type = NULL, svy_edition = NULL)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_time_pattern.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate time pattern — validate_time_pattern","text":"svy_type Survey type (e.g. \"ech\"). svy_edition Survey edition string (e.g. \"2023\", \"2023-06\").","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_time_pattern.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate time pattern — validate_time_pattern","text":"List components: svy_type, svy_edition (parsed), svy_periodicity.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/validate_time_pattern.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate time pattern — validate_time_pattern","text":"","code":"validate_time_pattern(svy_type = \"ech\", svy_edition = \"2023\") #> $svy_type #> [1] \"ech\" #>  #> $svy_edition #> [1] 2023 #>  #> $svy_periodicity #> [1] \"Annual\" #>  validate_time_pattern(   svy_type = \"ech\", svy_edition = \"2023-06\" ) #> $svy_type #> [1] \"ech\" #>  #> $svy_edition #> [1] \"2023-06-01\" #>  #> $svy_periodicity #> [1] \"Monthly\" #>"},{"path":"https://metasurveyr.github.io/metasurvey/reference/view_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"View graph — view_graph","title":"View graph — view_graph","text":"View graph","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/view_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"View graph — view_graph","text":"","code":"view_graph(svy, init_step = \"Load survey\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/view_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"View graph — view_graph","text":"svy Survey object init_step Initial step label (default: \"Load survey\")","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/view_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"View graph — view_graph","text":"visNetwork interactive graph survey processing steps.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/view_graph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"View graph — view_graph","text":"","code":"# \\donttest{ dt <- data.table::data.table(   id = 1:5, age = c(25, 30, 45, 50, 60),   w = rep(1, 5) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"ech\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) svy <- step_compute(svy, age2 = age * 2) view_graph(svy)  {\"x\":{\"nodes\":{\"id\":[1,2],\"label\":[\"Load survey\",\"step_1 Compute: age2\"],\"title\":[\"<div style='font-family: system-ui, -apple-system, sans-serif; padding: 12px 16px; max-width: 300px;'><div style='font-weight: 800; font-size: 14px; color: #2C3E50; margin-bottom: 8px;'>Survey<\\/div><table style='font-size: 12px; color: #555; border-collapse: collapse;'><tr><td style='font-weight:600; padding: 3px 12px 3px 0; color:#2C3E50;'>Type<\\/td><td style='padding:3px 0;'>ech<\\/td><\\/tr><tr><td style='font-weight:600; padding: 3px 12px 3px 0; color:#2C3E50;'>Edition<\\/td><td style='padding:3px 0;'>2023<\\/td><\\/tr><tr><td style='font-weight:600; padding: 3px 12px 3px 0; color:#2C3E50;'>Weight<\\/td><td style='padding:3px 0;'>Weight annual: w (Simple design)<\\/td><\\/tr><\\/table><\\/div>\",\"<div style='font-family: system-ui, -apple-system, sans-serif; padding: 10px 14px; max-width: 340px;'><div style='font-weight: 700; font-size: 13px; color: #2C3E50; margin-bottom: 6px; border-bottom: 2px solid #eee; padding-bottom: 6px;'>Compute step<\\/div><div style='font-family: SFMono-Regular, Consolas, monospace; font-size: 11px; color: #6c757d; background: #f8f9fa; padding: 8px 10px; border-radius: 6px; line-height: 1.5; white-space: pre-wrap;'>list(age2 = age * 2)<\\/div><\\/div>\"],\"group\":[\"Load survey\",\"compute\"]},\"edges\":{\"from\":[1],\"to\":[2]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\"},\"manipulation\":{\"enabled\":false},\"groups\":{\"Load survey\":{\"shape\":\"icon\",\"icon\":{\"code\":\"f1c0\",\"size\":60,\"color\":\"#2C3E50\"},\"font\":{\"size\":16,\"color\":\"#2C3E50\",\"face\":\"bold\",\"multi\":true},\"shadow\":{\"enabled\":true,\"size\":8,\"x\":2,\"y\":2,\"color\":\"rgba(44,62,80,.15)\"}},\"compute\":{\"shape\":\"icon\",\"icon\":{\"code\":\"f1ec\",\"size\":50,\"color\":\"#3498db\"},\"font\":{\"size\":14,\"color\":\"#2c3e50\",\"face\":\"bold\"},\"shadow\":{\"enabled\":true,\"size\":6,\"x\":2,\"y\":2,\"color\":\"rgba(52,152,219,.2)\"}},\"recode\":{\"shape\":\"icon\",\"icon\":{\"code\":\"f0e8\",\"size\":50,\"color\":\"#9b59b6\"},\"font\":{\"size\":14,\"color\":\"#2c3e50\",\"face\":\"bold\"},\"shadow\":{\"enabled\":true,\"size\":6,\"x\":2,\"y\":2,\"color\":\"rgba(155,89,182,.2)\"}},\"step_join\":{\"shape\":\"icon\",\"icon\":{\"code\":\"f0c1\",\"size\":50,\"color\":\"#1abc9c\"},\"font\":{\"size\":14,\"color\":\"#2c3e50\",\"face\":\"bold\"},\"shadow\":{\"enabled\":true,\"size\":6,\"x\":2,\"y\":2,\"color\":\"rgba(26,188,156,.2)\"}},\"step_remove\":{\"shape\":\"icon\",\"icon\":{\"code\":\"f1f8\",\"size\":50,\"color\":\"#e74c3c\"},\"font\":{\"size\":14,\"color\":\"#2c3e50\",\"face\":\"bold\"},\"shadow\":{\"enabled\":true,\"size\":6,\"x\":2,\"y\":2,\"color\":\"rgba(231,76,60,.2)\"}},\"step_rename\":{\"shape\":\"icon\",\"icon\":{\"code\":\"f044\",\"size\":50,\"color\":\"#e67e22\"},\"font\":{\"size\":14,\"color\":\"#2c3e50\",\"face\":\"bold\"},\"shadow\":{\"enabled\":true,\"size\":6,\"x\":2,\"y\":2,\"color\":\"rgba(230,126,34,.2)\"}},\"validate\":{\"shape\":\"icon\",\"icon\":{\"code\":\"f058\",\"size\":50,\"color\":\"#27ae60\"},\"font\":{\"size\":14,\"color\":\"#2c3e50\",\"face\":\"bold\"},\"shadow\":{\"enabled\":true,\"size\":6,\"x\":2,\"y\":2,\"color\":\"rgba(39,174,96,.2)\"}},\"useDefaultGroups\":true,\"dataframe\":{\"shape\":\"icon\",\"icon\":{\"code\":\"f0ce\",\"size\":50,\"color\":\"#95a5a6\"},\"font\":{\"size\":14,\"color\":\"#2c3e50\"},\"shadow\":{\"enabled\":true,\"size\":6,\"x\":2,\"y\":2,\"color\":\"rgba(149,165,166,.2)\"}}},\"edges\":{\"width\":2,\"arrows\":{\"to\":{\"enabled\":true,\"scaleFactor\":0.7,\"type\":\"arrow\"}},\"color\":{\"color\":\"#bdc3c7\",\"highlight\":\"#3498db\",\"hover\":\"#3498db\"},\"smooth\":{\"enabled\":true,\"type\":\"curvedCW\",\"roundness\":0.1}},\"layout\":{\"hierarchical\":{\"enabled\":true,\"levelSeparation\":220,\"nodeSpacing\":140,\"direction\":\"LR\",\"sortMethod\":\"directed\"}},\"interaction\":{\"keyboard\":true,\"navigationButtons\":true,\"tooltipDelay\":100,\"hover\":true,\"zoomSpeed\":1},\"clickToUse\":false},\"groups\":[\"Load survey\",\"compute\"],\"width\":\"100%\",\"height\":\"600px\",\"idselection\":{\"enabled\":true,\"style\":\"font-family: system-ui, sans-serif; font-size: 13px; padding: 6px 12px; border-radius: 8px; border: 1px solid #dee2e6; background: #fff; color: #2C3E50;\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"#f8f9fa\",\"iconsRedraw\":true,\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"highlight\":{\"enabled\":true,\"hoverNearest\":true,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.15,\"useGroups\":true,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":false,\"main\":{\"text\":\"Step types\",\"style\":\"font-family: system-ui, sans-serif; font-weight: 700; font-size: 14px; color: #2C3E50;\"}}},\"evals\":[],\"jsHooks\":[]}# }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Execute estimation workflow for surveys — workflow","title":"Execute estimation workflow for surveys — workflow","text":"function executes sequence statistical estimations Survey objects, applying functions R survey package appropriate metadata. Automatically handles different survey types periodicities.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Execute estimation workflow for surveys — workflow","text":"","code":"workflow(svy, ..., estimation_type = \"monthly\")"},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Execute estimation workflow for surveys — workflow","text":"svy list Survey objects, PoolSurvey. Even single survey, wrap list(): workflow(svy = list(my_survey), ...). Must contain properly configured sample design. ... Calls survey package functions (svymean, svytotal, svyratio, etc.) executed sequentially estimation_type Type estimation (default \"monthly\") determines weight use. Options: \"monthly\", \"quarterly\", \"annual\", vector multiple types","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Execute estimation workflow for surveys — workflow","text":"data.table results estimations, including columns: stat: Name estimated statistic value: Estimation value se: Standard error cv: Coefficient variation estimation_type: Type estimation used survey_edition: Survey edition columns depending estimation type","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Execute estimation workflow for surveys — workflow","text":"function automatically selects appropriate sample design according specified estimation_type. Survey input list, executes functions specified ... combines results. Supported estimation types: \"monthly\": Monthly estimations \"quarterly\": Quarterly estimations \"annual\": Annual estimations PoolSurvey objects, uses specialized methodology handles pooling multiple surveys.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Execute estimation workflow for surveys — workflow","text":"","code":"# Simple estimation with a test survey dt <- data.table::data.table(   x = rnorm(100), g = sample(c(\"a\", \"b\"), 100, TRUE),   w = rep(1, 100) ) svy <- Survey$new(   data = dt, edition = \"2023\", type = \"test\",   psu = NULL, engine = \"data.table\",   weight = add_weight(annual = \"w\") ) result <- workflow(   svy = list(svy),   survey::svymean(~x, na.rm = TRUE),   estimation_type = \"annual\" ) #> Warning: CV may not be useful for negative statistics  # \\donttest{ # ECH example with domain estimations # result <- workflow( #   survey = list(ech_2023), #   svyby(~unemployed, ~region, svymean, na.rm = TRUE), #   estimation_type = \"annual\") # }"},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_from_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a RecipeWorkflow from a plain list — workflow_from_list","title":"Construct a RecipeWorkflow from a plain list — workflow_from_list","text":"Construct RecipeWorkflow plain list","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_from_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a RecipeWorkflow from a plain list — workflow_from_list","text":"","code":"workflow_from_list(lst)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_from_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a RecipeWorkflow from a plain list — workflow_from_list","text":"lst list (typically JSON) workflow fields","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_from_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a RecipeWorkflow from a plain list — workflow_from_list","text":"RecipeWorkflow object","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_from_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct a RecipeWorkflow from a plain list — workflow_from_list","text":"","code":"lst <- list(   name = \"example\", user = \"test\", survey_type = \"ech\",   edition = \"2023\", estimation_type = \"svymean\" ) wf <- workflow_from_list(lst)"},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Create publication-quality table from workflow results — workflow_table","title":"Create publication-quality table from workflow results — workflow_table","text":"Formats workflow() result gt table confidence intervals, CV quality classification, provenance-based source notes.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create publication-quality table from workflow results — workflow_table","text":"","code":"workflow_table(   result,   ci = 0.95,   digits = 2,   compare_by = NULL,   show_cv = TRUE,   show_se = TRUE,   title = NULL,   subtitle = NULL,   source_note = TRUE,   locale = \"en\",   theme = \"publication\" )"},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create publication-quality table from workflow results — workflow_table","text":"result data.table workflow(). ci Confidence level intervals (default 0.95). Set NULL hide confidence intervals. digits Number decimal places (default 2). compare_by Column name pivot side--side comparison (e.g., \"survey_edition\"). show_cv Logical; show CV column quality classification. show_se Logical; show SE column. title Table title. Auto-generated NULL. subtitle Table subtitle. Auto-generated NULL. source_note Logical; show provenance footer. locale Locale number formatting (\"en\" \"es\"). theme Table theme: \"publication\" (clean) \"minimal\".","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create publication-quality table from workflow results — workflow_table","text":"gt_tbl object. Export via gt::gtsave() .html, .docx, .pdf, .png, .rtx. Falls back knitr::kable() gt installed.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_table.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create publication-quality table from workflow results — workflow_table","text":"CV quality classification follows INE/CEPAL standards: Excellent: CV < 5\\ good: 5-10\\ Good: 10-15\\ Acceptable: 15-25\\ Use caution: 25-35\\ publish: >= 35\\","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/reference/workflow_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create publication-quality table from workflow results — workflow_table","text":"","code":"svy <- Survey$new(   data = data.table::data.table(     x = rnorm(100), g = sample(c(\"a\", \"b\"), 100, TRUE), w = rep(1, 100)   ),   edition = \"2023\", type = \"test\", psu = NULL,   engine = \"data.table\", weight = add_weight(annual = \"w\") ) result <- workflow(   list(svy), survey::svymean(~x, na.rm = TRUE),   estimation_type = \"annual\" ) # \\donttest{ if (requireNamespace(\"gt\", quietly = TRUE)) {   workflow_table(result) }     Survey Estimation Results     Statistic       Estimate       SE       CI Lower       CI Upper       CV (%)       Quality     :svymean: x 0.15 0.094 −0.03 0.33 62.5 Do not publishmetasurvey 0.0.21 | CI: 95% | 2026-02-17     # }"},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-21","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.21","text":"validate_weight() now shows available columns weight found. validate_replicate() now lists missing replicate ID columns error. set_use_copy() set_lazy_processing() reject non-scalar logical input.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"internal-0-0-21","dir":"Changelog","previous_headings":"","what":"Internal","title":"metasurvey 0.0.21","text":"Step functions (step_join, step_remove, step_rename, step_validate, step_filter) now return invisible() per R convention side-effect functions. Added @rdname provenance S3 method documentation. Removed unused stats::median stats::quantile imports. Use fully qualified stats::confint() cat_estimation.svyratio. Added edge case tests: double bake idempotency, filter--compute chain, provenance_diff print output.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"breaking-changes-0-0-20","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"metasurvey 0.0.20","text":"survey_to_data.table() deprecated favor survey_to_datatable() (avoids non-standard dots function names). old function still works deprecation warning.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-20","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.20","text":"metasurvey_msg() internal helper wraps message() behind options(metasurvey.verbose = FALSE) silent operation scripts. HTTP requests (ANDA, API client, Shiny) now send metasurvey/<version> User-Agent header. read_file() now gives actionable install hint required reader package missing (e.g., haven .dta files).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-20","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.20","text":"Added call. = FALSE stop() warning() calls cleaner error tracebacks without internal call stack noise. Fixed & vs && compute() cat_estimation() — single & evaluate sides even first FALSE. get_metadata() now uses cat() instead message(), making output testable expect_output() suppressible capture.output(). Removed .onAttach() startup message (package loads silently).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-20","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.20","text":"Fixed broken URLs flagged CRAN: updated Azure AKS INE Uruguay redirects, removed dead Railway API metasurvey-infra links. Included api-database vignette build (excluded via .Rbuildignore, causing broken cross-vignette file URI references). Reduced vignette tarball 10.6 MB 3.7 MB disabling visNetwork widget rendering (eval = FALSE). Replaced \\dontrun{} examples get_implantation() get_follow_up() runnable examples using test data. Added runnable examples provenance_to_json() provenance_diff(). Added @family transpiler cross-references transpiler functions. Documented default parameter values across step_* tidy API functions. Added print.metasurvey_provenance_diff man page. Removed unused digest Suggests.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-19","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.19","text":"step_filter(): new step type row-level filtering within pipeline. Multiple conditions -combined. Supports .within-group filtering, lazy evaluation, RotativePanelSurvey dispatch. provenance(): lightweight data lineage tracking. Surveys now record source file, load timestamp, initial row count, per-step history (type, N /, duration). Workflow results carry provenance attribute. Includes provenance_to_json() audit trails provenance_diff() cross-edition comparison. workflow_table(): publication-quality formatted tables workflow() results using gt. Features confidence intervals, CV quality classification color coding, compare_by side--side edition comparison, locale-aware formatting (“en”/“es”), provenance-based source notes. Falls back knitr::kable() gt installed.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-19","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.19","text":"Fixed stars comments persisting MongoDB: plumber API star/comment endpoints used (!.null(auth_err)) check authentication, require_auth() always returns non-NULL (user object success, error list failure). endpoints returned JWT payload immediately without ever reaching database write. Fixed 5 affected endpoints (recipe star, recipe comment, workflow star, workflow comment, delete comment) added result$ok checks Shiny modules errors reported instead silently swallowed.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"dependencies-0-0-19","dir":"Changelog","previous_headings":"","what":"Dependencies","title":"metasurvey 0.0.19","text":"Added gt (>= 0.10.0) Suggests.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-18","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.18","text":"step_validate(): declarative data validation step checks invariants without mutating data. Supports row-level logical expressions, named checks, .min_n, .action = \"stop\" \"warn\". Stars comments API: users can rate (1-5) comment recipes workflows. New R functions: api_star_recipe(), api_get_recipe_stars(), api_comment_recipe(), api_get_recipe_comments(), api_delete_comment(), api_get_recipe_dependents(), workflow equivalents. Backlinks: GET /recipes/:id/dependents returns recipes depend given recipe via depends_on_recipes. Shiny app: star rating widget, comment section, dependents panel recipe workflow detail modals.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"performance-0-0-18","dir":"Changelog","previous_headings":"","what":"Performance","title":"metasurvey 0.0.18","text":"optimize_steps() now collapses consecutive independent step_compute() calls single calls dependency analysis, reducing transpiled step counts.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-18","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.18","text":"Fixed DHS vignette chunk failing external URL unreachable.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-17","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.17","text":"Indicators API module: new /indicators REST endpoints publishing estimation results full traceability (indicator -> workflow -> recipe). Feature-gated via METASURVEY_ENABLE_INDICATORS env var. Compute worker service: -demand estimation via POST /indicators/compute. worker loads private microdata, applies recipes, runs workflow(). Deployed separate Docker container, never exposes raw survey data. Self-hosting vignette: deployment guide Docker Compose, including hybrid mode (public recipe registry + private worker microdata).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-17","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.17","text":"Updated self-hosting vignette hybrid deployment architecture diagram.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"dependencies-0-0-16","dir":"Changelog","previous_headings":"","what":"Dependencies","title":"metasurvey 0.0.16","text":"Migrated crayon cli terminal output coloring. crayon::bold(), crayon::silver(), crayon::green(), etc. replaced cli::style_bold(), cli::col_silver(), cli::col_green(), etc. across 8 files. Migrated httr httr2 HTTP requests. API client, ANDA catalog, Shiny helper functions now use pipe-based httr2 API (request() |> req_headers() |> req_perform()). Replaced glue::glue_col() calls (depended crayon color functions) glue::glue() + cli::col_*() wrappers. Removed bit64 jose (already unused since 0.0.14) Dockerfile. Removed casen Suggests (GitHub-package, available CRAN). Removed pak Suggests (longer used vignettes).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-16","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.16","text":"Fixed international-surveys vignette crash PNADcIBGE example data: set options(survey.lonely.psu = \"adjust\") strata single PSUs. Fixed vignette setup chunk attempted install packages build time via pak; replaced requireNamespace() guards. Updated Shiny Dockerfile dependencies match new imports (httr2, cli).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"internal-0-0-16","dir":"Changelog","previous_headings":"","what":"Internal","title":"metasurvey 0.0.16","text":"Excluded 9 Spanish (*-es.Rmd) vignettes CRAN tarball via .Rbuildignore (remain available pkgdown site).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-15","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.15","text":"Added strata parameter Survey$new(), survey_empty(), load_survey(), load_panel_survey() stratified sampling designs. Passed survey::svydesign(strata = ...). New vignette: “International Survey Compatibility” (EN + ES) reproducible examples ECH, EPH, CASEN, PNADc, CPS, ENIGH, DHS.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-15","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.15","text":"Eliminated eval=FALSE vignettes — chunks now use conditional eval markdown code blocks non-runnable examples. Improved man page examples: replaced \\dontrun{} \\donttest{} runnable local-data examples cat_design, bake_recipes, recipe, steps_to_recipe, transpile_stata, parse_do_file, others. Added stratified cluster design section complex-designs vignette. Rewrote README live service links (Shiny explorer, REST API), CRAN status badge, GitHub star call--action.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"internal-0-0-15","dir":"Changelog","previous_headings":"","what":"Internal","title":"metasurvey 0.0.15","text":"Expanded test suite 2810 tests covering strata support, edge cases STATA transpiler, API client, panel surveys, recipe system. Expanded test suite cover strata support survey construction workflow estimation.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"breaking-changes-0-0-14","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"metasurvey 0.0.14","text":"Step$comments field renamed Step$comment. old name still works legacy alias removed future version. workflow() first parameter renamed survey svy consistency. Positional usage unchanged. Survey$set_weight() longer emits message(\"Setting weight\"). step_recode() .name_step parameter deprecated; use comment instead.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-14","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.14","text":"use_copy parameter step functions (step_compute, step_recode, step_join, step_remove, step_rename) deprecated favour .copy, following dplyr’s dot-prefix convention secondary arguments. Added survey state predicates: has_steps(), has_recipes(), is_baked(), has_design(). step_recode(), step_join(), step_remove(), step_rename() longer default svy survey_empty(); survey argument now required. extract_time_pattern() now recognises quarter/trimester editions (\"2023-T3\", \"2023-Q1\"), parsed Quarterly periodicity.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-14","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.14","text":"Fixed validate_time_pattern() crash svy_edition NA. Fixed shallow_clone() re-running validate_time_pattern() already-parsed editions, causing cascading NULL → NA → crash. Fixed get_metadata() crash edition NULL NA. Fixed cat_estimation.svyby() producing wrong output: margins index integer (column name), SE column \"se\" missed grep, cv() data.frame handled. Output now shows group labels stat column (e.g. svyby: x [sexo=1]). Mixed estimation types (svymean + svyby) longer fail rbindlist due mismatched columns. Fixed set_engine() logic bug identical(.engine, show_engines()) compared string vs vector, silently failing. Fixed vague stop(\"Error step\") step_compute() validation — now reports variables failed. Removed dead dots-filtering code step_remove() step_rename().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"dependencies-0-0-14","dir":"Changelog","previous_headings":"","what":"Dependencies","title":"metasurvey 0.0.14","text":"Removed unused bit64 import (CRAN compliance). Replaced jose dependency jsonlite::base64url_dec() JWT decoding — one less hard dependency. design_active active binding now delegates ensure_design(), removing duplicated design-building logic.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-14","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.14","text":"step_* functions now document lazy evaluation behavior @details. Improved step_remove() step_rename() roxygen full @details sections matching step_compute() depth. workflow() @param svy now prominently documents list() requirement. Cleaned Survey class roxygen: removed duplicate Methods sections. Updated vignettes use Step$comment instead Step$comments. Vignettes now use real ECH 2023 sample data instead simulated data. Fixed ECH variable names 2023 edition (e31 → e30).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-12","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.12","text":"Fixed critical memory leak chaining N steps: eliminated svy_before retention chain prevented GC freeing N copies data.table. Fixed bake_step re-recording step_join/step_remove/step_rename bake, caused duplicate steps.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"performance-0-0-12","dir":"Changelog","previous_headings":"","what":"Performance","title":"metasurvey 0.0.12","text":"bake_steps() uses shallow_clone() instead clone(deep=TRUE), avoiding duplication entire step chain every bake. add_step() invalidates design lazily instead rebuilding svydesign every step addition. Removed wasteful copy() calls step_compute step_recode.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"internal-0-0-12","dir":"Changelog","previous_headings":"","what":"Internal","title":"metasurvey 0.0.12","text":"Added 500+ tests: memory behavior (test-memory.R), expanded integration pipelines (test-integration.R), stress tests 100 steps 10k+ rows (test-stress.R, skipped CRAN).","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-11","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.11","text":"Fixed examples across 12 R files strict CRAN compliance: functions requiring API server, external files, interactive sessions now use \\dontrun{} instead \\donttest{}. Fixed RecipeWorkflow examples: corrected recipe_ids parameter name, removed non-existent variables parameter. Fixed add_weight/add_replicate examples: removed double-escaped regex patterns, removed load_survey() calls depend external files. Made set_workflow_backend/get_workflow_backend examples runnable without \\dontrun{} wrapper.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"internal-0-0-11","dir":"Changelog","previous_headings":"","what":"Internal","title":"metasurvey 0.0.11","text":"Fixed GitHub Actions: added main R-CMD-check PR triggers, replaced master main test-coverage pkgdown, removed broken setup-r-test.yml. Fixed deploy workflow: secrets passed via env vars instead inline shell interpolation, Railway CLI installed via npm pinned version.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-10","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.10","text":"Docker deployment pipeline GitHub Actions: builds pushes images GHCR, deploys Railway push main. docker-compose.yml local development (API + Shiny stack).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-10","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.10","text":"api_url() longer falls back hardcoded production URL; returns NULL URL configured via option environment variable.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-10","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.10","text":"Replaced remaining \\dontrun{} \\donttest{} across exported examples CRAN compliance. Added runnable examples RecipeWorkflow, save_workflow, read_workflow, search_workflows, rank_workflows, RecipeBackend. Added STATA transpiler usage section README. Added Spanish vignettes: stata-transpiler-es, ech-demographics-recipe-es.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"internal-0-0-10","dir":"Changelog","previous_headings":"","what":"Internal","title":"metasurvey 0.0.10","text":"Updated API Dockerfile curl-based healthcheck. Updated Shiny Dockerfile: configurable METASURVEY_REF build arg, added jose git dependencies.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"cran-compliance-0-0-9","dir":"Changelog","previous_headings":"","what":"CRAN compliance","title":"metasurvey 0.0.9","text":"Namespaced global options: use_copy → metasurvey.use_copy, lazy_processing → metasurvey.lazy_processing. set_use_copy() set_lazy_processing() return previous value invisibly, matching set_engine() behavior. set_backend() set_workflow_backend() return previous value invisibly. Replaced \\dontrun{} examples runnable \\donttest{} appropriate (set_engine(), view_graph(), survey_empty(), set_workflow_backend(), get_workflow_backend()). Fixed print.RecipeWorkflow example: removed non-existent recipe_name results arguments. Fixed extract_time_pattern() roxygen block: accidentally attached internal validate_monthly(), causing export dropped. Fixed malformed @keywords tags: removed comma-separated values PoolSurvey RotativePanelSurvey, removed duplicate description block Survey parsed keyword entries. Simplified .onAttach() single version message. Removed hardcoded production API URL .onLoad(). Deleted orphan Spanish-vignette metasurvey-es.Rmd. Added .Rbuildignore entries deployment artifacts (inst/scripts, inst/seed-data, Dockerfiles, inst/shiny-auth.R). Deleted empty inst/extdata/ directory. Fixed add_weight() regex example. Fixed load_survey() example. Fixed set_lazy() → set_lazy_processing() vignettes. Enabled eval=TRUE -memory vignette chunks (bake, get-steps). load_survey_example(): removed dead file.exists() branch, wrapped download.file() tryCatch() graceful failure. Added requireNamespace(\"htmltools\") check view_graph(). Removed version constraint parallel Suggests. R CMD check: 0 errors, 0 warnings, 1 note (new submission).","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"translations-0-0-9","dir":"Changelog","previous_headings":"","what":"Translations","title":"metasurvey 0.0.9","text":"remaining Spanish return values translated English: \"Trianual\" → \"Triennial\", \"Multianual\" → \"Multi-year\". Spanish inline comments translated English. Translated roxygen documentation recipe(), extract_surveys(), get_implantation(), get_follow_up().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-9","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.9","text":"Added STATA--metasurvey transpiler: transpile_stata(), transpile_stata_module(), parse_do_file(), parse_stata_labels(), transpile_coverage(). Converts .files Recipe JSON, supporting gen/replace chains, recode, egen, foreach loops, mvencode, destring, labels, . Added labels field Recipe class storing variable value labels STATA transpilation. Added Shiny DAG graph loading spinner disclaimer recipes 20 steps.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-9","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.9","text":"Fixed validate_weight_time_pattern() crash weight NULL (triggered shallow_clone() surveys without weights). Fixed steps_to_recipe() producing unparseable step strings: long step_recode calls split across multiple lines deparse(), breaking JSON round-trip. Fixed bake_recipes() executing step_rename step_remove: recipe step replay now temporarily disables lazy processing steps execute immediately. Fixed Shiny category_tag() crash recipe topic NULL.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-9","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.9","text":"Added @family tags exported functions across 16 groups. Standardized @keywords tags (removed commas, fixed multi-word entries). Removed redundant @title tags R/set_engine.R. Updated cran-comments.md reflect 1 NOTE (new submission). Added stata-transpiler vignette covering supported STATA patterns. Added ech-demographics-recipe vignette showing hand-crafted vs transpiled recipe workflows.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-8","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.8","text":"Fixed 5 occurrences stop(message(...)) silently called stop(NULL) instead raising proper error (set_engine(), load_survey(), recipe()). Fixed .Rbuildignore double-escape bug: patterns \\\\\\\\. instead \\\\., causing hidden files non-standard files leak tarball. Replaced unsafe 1:n sequences seq_len()/seq.int() avoid c(1, 0) n=0 (7 occurrences across survey.R, workflow.R, steps.R). Removed duplicate internal set_data() definition survey.R. Replaced raw ANSI escape codes crayon::red()/crayon::green() cat_design() cross-platform compatibility. Removed unreachable dead code load_survey_example(). requireNamespace(\"parallel\") now uses quietly = TRUE checks return value using package. requireNamespace(\"rio\") return value now checked calling rio::convert().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"security-0-0-8","dir":"Changelog","previous_headings":"","what":"Security","title":"metasurvey 0.0.8","text":"SSL certificate verification ANDA client now enabled default. Previously hardcoded ssl_verifypeer = FALSE; now user-controllable via options(metasurvey.ssl_verify = FALSE). api_logout() longer calls Sys.unsetenv(\"METASURVEY_TOKEN\") — clears R option, per CRAN policy environment variables.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"cran-compliance-0-0-8","dir":"Changelog","previous_headings":"","what":"CRAN compliance","title":"metasurvey 0.0.8","text":"set_engine(), set_use_copy(), set_lazy_processing(), configure_api() now return previous value invisibly, allowing users restore global options. user-facing messages translated Spanish English. evaluate_cv() returns English labels (“Excellent”, “Good”, etc.). extract_time_pattern() returns “Invalid format”/“Unknown format”. DESCRIPTION title description rewritten substantive. inst/CITATION updated: removed deprecated citHeader(), dynamic year. Fixed inconsistent maintainer email across DESCRIPTION package docs. R CMD check now passes 0 errors, 0 warnings, 0 NOTEs.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-7","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.7","text":"Recipe$to_list() RecipeWorkflow$to_list() now include metasurvey_version reproducibility tracking.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-7","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.7","text":"Fixed bake_step() crash executing step_recode(): removed invalid record=FALSE argument passed internal recode(). Fixed bake_steps_survey() iterating original survey’s steps instead cloned copy, causing inconsistent state. Fixed bake_recipes() environment leakage: recipe step evaluation now uses isolated new.env() instead calling environment(). Removed redundant copy() compute() recode() — shallow_clone() already handles data copying. step_join() now uses merge.data.table() directly set_data() instead assigning $data. Fixed Shiny admin panel memory leak: replaced dynamic observe→lapply→observeEvent pattern delegated event handlers. Removed invalidateLater(0) admin panel refresh.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"security-0-0-7","dir":"Changelog","previous_headings":"","what":"Security","title":"metasurvey 0.0.7","text":"store_token() longer calls Sys.setenv() — API tokens stored R options , leaked environment variables. token_expires_soon() returns TRUE NULL, malformed, missing exp claims, forcing token refresh instead using potentially invalid tokens. API error messages sanitized 200 characters maximum. Added validate_api_id() alphanumeric whitelist recipe/workflow IDs. Added password length validation (8–128 characters) api_register(). api_download_recipe() api_download_workflow() now warn failure instead silently swallowing errors.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"performance-0-0-7","dir":"Changelog","previous_headings":"","what":"Performance","title":"metasurvey 0.0.7","text":"Added debounce(300) Shiny recipe search input reduce excessive reactivity.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"internal-0-0-7","dir":"Changelog","previous_headings":"","what":"Internal","title":"metasurvey 0.0.7","text":"Replaced sapply() vapply() lapply() across codebase type-safe return values. set_engine() uses requireNamespace() instead eval(install.packages(...)). read_recipe() now warns step parsing falls back raw strings. Added ORCID identifiers authors DESCRIPTION. Added ANDA fetch failure notification Shiny explore module.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-6","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.6","text":"exported functions R6 classes now @return @examples roxygen2 tags, meeting rOpenSci documentation requirements. Added @return R6 class exports: Recipe, RecipeWorkflow, RecipeCategory, RecipeCertification, RecipeUser, PoolSurvey, RotativePanelSurvey, Survey. Added @examples set_engine(), show_engines(), get_engine(), API/backend functions. Added @return get_metadata(), set_lazy_processing(), set_use_copy(), set_backend(), set_workflow_backend(), explore_recipes().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-6","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.6","text":"Fixed Codecov GitHub Actions workflow: replaced deprecated covr::codecov() covr::package_coverage() + codecov/codecov-action@v5 reliable coverage uploads token authentication. Added CI guard .Rprofile skip example-data setup GitHub Actions, preventing potential download failures CI builds. Added missing archive, haven, openxlsx Suggests DESCRIPTION, fixing R CMD check warnings undeclared dependencies.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"internal-0-0-6","dir":"Changelog","previous_headings":"","what":"Internal","title":"metasurvey 0.0.6","text":"Added .claude/ directory development agents commands code review, testing, documentation auditing, rOpenSci preparation.","code":""},{"path":[]},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"breaking-changes-0-0-5","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"metasurvey 0.0.5","text":"AST engine removed: Abstract Syntax Tree evaluation engine (R/ast.R) replaced direct data.table expression evaluation. simplifies step pipeline removes ~760 lines internal code. Users relied internal AST functions (parse_ast, evaluate_ast_node, recode_with_ast, optimize_node) need update code. public API (step_compute(), step_recode(), bake_steps()) remains unchanged. API client migrated JWT: API client (R/api_client.R) now uses JWT authentication self-hosted Plumber backend, replacing previous Atlas Data API approach.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"new-features-0-0-5","dir":"Changelog","previous_headings":"","what":"New features","title":"metasurvey 0.0.5","text":"Lazy design initialization: Survey$new() longer builds svydesign objects construction time. Designs created -demand needed (e.g., workflow() bake_steps()), significantly improving construction performance large datasets. psu parameter now optional (default NULL). Recipe ecosystem: New infrastructure publishing, discovering, managing reproducible survey processing recipes: RecipeRegistry R6 class pluggable backends (JSON file, MongoDB). RecipeCategory hierarchical categorization recipes. RecipeCertification quality certification levels (official, reviewed, community). RecipeUser author/maintainer profiles institutional affiliations. Tidy API: list_recipes(), search_recipes(), filter_recipes(), rank_recipes(). Recipe$doc() auto-generated documentation. Recipe$validate(svy) dependency checking survey. print.Recipe S3 method human-readable output. save_recipe() / read_recipe() JSON serialization. Workflow system: New estimation workflow infrastructure: RecipeWorkflow R6 class capturing svymean/svytotal/svyratio/svyby calls recipe references reproducibility metadata. WorkflowRegistry pluggable backends (JSON, MongoDB). Auto-capture workflow metadata via .capture_workflow() surveys contain recipes. workflow_from_list() reconstructing workflows JSON/API responses. Tidy API: list_workflows(), search_workflows(), filter_workflows(), rank_workflows(), find_workflows_for_recipe(), publish_workflow(). save_workflow() / read_workflow() serialization. REST API (inst/api/plumber.R): Self-hosted Plumber API JWT authentication recipe workflow publishing. Endpoints CRUD operations recipes, workflows, user management. Includes Docker deployment configuration. ANDA catalog integration (R/anda.R): Functions accessing INE Uruguay’s ANDA5 catalog metadata: anda_catalog_search() searching catalog. anda_list_editions() listing available survey editions. anda_fetch_ddi() fetching DDI metadata. anda_parse_variables() extracting variable definitions. anda_variable_detail() detailed variable information. Shiny explorer app (inst/shiny/): Interactive recipe workflow browser launched via explore_recipes(): Recipe gallery search, filtering survey type/certification, detail modals showing pipeline visualization R code snippets. Workflow gallery estimation timeline cross-references recipes. User authentication registration, login, profile management. Token generation programmatic API access R scripts. bake_recipes() handles string steps: Steps stored strings (JSON/API) now parsed call objects evaluation, fixing previous “attempt apply non-function” error.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"bug-fixes-0-0-5","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"metasurvey 0.0.5","text":"is_blank() now handles NULL zero-length inputs without error. Fixed regex extract_time_pattern(): type prefix detection now correctly matches string start. Multianual year-range patterns (e.g., \"2019_2021\") now correctly parsed separated underscore. validate_time_pattern() gracefully handles NULL/empty edition strings. Improved public_key() error handling informative messages. workflow_from_list() now exported (@keywords internal), fixing Shiny app workflow parsing API responses.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"documentation-0-0-5","dir":"Changelog","previous_headings":"","what":"Documentation","title":"metasurvey 0.0.5","text":"getting-started: Survey creation, steps, recipes, workflows. recipes: Recipe ecosystem, publishing, discovery. workflows--estimation: Estimation workflows registry. complex-designs: Replicate weights, stratified designs. panel-analysis: Rotating panel surveys. ech-case-study: Full ECH processing example. shiny-explorer: Interactive app usage guide. api-database: REST API database architecture. vignettes available Spanish (*-es.Rmd). Added references.bib academic citations. Added pkgdown site configuration rOpenSci template.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"metasurvey-003","dir":"Changelog","previous_headings":"","what":"metasurvey 0.0.3","title":"metasurvey 0.0.3","text":"Added step_join() merging external reference data surveys. Added step_remove() step_rename() variable management.","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"metasurvey-002","dir":"Changelog","previous_headings":"","what":"metasurvey 0.0.2","title":"metasurvey 0.0.2","text":"Added RotativePanelSurvey PoolSurvey R6 classes complex designs. Added extract_surveys(), get_implantation(), get_follow_up().","code":""},{"path":"https://metasurveyr.github.io/metasurvey/news/index.html","id":"metasurvey-001","dir":"Changelog","previous_headings":"","what":"metasurvey 0.0.1","title":"metasurvey 0.0.1","text":"Initial CRAN submission.","code":""}]
