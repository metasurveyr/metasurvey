<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Configure replicate weights for variance estimation — add_replicate • metasurvey</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Configure replicate weights for variance estimation — add_replicate"><meta name="description" content="This function configures replicate weights (bootstrap, jackknife, etc.) that
allow estimation of variance for complex statistics in surveys with complex
sampling designs. It is essential for obtaining correct standard errors in
population estimates."><meta property="og:description" content="This function configures replicate weights (bootstrap, jackknife, etc.) that
allow estimation of variance for complex statistics in surveys with complex
sampling designs. It is essential for obtaining correct standard errors in
population estimates."><meta property="og:image" content="https://metasurveyr.github.io/metasurvey/logo.png"><!-- javascript assets for rmarkdown --><meta name="pkgdown-site-root" content="../"><script src="../ace-1.2.3/ace.js" type="text/javascript" charset="utf-8"></script><script src="../holder-2.9.0/holder.min.js" type="text/javascript" charset="utf-8"></script><script src="../snippets/snippets.js" type="text/javascript" charset="utf-8"></script><style type="text/css">
.snippet {
  border: solid 1px #cccccc;
  margin-bottom: 12px;
  width: 100%;
}
</style></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metasurvey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/metaSurveyR/metasurvey" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Configure replicate weights for variance estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/metasurveyr/metasurvey/blob/main/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
      <div class="d-none name"><code>add_replicate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function configures replicate weights (bootstrap, jackknife, etc.) that
allow estimation of variance for complex statistics in surveys with complex
sampling designs. It is essential for obtaining correct standard errors in
population estimates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_replicate</span><span class="op">(</span></span>
<span>  <span class="va">weight</span>,</span>
<span>  <span class="va">replicate_pattern</span>,</span>
<span>  replicate_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replicate_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">replicate_type</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>String with the name of the main weight variable in the
survey (e.g., "pesoano", "pesomes")</p></dd>


<dt id="arg-replicate-pattern">replicate_pattern<a class="anchor" aria-label="anchor" href="#arg-replicate-pattern"></a></dt>
<dd><p>String with regex pattern to identify replicate
weight columns. Examples: "wr\d+" for columns wr1, wr2, etc.</p></dd>


<dt id="arg-replicate-path">replicate_path<a class="anchor" aria-label="anchor" href="#arg-replicate-path"></a></dt>
<dd><p>Path to the file containing replicate weights.
If NULL, assumes they are in the same main dataset</p></dd>


<dt id="arg-replicate-id">replicate_id<a class="anchor" aria-label="anchor" href="#arg-replicate-id"></a></dt>
<dd><p>Named vector specifying how to join between the main
dataset and replicate file. Format: c("main_var" = "replicate_var")</p></dd>


<dt id="arg-replicate-type">replicate_type<a class="anchor" aria-label="anchor" href="#arg-replicate-type"></a></dt>
<dd><p>Type of replication used. Options:
"bootstrap", "jackknife", "BRR" (Balanced Repeated Replication)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with replicate configuration that will be used by the
sampling design for variance estimation</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Replicate weights are essential for:</p><ul><li><p>Correctly estimating variance in complex designs</p></li>
<li><p>Calculating appropriate confidence intervals</p></li>
<li><p>Obtaining reliable coefficients of variation</p></li>
<li><p>Performing valid statistical tests</p></li>
</ul><p>The regex pattern must exactly match the replicate weight column names
in the file. For example, if columns are named "wr001", "wr002", etc.,
use the pattern "wr\\d+".</p>
<p>This function is typically used within <code><a href="add_weight.html">add_weight()</a></code> for more
complex weight configurations.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="add_weight.html">add_weight</a></code> for complete weight configuration
<code><a href="https://rdrr.io/pkg/survey/man/svrepdesign.html" class="external-link">svrepdesign</a></code> for replicate design in survey package
<code><a href="load_survey.html">load_survey</a></code> where this configuration is used</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic configuration with external file</span></span></span>
<span class="r-in"><span><span class="va">annual_replicates</span> <span class="op">&lt;-</span> <span class="fu">add_replicate</span><span class="op">(</span></span></span>
<span class="r-in"><span>  weight <span class="op">=</span> <span class="st">"pesoano"</span>,</span></span>
<span class="r-in"><span>  replicate_pattern <span class="op">=</span> <span class="st">"wr\\\\d+"</span>,</span></span>
<span class="r-in"><span>  replicate_path <span class="op">=</span> <span class="st">"bootstrap_weights_2023.xlsx"</span>,</span></span>
<span class="r-in"><span>  replicate_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID_HOGAR"</span> <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  replicate_type <span class="op">=</span> <span class="st">"bootstrap"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With replicates in same dataset</span></span></span>
<span class="r-in"><span><span class="va">integrated_replicates</span> <span class="op">&lt;-</span> <span class="fu">add_replicate</span><span class="op">(</span></span></span>
<span class="r-in"><span>  weight <span class="op">=</span> <span class="st">"main_weight"</span>, </span></span>
<span class="r-in"><span>  replicate_pattern <span class="op">=</span> <span class="st">"rep_\\\\d{3}"</span>,</span></span>
<span class="r-in"><span>  replicate_type <span class="op">=</span> <span class="st">"jackknife"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use within add_weight</span></span></span>
<span class="r-in"><span><span class="va">weight_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_weight.html">add_weight</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  annual <span class="op">=</span> <span class="fu">add_replicate</span><span class="op">(</span></span></span>
<span class="r-in"><span>    weight <span class="op">=</span> <span class="st">"pesoano"</span>,</span></span>
<span class="r-in"><span>    replicate_pattern <span class="op">=</span> <span class="st">"wr\\\\d+"</span>, </span></span>
<span class="r-in"><span>    replicate_path <span class="op">=</span> <span class="st">"bootstrap_annual.xlsx"</span>,</span></span>
<span class="r-in"><span>    replicate_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"numero"</span> <span class="op">=</span> <span class="st">"ID_HOGAR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    replicate_type <span class="op">=</span> <span class="st">"bootstrap"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  monthly <span class="op">=</span> <span class="st">"pesomes"</span>  <span class="co"># No replicates for monthly</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In load_survey</span></span></span>
<span class="r-in"><span><span class="va">ech</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_survey.html">load_survey</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  path <span class="op">=</span> <span class="st">"ech_2023.dta"</span>,</span></span>
<span class="r-in"><span>  svy_type <span class="op">=</span> <span class="st">"ech"</span>,</span></span>
<span class="r-in"><span>  svy_edition <span class="op">=</span> <span class="st">"2023"</span>,</span></span>
<span class="r-in"><span>  svy_weight <span class="op">=</span> <span class="fu"><a href="add_weight.html">add_weight</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    annual <span class="op">=</span> <span class="fu">add_replicate</span><span class="op">(</span></span></span>
<span class="r-in"><span>      weight <span class="op">=</span> <span class="st">"pesoano"</span>,</span></span>
<span class="r-in"><span>      replicate_pattern <span class="op">=</span> <span class="st">"wr\\\\d+"</span>,</span></span>
<span class="r-in"><span>      replicate_path <span class="op">=</span> <span class="st">"bootstrap_weights.xlsx"</span>, </span></span>
<span class="r-in"><span>      replicate_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"numero"</span> <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      replicate_type <span class="op">=</span> <span class="st">"bootstrap"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.mauroloprete.com" class="external-link">Mauro Loprete</a>, <a href="https://natydasilva.github.io/natydasilva/" class="external-link">Natalia da Silva</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

